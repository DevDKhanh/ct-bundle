System.register("bundle://KKCoTuongBundle/_virtual/AsyncHelper.ts",["cc","./CocosHelper.ts"],(function(n){var e,t,o,u,c,r;return{setters:[function(n){e=n.cclegacy,t=n.assetManager,o=n.Canvas,u=n.tween,c=n.log},function(n){r=n.default}],execute:function(){e._RF.push({},"73bdcxxabFLx7t0M0O310uD","AsyncHelper",void 0);n("default",function(){function n(){}return n.sleepAsync=function(n,e){return new Promise((function(t,u){e||(e=r.getRoot().getComponent(o)),e.scheduleOnce((function(){t(null)}),n)}))},n.tweenAsync=function(n,e){return new Promise((function(t){u(n).then(e).call(t).start()}))},n.loadBundleAsync=function(n){return new Promise((function(e,o){t.loadBundle(n,(function(t,u){c("load bundle",n),t?o(t):e(u)}))}))},n.preloadAsync=function(n,e,t,o){return new Promise((function(u,c){n.preload(e,t,(function(n,e,t){o&&o(n,e)}),(function(n,e){n?c(n):u()}))}))},n.preloadDirAsync=function(n,e,t){return new Promise((function(o,u){n.preloadDir(e,(function(n,e,o){t&&t(n,e)}),(function(n,e){n?u(n):o()}))}))},n.loadDirAsync=function(n,e,t){return new Promise((function(o,u){n.loadDir(e,(function(n,e,o){t&&t(n,e)}),(function(n,e){n?u(n):o()}))}))},n.loadAsync=function(n,e,t,o){return new Promise((function(u,c){n.load(e,t,(function(n,e,t){o&&o(n,e)}),(function(n,e){n?c(n):u(e)}))}))},n.prototype.get=function(n,e,o){return void 0===o&&(o="resources"),t.getBundle(o).get(n,e)},n.execPerFrameAsync=function(n,e,t){return t||(t=r.getRoot().getComponent(o)),new Promise((function(o,u){!function u(){for(var c=Date.now(),r=n.next();;r=n.next()){if(!r||r.done)return void o();if(Date.now()-c>e)return void t.scheduleOnce((function(){u()}))}}()}))},n}());e._RF.pop()}}}));

System.register("bundle://KKCoTuongBundle/_virtual/AudioPath.ts",["cc","./KKGameUIConf.ts","./kk.ts","./MathHelper.ts"],(function(e){var n,i,u,c;return{setters:[function(e){n=e.cclegacy},function(e){i=e.KKBundleConf},function(e){u=e.default},function(e){c=e.default}],execute:function(){n._RF.push({},"1effavW9WJMJZ56/vEduk4X","AudioPath",void 0);e("AudioPath",{effect:{name:"effect",path:{piece:["piece-001","piece-002","piece-003","piece-004","piece-005"],chieu:["chieu","chieu_tuong"],chieubi:["chieu_bi","chieu_tuong_het_co"],anquan:["kill_1","kill_2","kill_3","kill_4","kill_5"],giaophong:["giao_phong"],start:["start"],win:["win"],lose:["lose"],draw:["draw_1","draw_2"]}},music:{name:"background",path:{background:["background-music"]}}}),e("randomSound",(function(e,n,t,a){var o=c.randomArray(null==e?void 0:e.path[n]);t?u.soundMgr.playEffectAsync(e.name+"/"+o,i.Audios,a):u.soundMgr.playMusicAsync(e.name+"/"+o,i.Audios,a)}));n._RF.pop()}}}));

System.register("bundle://KKCoTuongBundle/_virtual/Banqi.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var r,n;return{setters:[function(e){r=e.extends},function(e){n=e.cclegacy}],execute:function(){n._RF.push({},"fb79b+/wdpOMoF+Ye2yfzLL","Banqi",void 0);e("default",(function(e){var n="b",t="r",i=-1,o="p",a="c",u="r",f="n",s="b",l="a",c="k",p="xxxxkxxxx/9/1x5x1/x1x1x1x1x/9/9/X1X1X1X1X/1X5X1/9/XXXXKXXXX r - - 0 1",h=Object.freeze(["1-0","0-1","1/2-1/2","*"]),v=Object.freeze({b:[16,-1,1],r:[-16,-1,1]}),d=Object.freeze({c:[-16,16,-1,1],r:[-16,16,-1,1],n:[-33,-31,31,33,-18,14,-14,18],b:[-34,34,30,-30],a:[-17,17,15,-15],k:[-16,16,-1,1]}),b=Object.freeze({NORMAL:"n",CAPTURE:"c"}),g=Object.freeze({NORMAL:1,CAPTURE:2}),m=Object.freeze({a9:0,b9:1,c9:2,d9:3,e9:4,f9:5,g9:6,h9:7,i9:8,a8:16,b8:17,c8:18,d8:19,e8:20,f8:21,g8:22,h8:23,i8:24,a7:32,b7:33,c7:34,d7:35,e7:36,f7:37,g7:38,h7:39,i7:40,a6:48,b6:49,c6:50,d6:51,e6:52,f6:53,g6:54,h6:55,i6:56,a5:64,b5:65,c5:66,d5:67,e5:68,f5:69,g5:70,h5:71,i5:72,a4:80,b4:81,c4:82,d4:83,e4:84,f4:85,g4:86,h4:87,i4:88,a3:96,b3:97,c3:98,d3:99,e3:100,f3:101,g3:102,h3:103,i3:104,a2:112,b2:113,c2:114,d2:115,e2:116,f2:117,g2:118,h2:119,i2:120,a1:128,b1:129,c1:130,d1:131,e1:132,f1:133,g1:134,h1:135,i1:136,a0:144,b0:145,c0:146,d0:147,e0:148,f0:149,g0:150,h0:151,i0:152}),y=[],w=[],x="",A=!1,k=Object.freeze({r:["a0","i0","a9","i9"],n:["b0","h0","b9","h9"],b:["c0","g0","c9","g9"],a:["d0","f0","d9","f9"],k:["e0","e9"],p:["a3","c3","e3","g3","i3","a6","c6","e6","g6","i6"],c:["b2","h2","b7","h7"]});function E(e){for(var r,n=0,t=0;t<x.length;++t)if("/"===(r=x.charAt(t)))n+=7;else if(fe(r))n+=parseInt(r,10);else{if(n==e)return r.toLowerCase();n++}return r.toLowerCase()}var C=function(){for(var e={},r=function(){var r=t[n],i=r[0];r[1].forEach((function(r){e[r]=i}))},n=0,t=Object.entries(k);n<t.length;n++)r();return e}(),R=new Array(256),N={r:i,b:i},T=t,_=0,q=1,O=[],j=[],P={};function I(e){void 0===e&&(e=!1),R=new Array(256),N={r:i,b:i},T=t,_=0,q=1,O=[],j=[],e||(P={}),B(U())}function L(){X(p),w=[],y=[]}function X(e,r,i){void 0===i&&(i=!1);var o=K(e);if(!o.valid)throw new Error("Invalid FEN: "+o.error);if(r){if(r&&!K(r).valid)throw new Error("Invalid random FEN provided");x=r}else x=function(){var e=["rnbakabnr","9","1c5c1","p1p1p1p1p","9","9","P1P1P1P1P","1C5C1","9","RNBAKABNR"],r=[],n=[],t={};e.forEach((function(e,i){e.split("").forEach((function(e,o){var a=i+"-"+o;"k"===e?t.black=a:"K"===e?t.red=a:e>="a"&&e<="z"?r.push(e):e>="A"&&e<="Z"&&n.push(e)}))}));var i=function(e){for(var r=e.length-1;r>0;r--){var n=Math.floor(Math.random()*(r+1)),t=[e[n],e[r]];e[r]=t[0],e[n]=t[1]}};i(r),i(n);var o=0,a=0;return e.map((function(e,i){return e.split("").map((function(e,u){var f=i+"-"+u;return f===t.black?"k":f===t.red?"K":e>="a"&&e<="z"?r[o++]:e>="A"&&e<="Z"?n[a++]:e})).join("")})).join("/")}();var a,u,f=e.split(/\s+/),s=f[0],l=0;I(i);try{for(var c=0;c<s.length;++c)"/"===(a=s.charAt(c))?l+=7:fe(a)?l+=parseInt(a,10):(u=a<"a"?t:n,F({type:a.toLowerCase(),color:u,faceType:C[ae(l)]},ae(l)),l++)}catch(e){throw new Error("Load failed: "+e.message)}return T=f[1]===n?n:t,_=parseInt(f[4],10),q=parseInt(f[5],10),B(U()),!0}function K(e){var r={0:"No errors.",1:"FEN string must contain six space-delimited fields.",2:"6th field (move number) must be a positive integer.",3:"5th field (half move counter) must be a non-negative integer.",4:"4th field (en-passant square) should be '-'.",5:"3rd field (castling availability) should be '-'.",6:"2nd field (side to move) is invalid.",7:"1st field (piece positions) does not contain 10 '/'-delimited rows.",8:"1st field (piece positions) is invalid [consecutive numbers].",9:"1st field (piece positions) is invalid [invalid piece].",10:"1st field (piece positions) is invalid [row too large].",11:"1st field (piece positions) is invalid [each side has one king].",12:"1st field (piece positions) is invalid [each side has no more than 2 advisers].",13:"1st field (piece positions) is invalid [each side has no more than 2 bishops].",14:"1st field (piece positions) is invalid [each side has no more than 2 knights].",15:"1st field (piece positions) is invalid [each side has no more than 2 rooks].",16:"1st field (piece positions) is invalid [each side has no more than 2 cannons].",17:"1st field (piece positions) is invalid [each side has no more than 5 pawns].",18:"1st field (piece positions) is invalid [black king should at right position].",19:"1st field (piece positions) is invalid [red king should at right position].",20:"1st field (piece positions) is invalid [black adviser should at right position].",21:"1st field (piece positions) is invalid [red adviser should at right position].",22:"1st field (piece positions) is invalid [black bishop should at right position].",23:"1st field (piece positions) is invalid [red bishop should at right position].",24:"1st field (piece positions) is invalid [black pawn should at right position].",25:"1st field (piece positions) is invalid [red pawn should at right position]."};function i(e){return{valid:0===e,error_number:e,error:r[e]}}var o=e.split(/\s+/);if(6!==o.length)return i(1);if(isNaN(o[5])||parseInt(o[5],10)<=0)return i(2);if(isNaN(o[4])||parseInt(o[4],10)<0)return i(3);if(!/^-$/.test(o[3]))return i(4);if(!/^-$/.test(o[2]))return i(5);if(!/^([rwb])$/.test(o[1]))return i(6);var a=o[0].split("/");if(10!==a.length)return i(7);var u,f,s,l,p={p:{number:0,squares:[]},P:{number:0,squares:[]},c:{number:0,squares:[]},C:{number:0,squares:[]},r:{number:0,squares:[]},R:{number:0,squares:[]},n:{number:0,squares:[]},N:{number:0,squares:[]},b:{number:0,squares:[]},B:{number:0,squares:[]},a:{number:0,squares:[]},A:{number:0,squares:[]},k:{number:0,squares:[]},K:{number:0,squares:[]},x:{number:0,squares:[]},X:{number:0,squares:[]}};for(u=0;u<a.length;u++){for(s=0,l=!1,f=0;f<a[u].length;f++)if(isNaN(a[u][f])){try{++p[a[u][f]].number}catch(e){return i(9)}p[a[u][f]].squares.push(u<<4|s),s+=1,l=!1}else{if(l)return i(8);s+=parseInt(a[u][f],10),l=!0}if(9!==s)return i(10)}return 1!==p.k.number||1!==p.K.number?i(11):p.a.number>2||p.A.number>2?i(12):p.b.number>2||p.B.number>2?i(13):p.n.number>2||p.N.number>2?i(14):p.r.number>2||p.R.number>2?i(15):p.c.number>2||p.C.number>2?i(16):p.p.number>5||p.P.number>5?i(17):le(c,p.k.squares[0],n)?i(18):le(c,p.K.squares[0],t)?i(19):i(0)}function U(){for(var e,r,n=0,i="",o=m.a9;o<=m.i0;++o)null==R[o]?n++:(n>0&&(i+=n,n=0),e=R[o].color,r=R[o].type,i+=e===t?r.toUpperCase():r.toLowerCase()),oe(o)>=8&&(n>0&&(i+=n),o!==m.i0&&(i+="/"),n=0,o+=7);return[i,T,"-","-",_,q].join(" ")}function z(e){for(var r=0;r<e.length;r+=2)"string"==typeof e[r]&&"string"==typeof e[r+1]&&(P[e[r]]=e[r+1]);return P}function B(e){O.length>0||(e!==p?P.FEN=e:delete P.FEN)}function F(e,r){if(!("type"in e)||!("color"in e))throw new Error("Invalid piece object (missing type/color)");var n="x"===e.type.toLowerCase()?e.faceType:e.type;if(-1==="pcrnbakPCRNBAK".indexOf(n.toLowerCase()))throw new Error("Invalid piece type: "+e.type);if(!(r in m))throw new Error("Invalid square: "+r);var t=m[r];if(e.type===c&&N[e.color]!==i&&N[e.color]!==t)throw new Error("Invalid king placement at "+r);if("x"==e.type&&le(n,t,e.color))throw new Error("Invalid hidden piece placement at "+r);return R[t]={type:e.type,color:e.color,faceType:e.faceType},e.type===c&&(N[e.color]=t),B(U()),{ok:!0}}function $(e){var r=function(e){var r=R[m[e]];return r?{type:r.type,color:r.color,faceType:null==r?void 0:r.faceType}:null}(e);return R[m[e]]=null,r&&r.type===c&&(N[r.color]=i),B(U()),r}function M(e){function r(e,r,n,t,i){r.push(function(e,r,n,t){var i={color:T,from:r,to:n,flags:t,piece:e[r].type};return e[n]&&(i.captured=e[n].type,i.faceType=e[n].faceType),i}(e,n,t,i))}var n,i,p,h,b,y,w,x,A,k,E=[],C=T,N=ue(C),_=m.a9,q=m.i0,O=void 0===e||!("legal"in e)||e.legal,j=void 0!==e&&"opponent"in e&&e.opponent;if(void 0!==e&&"square"in e){if(!(e.square in m))return[];_=q=m[e.square]}for(j&&(T=ue(T),N=ue(C=T)),n=_;n<=q;++n)if(null!=(h=R[n])&&h.color===C){for(i=0,p=(b=(A="x"==h.type?h.faceType:h.type)===o?v[C]:d[A]).length;i<p&&(!(A===o&&i>0)||(k=n,C===t?ie(k)<5:ie(k)>4));++i)for(y=b[i],w=n,x=!1;!(se(w+=y)||A===f&&ce(n,i)||A===s&&pe(n,i)||(A===l&&"x"==h.type||h.type===c)&&le(A,w,C));){if(null==R[w]){if(A===a&&x)continue;r(R,E,n,w,g.NORMAL)}else{if(A!==a){R[w].color===N&&r(R,E,n,w,g.CAPTURE);break}if(x){R[w].color===N&&r(R,E,n,w,g.CAPTURE);break}x=!0}if(A!==a&&A!==u)break}oe(n)>=8&&(n+=7)}if(!O)return E;var P=[];for(n=0,p=E.length;n<p;n++)J(E[n]),H(C)||P.push(E[n]),re();return j&&(T=ue(T)),P}function S(e,r){return ae(e.from)+ae(e.to)}function Z(e){return e.replace(/=/,"").replace(/[+#]?[?!]*$/,"")}function H(e){var r,n,t,i=N[e],p=ue(e);for(r=0,n=d.n.length;r<n;++r)if(t=i+d.n[r],null!=R[t]&&!se(t)&&R[t].color===p&&R[t].type===f&&!ce(t,r<4?3-r:11-r))return!0;for(r=0,n=d.r.length;r<n;++r){var h=d.r[r],b=!1;for(t=i+h;!se(t);t+=h){var g=R[t];if(null!=g){if(g.color===p)if(b){if(g.type===a)return!0}else if(g.type===u||g.type===c)return!0;if(b)break;b=!0}}}for(r=0,n=v[p].length;r<n;++r)if(t=i-v[p][r],null!=R[t]&&!se(t)&&R[t].color===p&&R[t].type===o)return!0;for(r=0,n=d.a.length;r<n;++r)if(t=i+d.a[r],null!=R[t]&&R[t].color===p&&R[t].type===l)return!0;for(r=0,n=d.b.length;r<n;++r)if(t=i+d.b[r],null!=R[t]&&R[t].color===p&&R[t].type===s&&!pe(i,r))return!0;return!1}function G(){return H(T)}function D(){return G()&&0===M().length}function Q(){return!G()&&0===M().length}function V(){var e,r,n={},t=0;for(var i in m)m.hasOwnProperty(i)&&(e=R[m[i]])&&(n[r="x"===e.type?e.faceType:e.type]=r in n?n[r]+1:1,t++);return 2===t||void 0===n.n&&void 0===n.r&&void 0===n.c&&void 0===n.p}function W(){for(var e={},r=0,n=w;r<n.length;r++){var t=n[r].split(" ").slice(0,2).join(" ");if(e[t]=(e[t]||0)+1,e[t]>=8)return!0}return!1}function Y(e,r){e.push({move:r,kings:{b:N.b,r:N.r},turn:T,half_moves:_,move_number:q})}function J(e){Y(O,e),null!=R[e.to]&&R[e.to].type===c&&(N[R[e.to].color]=i),R[e.to]=R[e.from],R[e.from]=null,R[e.to].type===c&&(N[R[e.to].color]=e.to),e.flags&g.CAPTURE?_=0:_++,T===n&&q++,T=ue(T)}function ee(e,r){if(void 0===r&&(r=!0),null==e)return null;var n=e.move;return N=e.kings,T=e.turn,_=e.half_moves,q=e.move_number,R[n.from]=R[n.to],R[n.from].type=n.piece,R[n.to]=null,(n.flags&g.CAPTURE)>0&&r&&(R[n.to]={type:n.captured,color:ue(T),faceType:n.faceType}),n}function re(){return ee(O.pop())}function ne(){for(var e="   +---------------------------+\n",r=m.a9;r<=m.i0;r++){if(0===oe(r)&&(e+=" "+"9876543210"[ie(r)]+" |"),null==R[r])e+=" . ";else{var n=R[r].type;e+=" "+(R[r].color===t?null==n?void 0:n.toUpperCase():null==n?void 0:n.toLowerCase())+" "}8&r&&(e+="|\n",r+=7)}return e+="   +---------------------------+\n",e+="     a  b  c  d  e  f  g  h  i\n"}function te(e,r){var n,t,i,o=Z(e),a=o.match(/([a-iA-I][0-9])-?([a-iA-I][0-9])/);r&&a&&(n=a[1],t=a[2],i=a[3]);for(var u=M(),f=0,s=u.length;f<s;f++){if(o===Z(S(u[f]))||r&&o===Z(S(u[f])))return u[f];if(a&&(!n||n.toLowerCase()===u[f].piece)&&m[t]===u[f].from&&m[i]===u[f].to)return u[f]}return null}function ie(e){return e>>4}function oe(e){return 15&e}function ae(e){var r=oe(e),n=ie(e);return"abcdefghi".substring(r,r+1)+"9876543210".substring(n,n+1)}function ue(e){return e===t?n:t}function fe(e){return-1!=="0123456789".indexOf(e)}function se(e){return e<0||ie(e)>9||oe(e)>8}function le(e,r,n){var i={};if(e===o)return i=[0,2,4,6,8],n===t?ie(r)>6||ie(r)>4&&-1===i.indexOf(oe(r)):ie(r)<3||ie(r)<5&&-1===i.indexOf(oe(r));if(e===s)i.r=[146,150,112,116,120,82,86],i.b=[2,6,32,36,40,66,70];else if(e===l)i.r=[147,149,132,115,117],i.b=[3,5,20,35,37];else{if(e!==c)return se(r);i.r=[147,148,149,131,132,133,115,116,117],i.b=[3,4,5,19,20,21,35,36,37]}return-1===i[n].indexOf(r)}function ce(e,r){return null!=R[e+[-16,16,-1,1][Math.floor(r/2)]]}function pe(e,r){return null!=R[e+[-17,17,15,-15][r]]}function he(e){var r=ve(e);r.iccs=S(r),r.to=ae(r.to),r.from=ae(r.from),r.piece=T===t?r.piece.toUpperCase():r.piece;var n="";for(var i in g)(g[i]&r.flags)>0&&(n+=b[i]);return r.flags=n,r}function ve(e){if("function"==typeof globalThis.structuredClone)return globalThis.structuredClone(e);if(null===e||"object"!=typeof e)return e;if(Array.isArray(e))return e.map((function(e){return ve(e)}));var r={};for(var n in e)r[n]=ve(e[n]);return r}function de(e){return function(){if(A)throw new Error("Concurrent state mutation detected");try{A=!0;for(var r=arguments.length,n=new Array(r),t=0;t<r;t++)n[t]=arguments[t];return e.apply(this,n)}finally{A=!1}}}function be(e){return e.replace(/^\s+|\s+$/g,"")}function ge(e){for(var r=M({legal:!1}),n=0,t=0,i=r.length;t<i;t++){if(J(r[t]),!H(T))if(e-1>0)n+=ge(e-1);else n++;re()}return n}return X(void 0===e?p:e),{RED:t,BLACK:n,PAWN:o,CANNON:a,ROOK:u,KNIGHT:f,BISHOP:s,ADVISER:l,KING:c,SQUARES:function(){for(var e=[],r=m.a9;r<=m.i0;r++)9!==oe(r)?e.push(ae(r)):r+=6;return e}(),FLAGS:b,load:de((function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),t=1;t<r;t++)n[t-1]=arguments[t];return X.apply(void 0,[e].concat(n))})),reset:de((function(){return L()})),moves:function(e){for(var r=M(e),n=[],t=0,i=r.length;t<i;t++)void 0!==e&&"verbose"in e&&e.verbose?n.push(he(r[t])):n.push(S(r[t]));return n},in_check:function(){return G()},in_checkmate:function(){return D()},in_stalemate:function(){return Q()},in_draw:function(){return _>=120||W()||V()},insufficient_material:function(){return V()},in_threefold_repetition:function(){return W()},game_over:function(){return _>=120||D()||Q()||V()||W()||N[ue(T)]===i},validate_fen:function(e){return K(e)},fen:function(){return U()},board:function(){for(var e=[],r=[],n=m.a9;n<=m.i0;n++)null==R[n]?r.push(null):r.push({type:R[n].type,color:R[n].color,faceType:R[n].faceType}),8&n&&(e.push(r),r=[],n+=7);return ve(e)},pgn:function(e){var r,n="object"==typeof e&&"string"==typeof e.newline_char?e.newline_char:"\n",t="object"==typeof e&&"number"==typeof e.max_width?e.max_width:0,i=[],o=!1;for(r in P)i.push("["+r+' "'+P[r]+'"]'+n),o=!0;o&&O.length&&i.push(n);for(var a=[];O.length>0;)a.push(re());for(var u=[],f="";a.length>0;){var s=a.pop();O.length||"b"!==s.color?"b"!==s.color&&(f.length&&u.push(f),f=q+"."):f=q+". ...",f=f+" "+S(s),J(s)}if(f.length&&u.push(f),void 0!==P.Result&&u.push(P.Result),0===t)return i.join("")+u.join(" ");var l=0;for(r=0;r<u.length;r++)l+u[r].length>t&&0!==r?(" "===i[i.length-1]&&i.pop(),i.push(n),l=0):0!==r&&(i.push(" "),l++),i.push(u[r]),l+=u[r].length;return i.join("")},load_pgn:function(e,r){var n=void 0!==r&&"sloppy"in r&&r.sloppy;function t(e){return e.replace(/\\/g,"\\")}var i="object"==typeof r&&"string"==typeof r.newline_char?r.newline_char:"\r?\n",o=new RegExp("^(?:\\s)*(((?:"+t(i)+")*\\[[^\\]]+\\])+)"),a=o.test(e)?o.exec(e)[1]:"";L();var u=function(e,r){for(var n="object"==typeof r&&"string"==typeof r.newline_char?r.newline_char:"\r?\n",i={},o=e.split(new RegExp(t(n))),a="",u="",f=0;f<o.length;f++)a=o[f].replace(/^\[([A-Z][A-Za-z]*)\s.*]$/,"$1"),u=o[f].replace(/^\[[A-Za-z]+\s"(.*)"]$/,"$1"),be(a).length>0&&(i[a]=u);return i}(a,r);for(var f in u)u.hasOwnProperty(f)&&z([f,u[f]]);"FEN"in u&&X(u.FEN,"",!0);var s=e.replace(a,"").replace(new RegExp(t(i),"g")," ");s=s.replace(/({[^}]+})+?/g,"");for(var l=/(\([^()]+\))+?/g;l.test(s);)s=s.replace(l,"");var c=be(s=(s=(s=s.replace(/\d+\.(\.\.)?/g,"")).replace(/\.\.\./g,"")).replace(/\$\d+/g,"")).split(new RegExp(/\s+/));c=c.join(",").replace(/,,+/g,",").split(",");for(var p="",v=0;v<c.length-1;v++){if(null==(p=te(c[v],n)))return console.warn("impossible move: "+c[v]+"!\n"+ne()),!1;J(p)}if(p=c[c.length-1],h.indexOf(p)>-1)(function(e){for(var r in e)if(e.hasOwnProperty(r))return!0;return!1})(P)&&void 0===P.Result&&z(["Result",p]);else{if(null==(p=te(p,n)))return console.warn("impossible last move: "+c[c.length-1]+"!\n"+ne()),!1;J(p)}return!0},header:function(){return z(arguments)},ascii:function(){return ne()},turn:function(){return T},move:de((function(e,n){var t=function(e,n){var t=void 0!==n&&"sloppy"in n&&n.sloppy,i=null;if("string"==typeof e)i=te(e,t);else if("object"==typeof e)for(var o=M(),a=0,u=o.length;a<u;a++)if(e.from===ae(o[a].from)&&e.to===ae(o[a].to)&&!(""in o[a])){i=o[a];break}if(!i)return null;var f,s=he(i),l=R[i.from],c=R[i.to];l&&"x"==l.type&&(l.type=null!=(f=null==n?void 0:n.type)?f:E(i.from));if(c&&s.flags==b.CAPTURE){var p="x"===c.type?E(i.to):c.type;y.push(r({},c,{realType:p}))}return J(i),j=[],w.push(U()),r({},s,{piece:l.type})}(e,n);return t?ve(t):null})),undo:de((function(){Y(j,null);var e=re();if(e){var r=he(e),n=[e.to,e.from];return e.from=n[0],e.to=n[1],j[j.length-1].move=e,ve(r)}return j.pop(),null})),redo:de((function(){Y(O,null);var e=ee(j.pop(),!1);if(e){var r=[e.to,e.from];return e.from=r[0],e.to=r[1],O[O.length-1].move=e,ve(he(e))}return O.pop(),null})),clear:de((function(){return I()})),put:de((function(e,r){return F(e,r)})),remove:de((function(e){var r=$(e);return r?ve(r):r})),perft:function(e){return ge(e)},pool_capture:function(){return ve(y)},getHistory:function(){return O.map((function(e){var n=e.move;return r({},ve(n),{from:ae(n.from),to:ae(n.to),piece:n.color===t?n.piece.toUpperCase():n.piece})}))},history:function(e){var r=void 0!==e&&"verbose"in e&&e.verbose;return ve(O.map((function(e){var n=e.move;if(!r)return ae(n.from)+ae(n.to);var i={color:n.color,from:ae(n.from),to:ae(n.to),piece:n.color===t?n.piece.toUpperCase():n.piece,iccs:ae(n.from)+ae(n.to),captured:n.captured,faceType:n.faceType},o="";for(var a in g)(n.flags&g[a])>0&&(o+=b[a]);return i.flags=o,i})))}}}));n._RF.pop()}}}));

System.register("bundle://KKCoTuongBundle/_virtual/BaseSocket.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,n,o,s,i;return{setters:[function(t){e=t.createForOfIteratorHelperLoose},function(t){n=t.cclegacy,o=t.warn,s=t.log,i=t.error}],execute:function(){n._RF.push({},"ac152Scz+pBFJutqPd0SBev","BaseSocket",void 0);var c=t("SocketErrCode",{NoThisSocket:100,SendFailure:101});t("BaseSocket",function(){function t(){this._ws=null,this._connectOptions=null,this._heartTimer=null,this._curHeartOutCnt=0,this._curAutoReconnect=0,this._reconnectTimer=0,this._req2respCallbacks={},this._server2ClientListeners={},this._connectedCB=null}var n=t.prototype;return n.connectAsync=function(t,e){var n=this;null==this._connectOptions&&(this._connectOptions={url:t.url?t.url:(t.protocol?t.protocol:"ws")+"://"+t.ip+":"+t.port,binaryType:t.binaryType?t.binaryType:"arraybuffer",autoReconnect:t.autoReconnect?t.autoReconnect:0,reconnectTime:t.reconnectTime?t.reconnectTime:6,heartTime:t.heartTime?t.heartTime:3,heartOutCount:t.heartOutCount?t.heartOutCount:3,getHeartbeat:t.getHeartbeat?t.getHeartbeat:function(){return""},parseNetData:t.parseNetData?t.parseNetData:function(t){return{cmd:0,content:t}},tips:t.tips?t.tips:{},manualReconnect:t.manualReconnect?t.manualReconnect:function(){return o("manualReconnect undefined")}},this._connectedCB=e||function(){});var i=!0;return new Promise((function(t,e){var o;if(n._ws){if(n._ws.readyState===WebSocket.CONNECTING)return s("ws connecting, wait for a moment..."),void t();if(n._ws.readyState===WebSocket.OPEN)return s("ws has connected!"),void t()}s("net is connecting!"),null==(o=n._connectOptions.tips)||o.showConnecting(!0),n._ws=new WebSocket(n._connectOptions.url),n._ws.binaryType=n._connectOptions.binaryType,n._ws.onopen=function(e){var o;i=!1,null==(o=n._connectOptions.tips)||o.showConnecting(!1),t(),n._connectedCB(),n._onOpen(e)},n._ws.onmessage=function(t){n._onMessage(t.data)},n._ws.onerror=function(t){var o;i&&(i=!1,null==(o=n._connectOptions.tips)||o.showConnecting(!1),e(t));n._onError(t)},n._ws.onclose=function(t){var o;i&&(i=!1,null==(o=n._connectOptions.tips)||o.showConnecting(!1),e(t));n._onClose(t)}}))},n.reqAsync=function(t,e,n){var o,s=this;return void 0===n&&(n=!1),n&&(null==(o=this._connectOptions.tips)||o.showRequesting(!0)),new Promise((function(o,i){var r;if(!s._send(e))return n&&(null==(r=s._connectOptions.tips)||r.showRequesting(!1)),void i(c.SendFailure);s._req2respCallbacks[t]||(s._req2respCallbacks[t]=[]),s._req2respCallbacks[t].push((function(t){var e;n&&(null==(e=s._connectOptions.tips)||e.showRequesting(!1)),o(t)}))}))},n.close=function(t){if(void 0===t&&(t=!1),this._stopHeartTimer(),this._stopReconnectTimer(),this._ws){var e;if(this._ws.readyState==WebSocket.CONNECTING||this._ws.readyState==WebSocket.CLOSING)null==(e=this._connectOptions.tips)||e.showConnecting(!1);this._clearReqList(),t&&(this._server2ClientListeners={}),this._ws.onopen=function(t){},this._ws.onmessage=function(t){},this._ws.onerror=function(t){},this._ws.onclose=function(t){},this._ws.readyState!=WebSocket.CLOSED&&this._ws.close(),s("ws closed manually")}},n.on=function(t,e,n){this._server2ClientListeners[t]||(this._server2ClientListeners[t]=[]),-1===this._server2ClientListeners[t].findIndex((function(t){return t.target===n&&t.callback===e}))&&this._server2ClientListeners[t].push({target:n,callback:e})},n.off=function(t,e,n){var o=this._server2ClientListeners[t];if(o){var s=o.findIndex((function(t){return t.target===n&&t.callback===e}));-1!==s&&o.splice(s,1)}},n._onOpen=function(t){s("ws connected!"),this._stopReconnectTimer(),this._startHeartTimer()},n._onMessage=function(t){this._curHeartOutCnt=0,t&&this._onRecv(t)},n._onError=function(t){i("ws error!",t)},n._onClose=function(t){s("ws closed!",t.code,t.reason),this._stopHeartTimer(),this._stopReconnectTimer(),this._clearReqList(),this._doReconnect()},n._send=function(t){return this._ws&&this._ws.readyState===WebSocket.OPEN?(this._ws.send(t),!0):(o("send exceptionally"),!1)},n._clearReqList=function(){for(var t in this._req2respCallbacks){this._req2respCallbacks[t].forEach((function(t,e){t(null)}))}this._req2respCallbacks={}},n._onRecv=function(t){var n=this._connectOptions.parseNetData(t);if(n){var s=this._req2respCallbacks[n.cmd];if(s&&s.length>0)s.shift()(n.content);var i=this._server2ClientListeners[n.cmd];if(i)for(var c,r=e(i);!(c=r()).done;){var a=c.value;a.callback.call(a.target,n.content)}}else o("ParseNetData Error! ",t)},n._doReconnect=function(){var t,e,n=this,o=this._connectOptions.autoReconnect;0==o||o>0&&this._curAutoReconnect>=o?null==(t=this._connectOptions)||t.manualReconnect():(o>0&&++this._curAutoReconnect,s("net is reconnecting!"),null==(e=this._connectOptions.tips)||e.showReconnecting(!0),this._reconnectTimer=setTimeout((function(){var t;null==(t=n._connectOptions.tips)||t.showReconnecting(!1),n.connectAsync(n._connectOptions,n._connectedCB)}),1e3*this._connectOptions.reconnectTime))},n._startHeartTimer=function(){var t=this;this._curHeartOutCnt=0,this._stopHeartTimer(),this._heartTimer=setInterval((function(){if(++t._curHeartOutCnt,t._curHeartOutCnt>t._connectOptions.heartOutCount)return s("ws disconnected! -- heart out"),t.close(),void t._doReconnect();t._send(t._connectOptions.getHeartbeat())}),1e3*this._connectOptions.heartTime)},n._stopHeartTimer=function(){this._heartTimer&&clearInterval(this._heartTimer),this._heartTimer=null},n._stopReconnectTimer=function(){this._reconnectTimer&&clearTimeout(this._reconnectTimer),this._reconnectTimer=null},t}());n._RF.pop()}}}));

System.register("bundle://KKCoTuongBundle/_virtual/cjs-loader.mjs",[],(function(e){return{execute:function(){e("default",new(function(){function e(){this._registry={},this._moduleCache={}}var r=e.prototype;return r.define=function(e,r,t){this._registry[e]={factory:r,resolveMap:t}},r.require=function(e){return this._require(e)},r.throwInvalidWrapper=function(e,r){throw new Error("Module '"+e+"' imported from '"+r+"' is expected be an ESM-wrapped CommonJS module but it doesn't.")},r._require=function(e,r){var t=this._moduleCache[e];if(t)return t.exports;var o={id:e,exports:{}};return this._moduleCache[e]=o,this._tryModuleLoad(o,e),o.exports},r._resolve=function(e,r){return this._resolveFromInfos(e,r)||this._throwUnresolved(e,r)},r._resolveFromInfos=function(e,r){var t,o;return e in cjsInfos?e:r&&null!=(t=null==(o=cjsInfos[r])?void 0:o.resolveCache[e])?t:void 0},r._tryModuleLoad=function(e,r){var t=!0;try{this._load(e,r),t=!1}finally{t&&delete this._moduleCache[r]}},r._load=function(e,r){var t=this._loadWrapper(r),o=t.factory,n=t.resolveMap,i=this._createRequire(e),u=n?this._createRequireWithResolveMap("function"==typeof n?n():n,i):i;o(e.exports,u,e)},r._loadWrapper=function(e){return e in this._registry?this._registry[e]:this._loadHostProvidedModules(e)},r._loadHostProvidedModules=function(e){return{factory:function(r,t,o){if("undefined"==typeof require)throw new Error("Current environment does not provide a require() for requiring '"+e+"'.");try{o.exports=require(e)}catch(r){throw new Error("Exception thrown when calling host defined require('"+e+"').",{cause:r})}}}},r._createRequire=function(e){var r=this;return function(t){return r._require(t,e)}},r._createRequireWithResolveMap=function(e,r){return function(t){var o=e[t];if(o)return r(o);throw new Error("Unresolved specifier "+t)}},r._throwUnresolved=function(e,r){throw new Error("Unable to resolve "+e+" from "+parent+".")},e}()))}}}));

System.register("bundle://KKCoTuongBundle/_virtual/CocosHelper.ts",["cc","./kk.ts"],(function(e){var t,i,n,o,r,a,d,p,c,l,g,f,u;return{setters:[function(e){t=e.cclegacy,i=e.director,n=e.Sprite,o=e.Color,r=e.Label,a=e.Widget,d=e.Layout,p=e.UITransform,c=e.builtinResMgr,l=e.ImageAsset,g=e.Texture2D,f=e.SpriteFrame},function(e){u=e.default}],execute:function(){e({getRankByElo:function(e){return u.config.service.configLevel.find((function(t){var i,n=t.type;if(i=/^elo<(\d+)$/.exec(n)){var o=+i[1];return e<o}if(i=/^elo>=(\d+)$/.exec(n)){var r=+i[1];return e>=r}if(i=/^(\d+)>elo>=(\d+)$/.exec(n)){var a=+i[1],d=+i[2];return e>=d&&e<a}return!1}))||null},secondsToMinute:function(e){var t=Math.floor(e/60),i=e%60;return t+":"+(i<10?"0":"")+i}}),t._RF.push({},"1d4c6haefZJ0JyHbpV5WuLI","CocosHelper",void 0);e("default",function(){function e(){}return e.getRoot=function(){return i.getScene().getChildByName("Canvas")},e.addSprite=function(e,t){if(e){"number"!=typeof t.type&&(t.type=n.Type.SIMPLE),"number"!=typeof t.sizeMode&&(t.sizeMode=n.SizeMode.TRIMMED),"boolean"!=typeof t.trim&&(t.trim=!0);var i=e.addComponent(n);return i.spriteFrame=t.spriteFrame,i.type=t.type,i.sizeMode=t.sizeMode,i.trim=t.trim,i}},e.addLabel=function(e,t){if(e){t.fontSize||(t.fontSize=40),t.color||(t.color=o.WHITE),t.lineHeight||(t.lineHeight=t.fontSize),"number"!=typeof t.horizontalAlign&&(t.horizontalAlign=r.HorizontalAlign.CENTER),"number"!=typeof t.verticalAlign&&(t.verticalAlign=r.VerticalAlign.CENTER),"number"!=typeof t.overflow&&(t.overflow=r.Overflow.NONE),"number"!=typeof t.cacheMode&&(t.cacheMode=r.CacheMode.NONE);var i=e.addComponent(r);return i.string=t.string,i.fontSize=t.fontSize,i.lineHeight=t.lineHeight,i.horizontalAlign=t.horizontalAlign,i.verticalAlign=t.verticalAlign,i.overflow=t.overflow,i.isBold=!!t.enableBold,i.isItalic=!!t.enableItalic,i.isUnderline=!!t.enableUnderline,i.enableWrapText=!!t.enableWrapText,i.cacheMode=t.cacheMode,i.color=t.color,i}},e.addWidget=function(e,t){if(e){var i=e.addComponent(a);return"number"==typeof t.left&&(i.isAlignLeft=!0,i.left=t.left),"number"==typeof t.right&&(i.isAlignRight=!0,i.right=t.right),"number"==typeof t.top&&(i.isAlignTop=!0,i.top=t.top),"number"==typeof t.bottom&&(i.isAlignBottom=!0,i.bottom=t.bottom),i}},e.addLayout=function(e,t){if(e){"number"!=typeof t.resizeMode&&(t.resizeMode=d.ResizeMode.CONTAINER);var i=e.getComponent(p);i||e.addComponent(p),t.width&&(i.width=t.width),t.height&&(i.height=t.height);var n=e.addComponent(d);return n.type=t.type,n.resizeMode=t.resizeMode,n.affectedByScale=!!t.affectedByScale,n.type==d.Type.HORIZONTAL?(n.horizontalDirection="number"==typeof t.horizontalDirection?t.horizontalDirection:d.HorizontalDirection.LEFT_TO_RIGHT,n.spacingX=t.spacingX?t.spacingX:0,n.paddingLeft=t.paddingLeft?t.paddingLeft:0,n.paddingRight=t.paddingRight?t.paddingRight:0):n.type==d.Type.VERTICAL?(n.verticalDirection="number"==typeof t.verticalDirection?t.verticalDirection:d.VerticalDirection.TOP_TO_BOTTOM,n.spacingY=t.spacingY?t.spacingY:0,n.paddingTop=t.paddingTop?t.paddingTop:0,n.paddingBottom=t.paddingBottom?t.paddingBottom:0):n.type==d.Type.GRID&&(n.startAxis="number"==typeof t.startAxis?t.startAxis:d.AxisDirection.HORIZONTAL,n.horizontalDirection="number"==typeof t.horizontalDirection?t.horizontalDirection:d.HorizontalDirection.LEFT_TO_RIGHT,n.verticalDirection="number"==typeof t.verticalDirection?t.verticalDirection:d.VerticalDirection.TOP_TO_BOTTOM,n.spacingX=t.spacingX?t.spacingX:0,n.paddingLeft=t.paddingLeft?t.paddingLeft:0,n.paddingRight=t.paddingRight?t.paddingRight:0,n.spacingY=t.spacingY?t.spacingY:0,n.paddingTop=t.paddingTop?t.paddingTop:0,n.paddingBottom=t.paddingBottom?t.paddingBottom:0),n}},e.grayNode=function(t,i){void 0===i&&(i=!0),t.getComponent(n)?t.getComponent(n).grayscale=i:t.getComponent(r)&&t.getComponent(r).setSharedMaterial(c.get(i?"ui-sprite-gray-material":"ui-sprite-material"),0);for(var o=t.children.length-1;o>=0;--o)e.grayNode(t.children[o],i)},e.genPureColorSpriteFrame=function(e){void 0===e&&(e=o.BLACK);var t=new l({_data:new Uint8Array([e.r,e.g,e.b,e.a]),width:1,height:1,format:g.PixelFormat.RGBA8888,_compressed:!1}),i=new g;i.image=t;var n=new f;return n.texture=i,n.packable=!1,n},e}()),e("coin",(function(e){return Math.floor(Number(e)).toLocaleString("en-GB")}));t._RF.pop()}}}));

System.register("bundle://KKCoTuongBundle/_virtual/Config.ts",["cc","./DebugHelper.ts"],(function(e){var n;return{setters:[function(e){n=e.cclegacy},null],execute:function(){n._RF.push({},"40158SU0ZxOKLMdCmbFF5Lj","Config",void 0);e("Config",(function(){this.service=void 0}));n._RF.pop()}}}));

System.register("bundle://KKCoTuongBundle/_virtual/CoUpLogic.ts",["cc"],(function(e){var r;return{setters:[function(e){r=e.cclegacy}],execute:function(){r._RF.push({},"b5811DFqqBNtKV8QX6qmG0z","CoUpLogic",void 0);e("default",(function(e){var r="b",n="r",t=-1,i="p",o="c",u="r",s="n",a="b",f="a",l="k",p="rnbakabnr/9/1c5c1/p1p1p1p1p/9/9/P1P1P1P1P/1C5C1/9/RNBAKABNR r - - 0 1",c=Object.freeze(["1-0","0-1","1/2-1/2","*"]),h=Object.freeze({b:[16,-1,1],r:[-16,-1,1]}),d=Object.freeze({c:[-16,16,-1,1],r:[-16,16,-1,1],n:[-33,-31,31,33,-18,14,-14,18],b:[-34,34,30,-30],a:[-17,17,15,-15],k:[-16,16,-1,1]}),v=Object.freeze({NORMAL:"n",CAPTURE:"c"}),g=Object.freeze({NORMAL:1,CAPTURE:2}),b=Object.freeze({a9:0,b9:1,c9:2,d9:3,e9:4,f9:5,g9:6,h9:7,i9:8,a8:16,b8:17,c8:18,d8:19,e8:20,f8:21,g8:22,h8:23,i8:24,a7:32,b7:33,c7:34,d7:35,e7:36,f7:37,g7:38,h7:39,i7:40,a6:48,b6:49,c6:50,d6:51,e6:52,f6:53,g6:54,h6:55,i6:56,a5:64,b5:65,c5:66,d5:67,e5:68,f5:69,g5:70,h5:71,i5:72,a4:80,b4:81,c4:82,d4:83,e4:84,f4:85,g4:86,h4:87,i4:88,a3:96,b3:97,c3:98,d3:99,e3:100,f3:101,g3:102,h3:103,i3:104,a2:112,b2:113,c2:114,d2:115,e2:116,f2:117,g2:118,h2:119,i2:120,a1:128,b1:129,c1:130,d1:131,e1:132,f1:133,g1:134,h1:135,i1:136,a0:144,b0:145,c0:146,d0:147,e0:148,f0:149,g0:150,h0:151,i0:152}),m=new Array(256),y={r:t,b:t},q=n,w=0,A=1,N=[],R=[],k={};function _(e){void 0===e&&(e=!1),m=new Array(256),y={r:t,b:t},q=n,w=0,A=1,N=[],R=[],e||(k={}),x(E())}function C(){O(p)}function O(e,t){if(void 0===t&&(t=!1),!P(e).valid)return!1;var i,o,u=e.split(/\s+/),s=u[0],a=0;_(t);for(var f=0;f<s.length;++f)"/"===(i=s.charAt(f))?a+=7:-1!=="0123456789".indexOf(i)?a+=parseInt(i,10):(o=i<"a"?n:r,K({type:i.toLowerCase(),color:o},J(a)),a++);return q=u[1]===r?r:n,w=parseInt(u[4],10),A=parseInt(u[5],10),x(E()),!0}function P(e){var t={0:"No errors.",1:"FEN string must contain six space-delimited fields.",2:"6th field (move number) must be a positive integer.",3:"5th field (half move counter) must be a non-negative integer.",4:"4th field (en-passant square) should be '-'.",5:"3rd field (castling availability) should be '-'.",6:"2nd field (side to move) is invalid.",7:"1st field (piece positions) does not contain 10 '/'-delimited rows.",8:"1st field (piece positions) is invalid [consecutive numbers].",9:"1st field (piece positions) is invalid [invalid piece].",10:"1st field (piece positions) is invalid [row too large].",11:"1st field (piece positions) is invalid [each side has one king].",12:"1st field (piece positions) is invalid [each side has no more than 2 advisers].",13:"1st field (piece positions) is invalid [each side has no more than 2 bishops].",14:"1st field (piece positions) is invalid [each side has no more than 2 knights].",15:"1st field (piece positions) is invalid [each side has no more than 2 rooks].",16:"1st field (piece positions) is invalid [each side has no more than 2 cannons].",17:"1st field (piece positions) is invalid [each side has no more than 5 pawns].",18:"1st field (piece positions) is invalid [black king should at right position].",19:"1st field (piece positions) is invalid [red king should at right position].",20:"1st field (piece positions) is invalid [black adviser should at right position].",21:"1st field (piece positions) is invalid [red adviser should at right position].",22:"1st field (piece positions) is invalid [black bishop should at right position].",23:"1st field (piece positions) is invalid [red bishop should at right position].",24:"1st field (piece positions) is invalid [black pawn should at right position].",25:"1st field (piece positions) is invalid [red pawn should at right position]."};function o(e){return{valid:0===e,error_number:e,error:t[e]}}var u=e.split(/\s+/);if(6!==u.length)return o(1);if(isNaN(u[5])||parseInt(u[5],10)<=0)return o(2);if(isNaN(u[4])||parseInt(u[4],10)<0)return o(3);if(!/^-$/.test(u[3]))return o(4);if(!/^-$/.test(u[2]))return o(5);if(!/^([rwb])$/.test(u[1]))return o(6);var s=u[0].split("/");if(10!==s.length)return o(7);var p,c,h,d,v={p:{number:0,squares:[]},P:{number:0,squares:[]},c:{number:0,squares:[]},C:{number:0,squares:[]},r:{number:0,squares:[]},R:{number:0,squares:[]},n:{number:0,squares:[]},N:{number:0,squares:[]},b:{number:0,squares:[]},B:{number:0,squares:[]},a:{number:0,squares:[]},A:{number:0,squares:[]},k:{number:0,squares:[]},K:{number:0,squares:[]}};for(p=0;p<s.length;p++){for(h=0,d=!1,c=0;c<s[p].length;c++)if(isNaN(s[p][c])){try{++v[s[p][c]].number}catch(e){return o(9)}v[s[p][c]].squares.push(p<<4|h),h+=1,d=!1}else{if(d)return o(8);h+=parseInt(s[p][c],10),d=!0}if(9!==h)return o(10)}if(1!==v.k.number||1!==v.K.number)return o(11);if(v.a.number>2||v.A.number>2)return o(12);if(v.b.number>2||v.B.number>2)return o(13);if(v.n.number>2||v.N.number>2)return o(14);if(v.r.number>2||v.R.number>2)return o(15);if(v.c.number>2||v.C.number>2)return o(16);if(v.p.number>5||v.P.number>5)return o(17);if(ne(l,v.k.squares[0],r))return o(18);if(ne(l,v.K.squares[0],n))return o(19);for(p=0;p<v.a.squares.length;++p)if(ne(f,v.a.squares[p],r))return o(20);for(p=0;p<v.A.squares.length;++p)if(ne(f,v.A.squares[p],n))return o(21);for(p=0;p<v.b.squares.length;++p)if(ne(a,v.b.squares[p],r))return o(22);for(p=0;p<v.B.squares.length;++p)if(ne(a,v.B.squares[p],n))return o(23);for(p=0;p<v.p.squares.length;++p)if(ne(i,v.p.squares[p],r))return o(24);for(p=0;p<v.P.squares.length;++p)if(ne(i,v.P.squares[p],n))return o(25);return o(0)}function E(){for(var e,r,t=0,i="",o=b.a9;o<=b.i0;++o)null==m[o]?t++:(t>0&&(i+=t,t=0),e=m[o].color,r=m[o].type,i+=e===n?r.toUpperCase():r.toLowerCase()),X(o)>=8&&(t>0&&(i+=t),o!==b.i0&&(i+="/"),t=0,o+=7);return[i,q,"-","-",w,A].join(" ")}function j(e){for(var r=0;r<e.length;r+=2)"string"==typeof e[r]&&"string"==typeof e[r+1]&&(k[e[r]]=e[r+1]);return k}function x(e){N.length>0||(e!==p?k.FEN=e:delete k.FEN)}function I(e){var r=m[b[e]];return r?{type:r.type,color:r.color}:null}function K(e,r){if(!("type"in e)||!("color"in e))return!1;if(-1==="pcrnbakPCRNBAK".indexOf(e.type.toLowerCase()))return!1;if(!(r in b))return!1;var n=b[r];return(e.type!==l||y[e.color]===t||y[e.color]===n)&&(!ne(e.type,n,e.color)&&(m[n]={type:e.type,color:e.color},e.type===l&&(y[e.color]=n),x(E()),!0))}function L(e){function r(e,r,n,t,i){r.push(function(e,r,n,t){var i={color:q,from:r,to:n,flags:t,piece:e[r].type};return e[n]&&(i.captured=e[n].type),i}(e,n,t,i))}var n,t,p,c,v,y,w,A,N=[],R=q,k=Y(R),_=b.a9,C=b.i0,O=void 0===e||!("legal"in e)||e.legal,P=void 0!==e&&"opponent"in e&&e.opponent;if(void 0!==e&&"square"in e){if(!(e.square in b))return[];_=C=b[e.square]}for(P&&(q=Y(q),k=Y(R=q)),n=_;n<=C;++n)if(null!=(c=m[n])&&c.color===R){for(t=0,p=(v=c.type===i?h[R]:d[c.type]).length;t<p&&(!(c.type===i&&t>0)||ee(n,R));++t)for(y=v[t],w=n,A=!1;!(re(w+=y)||c.type===s&&te(n,t)||c.type===a&&(ie(n,t)||ee(w,R))||(c.type===f||c.type===l)&&ne(c.type,w,R));){if(null==m[w]){if(c.type===o&&A)continue;r(m,N,n,w,g.NORMAL)}else{if(c.type!==o){m[w].color===k&&r(m,N,n,w,g.CAPTURE);break}if(A){m[w].color===k&&r(m,N,n,w,g.CAPTURE);break}A=!0}if(c.type!==o&&c.type!==u)break}X(n)>=8&&(n+=7)}if(!O)return N;var E=[];for(n=0,p=N.length;n<p;n++)D(N[n]),F(R)||E.push(N[n]),H();return P&&(q=Y(q)),E}function U(e,r){return J(e.from)+J(e.to)}function B(e){return e.replace(/=/,"").replace(/[+#]?[?!]*$/,"")}function F(e){var r,n,t,a=y[e],f=Y(e);for(r=0,n=d.n.length;r<n;++r)if(t=a+d.n[r],null!=m[t]&&!re(t)&&m[t].color===f&&m[t].type===s&&!te(t,r<4?3-r:11-r))return!0;for(r=0,n=d.r.length;r<n;++r){var p=d.r[r],c=!1;for(t=a+p;!re(t);t+=p){var v=m[t];if(null!=v){if(v.color===f)if(c){if(v.type===o)return!0}else if(v.type===u||v.type===l)return!0;if(c)break;c=!0}}}for(r=0,n=h[f].length;r<n;++r)if(t=a-h[f][r],null!=m[t]&&!re(t)&&m[t].color===f&&m[t].type===i)return!0;return!1}function $(){return F(q)}function z(){return $()&&0===L().length}function T(){return!$()&&0===L().length}function S(){var e,r={},n=0;for(var t in b)b.hasOwnProperty(t)&&(e=m[b[t]])&&(r[e.type]=e.type in r?r[e.type]+1:1,n++);return 2===n||void 0===r.n&&void 0===r.r&&void 0===r.c&&void 0===r.p}function G(){for(var e,r=[],n={},t=!1;e=H();)r.push(e);for(;;){var i=E().split(" ").slice(0,2).join(" ");if(n[i]=i in n?n[i]+1:1,n[i]>=3&&(t=!0),!r.length)break;D(r.pop())}return t}function M(e,r){e.push({move:r,kings:{b:y.b,r:y.r},turn:q,half_moves:w,move_number:A})}function D(e){M(N,e),null!=m[e.to]&&m[e.to].type===l&&(y[m[e.to].color]=t),m[e.to]=m[e.from],m[e.from]=null,m[e.to].type===l&&(y[m[e.to].color]=e.to),e.flags&g.CAPTURE?w=0:w++,q===r&&A++,q=Y(q)}function Z(e,r){if(void 0===r&&(r=!0),null==e)return null;var n=e.move;return y=e.kings,q=e.turn,w=e.half_moves,A=e.move_number,m[n.from]=m[n.to],m[n.from].type=n.piece,m[n.to]=null,(n.flags&g.CAPTURE)>0&&r&&(m[n.to]={type:n.captured,color:Y(q)}),n}function H(){return Z(N.pop())}function Q(){for(var e="   +---------------------------+\n",r=b.a9;r<=b.i0;r++){if(0===X(r)&&(e+=" "+"9876543210"[W(r)]+" |"),null==m[r])e+=" . ";else{var t=m[r].type;e+=" "+(m[r].color===n?t.toUpperCase():t.toLowerCase())+" "}8&r&&(e+="|\n",r+=7)}return e+="   +---------------------------+\n",e+="     a  b  c  d  e  f  g  h  i\n"}function V(e,r){var n,t,i,o=B(e),u=o.match(/([a-iA-I][0-9])-?([a-iA-I][0-9])/);r&&u&&(n=u[1],t=u[2],i=u[3]);for(var s=L(),a=0,f=s.length;a<f;a++){if(o===B(U(s[a]))||r&&o===B(U(s[a])))return s[a];if(u&&(!n||n.toLowerCase()===s[a].piece)&&b[t]===s[a].from&&b[i]===s[a].to)return s[a]}return null}function W(e){return e>>4}function X(e){return 15&e}function J(e){var r=X(e),n=W(e);return"abcdefghi".substring(r,r+1)+"9876543210".substring(n,n+1)}function Y(e){return e===n?r:n}function ee(e,r){return r===n?W(e)<5:W(e)>4}function re(e){return e<0||W(e)>9||X(e)>8}function ne(e,r,t){var o={};if(e===i)return o=[0,2,4,6,8],t===n?W(r)>6||W(r)>4&&-1===o.indexOf(X(r)):W(r)<3||W(r)<5&&-1===o.indexOf(X(r));if(e===a)o.r=[146,150,112,116,120,82,86],o.b=[2,6,32,36,40,66,70];else if(e===f)o.r=[147,149,132,115,117],o.b=[3,5,20,35,37];else{if(e!==l)return re(r);o.r=[147,148,149,131,132,133,115,116,117],o.b=[3,4,5,19,20,21,35,36,37]}return-1===o[t].indexOf(r)}function te(e,r){return null!=m[e+[-16,16,-1,1][Math.floor(r/2)]]}function ie(e,r){return null!=m[e+[-17,17,15,-15][r]]}function oe(e){var r=ue(e);r.iccs=U(r),r.to=J(r.to),r.from=J(r.from),r.piece=q===n?r.piece.toUpperCase():r.piece;var t="";for(var i in g)(g[i]&r.flags)>0&&(t+=v[i]);return r.flags=t,r}function ue(e){var r=e instanceof Array?[]:{};for(var n in e)r[n]="object"==typeof n?ue(e[n]):e[n];return r}function se(e){return e.replace(/^\s+|\s+$/g,"")}function ae(e){for(var r=L({legal:!1}),n=0,t=0,i=r.length;t<i;t++){if(D(r[t]),!F(q))if(e-1>0)n+=ae(e-1);else n++;H()}return n}return O(void 0===e?p:e),{RED:n,BLACK:r,PAWN:i,CANNON:o,ROOK:u,KNIGHT:s,BISHOP:a,ADVISER:f,KING:l,SQUARES:function(){for(var e=[],r=b.a9;r<=b.i0;r++)9!==X(r)?e.push(J(r)):r+=6;return e}(),FLAGS:v,load:function(e){return O(e)},reset:function(){return C()},moves:function(e){for(var r=L(e),n=[],t=0,i=r.length;t<i;t++)void 0!==e&&"verbose"in e&&e.verbose?n.push(oe(r[t])):n.push(U(r[t]));return n},in_check:function(){return $()},in_checkmate:function(){return z()},in_stalemate:function(){return T()},in_draw:function(){return w>=120||G()||S()},insufficient_material:function(){return S()},in_threefold_repetition:function(){return G()},game_over:function(){return w>=120||z()||T()||S()||G()||y[Y(q)]===t},validate_fen:function(e){return P(e)},fen:function(){return E()},board:function(){for(var e=[],r=[],n=b.a9;n<=b.i0;n++)null==m[n]?r.push(null):r.push({type:m[n].type,color:m[n].color}),8&n&&(e.push(r),r=[],n+=7);return e},pgn:function(e){var r,n="object"==typeof e&&"string"==typeof e.newline_char?e.newline_char:"\n",t="object"==typeof e&&"number"==typeof e.max_width?e.max_width:0,i=[],o=!1;for(r in k)i.push("["+r+' "'+k[r]+'"]'+n),o=!0;o&&N.length&&i.push(n);for(var u=[];N.length>0;)u.push(H());for(var s=[],a="";u.length>0;){var f=u.pop();N.length||"b"!==f.color?"b"!==f.color&&(a.length&&s.push(a),a=A+"."):a=A+". ...",a=a+" "+U(f),D(f)}if(a.length&&s.push(a),void 0!==k.Result&&s.push(k.Result),0===t)return i.join("")+s.join(" ");var l=0;for(r=0;r<s.length;r++)l+s[r].length>t&&0!==r?(" "===i[i.length-1]&&i.pop(),i.push(n),l=0):0!==r&&(i.push(" "),l++),i.push(s[r]),l+=s[r].length;return i.join("")},load_pgn:function(e,r){var n=void 0!==r&&"sloppy"in r&&r.sloppy;function t(e){return e.replace(/\\/g,"\\")}var i="object"==typeof r&&"string"==typeof r.newline_char?r.newline_char:"\r?\n",o=new RegExp("^(?:\\s)*(((?:"+t(i)+")*\\[[^\\]]+\\])+)"),u=o.test(e)?o.exec(e)[1]:"";C();var s=function(e,r){for(var n="object"==typeof r&&"string"==typeof r.newline_char?r.newline_char:"\r?\n",i={},o=e.split(new RegExp(t(n))),u="",s="",a=0;a<o.length;a++)u=o[a].replace(/^\[([A-Z][A-Za-z]*)\s.*]$/,"$1"),s=o[a].replace(/^\[[A-Za-z]+\s"(.*)"]$/,"$1"),se(u).length>0&&(i[u]=s);return i}(u,r);for(var a in s)s.hasOwnProperty(a)&&j([a,s[a]]);if("FEN"in s&&!O(s.FEN,!0))return console.warn("load header FEN failed!"),!1;var f=e.replace(u,"").replace(new RegExp(t(i),"g")," ");f=f.replace(/({[^}]+})+?/g,"");for(var l=/(\([^()]+\))+?/g;l.test(f);)f=f.replace(l,"");var p=se(f=(f=(f=f.replace(/\d+\.(\.\.)?/g,"")).replace(/\.\.\./g,"")).replace(/\$\d+/g,"")).split(new RegExp(/\s+/));p=p.join(",").replace(/,,+/g,",").split(",");for(var h="",d=0;d<p.length-1;d++){if(null==(h=V(p[d],n)))return console.warn("impossible move: "+p[d]+"!\n"+Q()),!1;D(h)}if(h=p[p.length-1],c.indexOf(h)>-1)(function(e){for(var r in e)if(e.hasOwnProperty(r))return!0;return!1})(k)&&void 0===k.Result&&j(["Result",h]);else{if(null==(h=V(h,n)))return console.warn("impossible last move: "+p[p.length-1]+"!\n"+Q()),!1;D(h)}return!0},header:function(){return j(arguments)},ascii:function(){return Q()},turn:function(){return q},move:function(e,r){var n=void 0!==r&&"sloppy"in r&&r.sloppy,t=null;if("string"==typeof e)t=V(e,n);else if("object"==typeof e)for(var i=L(),o=0,u=i.length;o<u;o++)if(e.from===J(i[o].from)&&e.to===J(i[o].to)&&!(""in i[o])){t=i[o];break}if(!t)return null;var s=oe(t);return D(t),R=[],s},undo:function(){M(R,null);var e=H();if(e){var r=oe(e),n=[e.to,e.from];return e.from=n[0],e.to=n[1],R[R.length-1].move=e,r}return R.pop(),null},redo:function(){M(N,null);var e=Z(R.pop(),!1);if(e){var r=[e.to,e.from];return e.from=r[0],e.to=r[1],N[N.length-1].move=e,oe(e)}return N.pop(),null},clear:function(){return _()},put:function(e,r){return K(e,r)},get:function(e){return I(e)},remove:function(e){return function(e){var r=I(e);return m[b[e]]=null,r&&r.type===l&&(y[r.color]=t),x(E()),r}(e)},perft:function(e){return ae(e)},history:function(e){for(var r=[],n=[],t=(void 0!==e&&"verbose"in e&&e.verbose);N.length>0;)r.push(H());for(;r.length>0;){var i=r.pop();t?n.push(oe(i)):n.push(U(i)),D(i)}return n}}}));r._RF.pop()}}}));

System.register("bundle://KKCoTuongBundle/_virtual/DebugHelper.ts",["cc","./TimeHelper.ts","./CocosHelper.ts"],(function(t){var e,n,o,i,r,a,l,d,c,g,u,s,v,h;return{setters:[function(t){e=t.cclegacy,n=t.log,o=t.warn,i=t.Color,r=t.error,a=t.Node,l=t.color,d=t.UITransform,c=t.Layout,g=t.ScrollView,u=t.Button,s=t.Label},function(t){v=t.default},function(t){h=t.default}],execute:function(){e._RF.push({},"3acbdy/4b9CtoNZOA4v1GTw","DebugHelper",void 0);var C=function(t){return t[t.NONE=0]="NONE",t[t.ERROR=1]="ERROR",t[t.WARN=2]="WARN",t[t.INFO=3]="INFO",t}(C||{});t("default",new(function(){function t(){this.Level=C,this.level=C.INFO,this.logContent=null}var e=t.prototype;return e.log=function(){if(this.level>=C.INFO){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];n.apply(void 0,["["+v.getCurDetailTime()+"]"].concat(e)),this.logContent&&this._addLblNode(JSON.stringify(e))}},e.warn=function(){if(this.level>=C.WARN){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];o.apply(void 0,["["+v.getCurDetailTime()+"]"].concat(e)),this.logContent&&this._addLblNode(JSON.stringify(e),i.YELLOW)}},e.error=function(){if(this.level>=C.ERROR){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];r.apply(void 0,["["+v.getCurDetailTime()+"]"].concat(e)),this.logContent&&this._addLblNode(JSON.stringify(e),i.RED)}},e.switchDebugLogBtn=function(){var t=h.getRoot().getChildByName("logBtn");t?t.active=!t.active:(this.level=C.INFO,this._initLogPanel())},e._initLogPanel=function(){var t=new a,e=h.getRoot();e.addChild(t),h.addSprite(t,{spriteFrame:h.genPureColorSpriteFrame(l(0,0,0,180))});var n=t.getComponent(d);n.setContentSize(e.getComponent(d).contentSize);var o=new a;o.addComponent(d).anchorY=1,o.parent=t,h.addWidget(o,{top:0}),h.addLayout(o,{type:c.Type.VERTICAL}),this.logContent=o;var r=t.addComponent(g);r.horizontal=!1,r.vertical=!0,r.bounceDuration=.23,r.brake=.75,r.content=o,t.active=!1;var s=new a("logBtn");s.addComponent(d).anchorX=1,s.setPosition(n.width/2,0),h.addLabel(s,{string:"DEBUG",fontSize:30,color:i.YELLOW,enableBold:!0}),e.addChild(s),s.addComponent(u),s.on(u.EventType.CLICK,(function(){t.active=!t.active}));var v=new a;v.setPosition(.5*n.width-100,.5*-n.height+100),h.addLabel(v,{string:"Clean",fontSize:30,color:i.RED,enableBold:!0}),t.addChild(v),v.addComponent(u),v.on(u.EventType.CLICK,(function(){o.removeAllChildren()}))},e._addLblNode=function(t,e){var n=new a;h.addLabel(n,{string:t,fontSize:24,color:e,overflow:s.Overflow.RESIZE_HEIGHT}),n.getComponent(d).width=this.logContent.parent.getComponent(d).width-20,n.parent=this.logContent},t}()));e._RF.pop()}}}));

System.register("bundle://KKCoTuongBundle/_virtual/DebugManger.ts",["cc","./kk.ts","./TimeHelper.ts","./CocosHelper.ts"],(function(e){var t,n,o,i,a,r,l,d,c,g,u,s,v,f,C;return{setters:[function(e){t=e.cclegacy,n=e.log,o=e.warn,i=e.Color,a=e.error,r=e.Node,l=e.color,d=e.UITransform,c=e.Layout,g=e.ScrollView,u=e.Button,s=e.Label},function(e){v=e.default},function(e){f=e.default},function(e){C=e.default}],execute:function(){t._RF.push({},"92a97FRRcFCp5MaT6sivuVS","DebugManger",void 0);var h=function(e){return e[e.NONE=0]="NONE",e[e.ERROR=1]="ERROR",e[e.WARN=2]="WARN",e[e.INFO=3]="INFO",e}(h||{});e("default",function(){function e(){this.level=h.INFO,this.logContent=null}var t=e.prototype;return t.log=function(){if(this.level>=h.INFO){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];n.apply(void 0,["["+f.getCurDetailTime()+"]"].concat(t)),this.logContent&&this._addLblNode(JSON.stringify(t))}},t.warn=function(){if(this.level>=h.WARN){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];o.apply(void 0,["["+f.getCurDetailTime()+"]"].concat(t)),this.logContent&&this._addLblNode(JSON.stringify(t),i.YELLOW)}},t.error=function(){if(this.level>=h.ERROR){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];a.apply(void 0,["["+f.getCurDetailTime()+"]"].concat(t)),this.logContent&&this._addLblNode(JSON.stringify(t),i.RED)}},t.switchDebugLogBtn=function(){var e=v.godNode.getChildByName("logBtn");e?e.active=!e.active:(this.level=h.INFO,this._initLogPanel())},t._initLogPanel=function(){var e=new r;v.godNode.addChild(e),C.addSprite(e,{spriteFrame:C.genPureColorSpriteFrame(l(0,0,0,180))});var t=e.getComponent(d);t.setContentSize(v.godNode.getComponent(d).contentSize);var n=new r;n.addComponent(d).anchorY=1,n.parent=e,C.addWidget(n,{top:0}),C.addLayout(n,{type:c.Type.VERTICAL}),this.logContent=n;var o=e.addComponent(g);o.horizontal=!1,o.vertical=!0,o.bounceDuration=.23,o.brake=.75,o.content=n,e.active=!1;var a=new r("logBtn");a.addComponent(d).anchorX=1,a.setPosition(t.width/2,0),C.addLabel(a,{string:"DEBUG",fontSize:30,color:i.YELLOW,enableBold:!0}),v.godNode.addChild(a),a.addComponent(u),a.on(u.EventType.CLICK,(function(){e.active=!e.active}));var s=new r;s.setPosition(.5*t.width-100,.5*-t.height+100),C.addLabel(s,{string:"Clean",fontSize:30,color:i.RED,enableBold:!0}),e.addChild(s),s.addComponent(u),s.on(u.EventType.CLICK,(function(){n.removeAllChildren()}))},t._addLblNode=function(e,t){var n=new r;C.addLabel(n,{string:e,fontSize:24,color:t,overflow:s.Overflow.RESIZE_HEIGHT}),n.getComponent(d).width=this.logContent.parent.getComponent(d).width-20,n.parent=this.logContent},e}()).Level=h,t._RF.pop()}}}));

System.register("bundle://KKCoTuongBundle/_virtual/EventManager.ts",["cc"],(function(t){var n;return{setters:[function(t){n=t.cclegacy}],execute:function(){n._RF.push({},"880304hnV5Pi7rmDyL9jULg","EventManager",void 0);t("default",function(){function t(){this._eventObjMap=new Map}var n=t.prototype;return n.on=function(t,n,e){this._on(t,n,e,!1)},n.once=function(t,n,e){this._on(t,n,e,!0)},n._on=function(t,n,e,a){var i=this._eventObjMap.get(t);i||(i=[],this._eventObjMap.set(t,i)),-1===i.findIndex((function(t){return t.target===e&&t.callback===n}))&&i.push({target:e,callback:n,once:a})},n.off=function(t,n,e){var a=this._eventObjMap.get(t);if(a)if(n&&e){var i=a.findIndex((function(t){return t.target===e&&t.callback===n}));-1!==i&&a.splice(i,1)}else a=null,this._eventObjMap.delete(t)},n.offTargetAll=function(t){this._eventObjMap.forEach((function(n,e){if(n)for(var a=n.length-1;a>=0;a--)n[a].target===t&&n.splice(a,1)}))},n.emit=function(t){var n=this._eventObjMap.get(t);if(n){for(var e=null,a=arguments.length,i=new Array(a>1?a-1:0),r=1;r<a;r++)i[r-1]=arguments[r];for(var c=n.length-1;c>=0;c--)(e=n[c]).callback.apply(e.target,i),e.once&&n.splice(c,1)}},t}());n._RF.pop()}}}));

System.register("bundle://KKCoTuongBundle/_virtual/GameCoTuongData.ts",["cc","./GameData.ts"],(function(t){var e,i;return{setters:[function(t){e=t.cclegacy},function(t){i=t.default}],execute:function(){e._RF.push({},"8e1c83c5UpOD5NdNfH+D3cg","GameCoTuongData",void 0);var s=t("Side",function(t){return t[t.RED=0]="RED",t[t.BLACK=1]="BLACK",t}({})),n=t("RoomStatus",function(t){return t[t.WAITING=0]="WAITING",t[t.COUNTDOWN=1]="COUNTDOWN",t[t.PLAYING=2]="PLAYING",t[t.FINISHED=3]="FINISHED",t}({}));t("default",new(function(){function t(){this.isLeaveRoom=!1,this.side=s.RED,this.viewerSide=s.RED,this.id=void 0,this.fen=null,this.countDown=25,this.status=n.WAITING,this.otherPlayer=null,this.cloneOtherPlayer=null,this.players=[],this.owner=null,this.history=[],this.isViewer=!1}var e=t.prototype;return e.setData=function(t){this.id=t.id,this.players=t.players,this.status=t.status,this.countDown=t.countdown,this.history=null==t?void 0:t.history,this.isLeaveRoom=!1,this.otherPlayer=t.players.find((function(t){return t.username!=i.info.username})),this.otherPlayer&&(this.cloneOtherPlayer=JSON.parse(JSON.stringify(this.otherPlayer)))},e.leaveRoom=function(){this.isLeaveRoom=!0,this.id=null,this.players=null,this.status=n.WAITING,this.countDown=25,this.history=null,this.otherPlayer=null,this.cloneOtherPlayer=null,this.fen=null,this.isViewer=!1},t}()));e._RF.pop()}}}));

System.register("bundle://KKCoTuongBundle/_virtual/GameData.ts",["./rollupPluginModLoBabelHelpers.js","cc","./kk.ts","./CocosHelper.ts"],(function(e){var t,i,o,s;return{setters:[function(e){t=e.createClass},function(e){i=e.cclegacy},function(e){o=e.default},function(e){s=e.coin}],execute:function(){i._RF.push({},"c7eaevsO9RA0p/DL5eXf7Mk","GameData",void 0);e("default",new(function(){function e(){this.id=void 0,this.username=void 0,this.displayName=void 0,this.token=void 0,this.refreshToken=void 0,this.gold=void 0,this.goldFree=void 0,this._elo=void 0,this._elobanqi=void 0,this.changedElo=0,this._isLoggedIn=!1}var i=e.prototype;return i.getElo=function(e){return void 0===e&&(e=!1),e?this._elobanqi:this._elo},i.setELo=function(e,t){void 0===t&&(t=!1),t?(this.changedElo=e-this._elobanqi,this._elobanqi=e):(this.changedElo=e-this._elo,this._elo=e)},i.login=function(e){var t=e.id,i=e.username,s=e.token,n=e.gold,l=e.goldFree,d=e.password,r=e.refreshToken,a=e.displayName;this.id=t,this.username=i,this.displayName=a,this.token=s,this.refreshToken=r,this.gold=n||0,this.goldFree=l||0,this._isLoggedIn=!0,o.localMgr.setItem("token",s,!0),o.localMgr.setItem("refreshToken",r,!0),o.localMgr.setItem("username",i,!0),o.localMgr.setItem("password",d,!0)},i.logout=function(){this.id=null,this.username=null,this.displayName=null,this.token=null,this.refreshToken=null,this.gold=0,this.goldFree=0,this._isLoggedIn=!1},i.updateDisplayName=function(e){this.displayName=e},t(e,[{key:"info",get:function(){return{id:this.id,username:this.username,displayName:this.displayName,token:this.token,gold:this.gold,goldFree:this.goldFree,goldString:s(this.gold),goldFreeString:s(this.goldFree)}}},{key:"isLoggedIn",get:function(){return this._isLoggedIn}}]),e}()));i._RF.pop()}}}));

System.register("bundle://KKCoTuongBundle/_virtual/GameManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UIBase.ts","./KKTileCoTuongWidget.ts","./KKPieceWidget.ts","./kk.ts","./GameCoTuongData.ts","./SocketIO.ts","./SocketEvent.ts","./Xiangqi.ts","./MessageEvent.ts","./AudioPath.ts","./Banqi.ts"],(function(e){var i,t,n,o,r,a,c,s,l,u,h,f,d,g,v,p,P,b,m,y,T,w,A,C,q,M,x,_,k,I;return{setters:[function(e){i=e.applyDecoratedDescriptor,t=e.inheritsLoose,n=e.initializerDefineProperty,o=e.assertThisInitialized,r=e.createClass,a=e.asyncToGenerator,c=e.regeneratorRuntime},function(e){s=e.cclegacy,l=e._decorator,u=e.Node,h=e.Prefab,f=e.sp,d=e.NodePool,g=e.instantiate},function(e){v=e.UIBase},function(e){p=e.KKTileCoTuongWidget},function(e){P=e.KKPieceWidget,b=e.Side,m=e.PieceType},function(e){y=e.default},function(e){T=e.default},function(e){w=e.default},function(e){A=e.SocketEvent,C=e.typeSocket,q=e.actionID},function(e){M=e.default},function(e){x=e.MessageEventType},function(e){_=e.randomSound,k=e.AudioPath},function(e){I=e.default}],execute:function(){var E,D,S,B,K,L,z,H,F,O,R,G,U,N,Q,W,j,V,Y,X;s._RF.push({},"c6e4c6GH8VGhrliUjszojDw","GameManager",void 0);var $=l.ccclass,J=l.property;e("GameManager",(E=$("GameManager"),D=J(u),S=J([h]),B=J(h),K=J(h),L=J(f.Skeleton),z=J(f.Skeleton),H=J(f.Skeleton),F=J(P),E(((X=function(e){function i(){for(var i,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return i=e.call.apply(e,[this].concat(r))||this,n(i,"container",G,o(i)),n(i,"piecePrefabs",U,o(i)),n(i,"piecePrefab",N,o(i)),n(i,"tilePrefab",Q,o(i)),n(i,"chieuTuong",W,o(i)),n(i,"batDau",j,o(i)),n(i,"anQuan",V,o(i)),i.xiangqi=null,i.isBanqi=!1,n(i,"selectedPiece",Y,o(i)),i.board=[],i.isPlay=!1,i.isCanReload=!1,i.piecePool=new d,i.tilePool=new d,i.pieceManager=[],i}t(i,e);var s=i.prototype;return s.initGame=function(e){e?(this.isBanqi=!0,this.xiangqi=I()):this.xiangqi=M()},s.putToPiecePool=function(e){this.piecePool.put(e)},s.getBoard=function(){return this.board},s.onLoad=function(){var e=this;y.eventMgr.on(x.ON_SELECT_TILE,this.onSelectPiece,this),y.eventMgr.on(x.ON_MOVE_PIECE,this.onMove,this),y.eventMgr.on(x.PUT_TO_POOL,this.putToPiecePool,this),y.eventMgr.on(x.SHOW_HISTORY,this.showHistory,this),w.on(A.makeMove,(function(i){i&&(console.log("Nhận dữ liệu di chuyển từ server:",i),e.movePieceToTile(i),T.fen=null==i?void 0:i.fen),e.selectedPiece&&(e.selectedPiece.unActive(),e.selectedPiece=null)})),i._instance||(i._instance=this),this.initPiecePool(32),this.initTilePool(90)},s.onDestroy=function(){i._instance=null,e.prototype.onDestroy.call(this),w.off(A.makeMove),y.eventMgr.offTargetAll(this),this.piecePool.clear(),this.tilePool.clear()},s.initPiecePool=function(e){for(var i=0;i<e;i++){var t=g(this.piecePrefab);this.piecePool.put(t)}},s.initTilePool=function(e){for(var i=0;i<e;i++){var t=g(this.tilePrefab);this.tilePool.put(t)}},s.createBoard=function(e){void 0===e&&(e=b.RED),this.xiangqi.load(T.fen),this.board=[];for(var i=0;i<10;i++){for(var t=[],n=0;n<9;n++){var o=void 0;o=this.tilePool.size()>0?this.tilePool.get():g(this.tilePrefab);var r=void 0,a=void 0;e===b.BLACK?(r=116*(8-n)-484+20,a=116*(9-i)-527):(r=116*n-484+20,a=116*i-527),o.setPosition(r,a);var c=o.getComponent(p);c&&c.init(i,n),o.name=i+"_"+n,this.container.addChild(o),t.push(o)}this.board.push(t)}console.log("CREATE BOARD")},s.setupPieces=function(){var e,i=null==(e=this.xiangqi)?void 0:e.board();if(i)for(var t=0;t<i.length;t++)for(var n=0;n<i[t].length;n++){var o=i[t][n];if(null!==o){var r=o.type,a="r"===o.color?b.RED:b.BLACK,c=9-t,s=n;this.placePiece(r,a,c,s)}}},s.placePiece=function(e,i,t,n){var o,r=(o=this.piecePool.size()>0?this.piecePool.get():g(this.piecePrefab)).getComponent(P);r&&(r.name=m[e]+"_"+b[i],r.init(t,n,e,i),r.unActive(),this.board[t]&&this.board[t][n]?this.board[t][n].addChild(o):console.error("Board index lỗi: row "+t+", col "+n),this.pieceManager.push(r))},s.resetBoard=function(){if(this.isPlay){this.isPlay=!1,this.selectedPiece=null,this.pieceManager=[];for(var e=0;e<this.board.length;e++)for(var i=0;i<this.board[e].length;i++){var t=this.board[e][i];if(t){var n=t.getComponentInChildren(P);n&&(n.node.removeFromParent(),this.piecePool.put(n.node));var o=t.getComponent(p);o&&(o.hide(),o.hideHistory()),t.removeFromParent(),this.tilePool.put(t)}}this.board=[]}},s.onSelectPiece=function(e){var i,t,n,o=this;if(y.eventMgr.emit(x.HIDE_TILE),!e)return console.warn("Quân cờ không tồn tại"),void(null==(t=this.selectedPiece)||t.unActive());if(T.side!==this.currentTurn)return console.log("Không thể chọn quân cờ: không đúng lượt"),void(null==(n=this.selectedPiece)||n.unActive());if(this.selectedPiece&&this.selectedPiece.side!==e.side)console.log("Không thể chọn quân cờ của đối phương");else{var r;if(this.currentTurn!==e.side||this.selectedPiece===e)return console.log("Không phải lượt của bạn",e,this.currentTurn),null==(r=this.selectedPiece)||r.unActive(),void(this.selectedPiece=null);var a,c=this.convertToAscii(e.row,e.col);try{a=this.xiangqi?this.xiangqi.moves({square:c,verbose:!0}):[]}catch(e){return void console.error("Lỗi tính toán nước đi:",e)}null==(i=this.selectedPiece)||i.unActive(),this.selectedPiece=e,this.selectedPiece.active(),console.log("Chọn quân cờ:",e.name,"với nước đi:",c,a),a.forEach((function(i){var t=o.convertFromAscii(i.to),n=t.row,r=t.col,a=o.board[n]&&o.board[n][r]?o.board[n][r].getComponent(p):null;if(a){var c=o.board[n][r].getComponentInChildren(P);c&&c.side!==e.side&&(a.activeAttack(),a.node.setSiblingIndex(100)),a.active()}}))}},s.startGame=function(e,i){this.isPlay||(i&&(this.batDau.node.active=!0,this.batDau.setAnimation(0,"animation",!1),_(k.effect,"giaophong",!0,!1),_(k.effect,"start",!0,!1)),this.isPlay=!0,this.board=[],this.createBoard(e),this.setupPieces())},s.onMove=function(e){if(this.selectedPiece&&(e.pos.col!==this.selectedPiece.col||e.pos.row!==this.selectedPiece.row)){var i=""+this.convertToAscii(this.selectedPiece.row,this.selectedPiece.col)+this.convertToAscii(e.pos.row,e.pos.col);w.reqAsync(A.actions,{type:this.isBanqi?C.coUp:C.coTuong,actionID:q.makeMove,roomId:T.id,move:i})}},s.movePieceToTile=function(e){if(e){var i,t=this.convertFromAscii(e.from),n=this.convertFromAscii(e.to);try{i=!!this.xiangqi&&this.xiangqi.move(""+e.from+e.to,{type:null==e?void 0:e.piece})}catch(e){return void console.error("Lỗi di chuyển từ server:",e)}if(i){"c"!==e.flags||this.xiangqi.in_check()||(this.anQuan.node.active=!0,this.anQuan.setAnimation(0,"animation",!1),_(k.effect,"anquan",!0,!1));var o=this.board[t.row]?this.board[t.row][t.col]:null;if(o){var r=o.getComponentInChildren(P),a=this.board[n.row]?this.board[n.row][n.col]:null;r&&a&&(this.movePiece(r,a.getComponent(p)),this.isBanqi&&r.show(e.piece))}}else console.log("Không thể di chuyển")}},s.movePiece=function(){var e=a(c().mark((function e(i,t){var n,o,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i&&t){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,i.onMovePiece(t);case 4:try{n=!!this.xiangqi&&this.xiangqi.in_check(),o=!!this.xiangqi&&this.xiangqi.in_draw(),r=!!this.xiangqi&&this.xiangqi.game_over(),o?console.log("Hòa"):n&&(this.chieuTuong.node.active=!0,r?(this.chieuTuong.setAnimation(0,"chieubi",!1),_(k.effect,"chieubi",!0,!1)):(this.chieuTuong.setAnimation(0,"chieutuong",!1),_(k.effect,"chieu",!0,!1)))}catch(e){console.error("Lỗi khi kiểm tra trạng thái game:",e)}case 5:case"end":return e.stop()}}),e,this)})));return function(i,t){return e.apply(this,arguments)}}(),s.showHistory=function(){var e;y.eventMgr.emit(x.HIDE_TILE_HISTORY);var i=null==(e=this.xiangqi)?void 0:e.getHistory();if(this.xiangqi&&!(i.length<=0)){var t=i.pop();if(t){var n=this.convertFromAscii(t.from),o=this.convertFromAscii(t.to),r=this.board[n.row]?this.board[n.row][n.col]:null,a=this.board[o.row]?this.board[o.row][o.col]:null;if(r&&a){var c=r.getComponent(p),s=a.getComponent(p);c&&c.showFrom(),s&&s.showTo()}}}},s.getPiece=function(e,i){return this.pieceManager.find((function(t){return t.type===e&&t.side===i}))},s.convertToAscii=function(e,i){return(""+String.fromCharCode(65+i)+e).toLowerCase()},s.convertFromAscii=function(e){var i=e.toUpperCase().match(/^([A-I])(\d)$/);if(!i)return console.error("Định dạng ASCII không hợp lệ: "+e),{row:-1,col:-1};var t=i[1],n=i[2],o=t.charCodeAt(0)-65;return{row:parseInt(n),col:o}},s.isMyTurn=function(){return T.side==this.currentTurn},r(i,[{key:"currentTurn",get:function(){return"r"===this.xiangqi.turn()?b.RED:b.BLACK}}],[{key:"instance",get:function(){return this._instance}}]),i}(v))._instance=null,G=i((R=X).prototype,"container",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=i(R.prototype,"piecePrefabs",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),N=i(R.prototype,"piecePrefab",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Q=i(R.prototype,"tilePrefab",[K],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=i(R.prototype,"chieuTuong",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=i(R.prototype,"batDau",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=i(R.prototype,"anQuan",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Y=i(R.prototype,"selectedPiece",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=R))||O));s._RF.pop()}}}));

System.register("bundle://KKCoTuongBundle/_virtual/HttpManager.ts",["cc","./DebugHelper.ts"],(function(e){var t,o;return{setters:[function(e){t=e.cclegacy},function(e){o=e.default}],execute:function(){t._RF.push({},"27e7cz+RAxJ2Lc6W/RVFIDA","HttpManager",void 0);e("default",function(){function e(){}var t=e.prototype;return t.reqAsync=function(e,t){var o=this;return void 0===t&&(t={}),new Promise((function(n,r){o._request({url:e,timeout:t.timeout||8e3,responseType:t.responseType||"json",contentType:t.contentType||"application/x-www-form-urlencoded",method:t.method||(t.body?"POST":"GET"),body:t.body,token:t.token},n,r)}))},t._request=function(e,t,n){var r=new XMLHttpRequest;r.timeout=e.timeout,r.responseType=e.responseType,r.onreadystatechange=function(){var s,u,i,a;4===r.readyState&&((null==(s=r.response)?void 0:s.statusCode)>=200&&(null==(u=r.response)?void 0:u.statusCode)<=400?(o.log({url:e.url,body:e.body,recv:r.response}),t(r.response)):401==(null==(i=r.response)?void 0:i.statusCode)||403==(null==(a=r.response)?void 0:a.statusCode)?t(r.response):n("Please Check Network! "+r.status))},r.ontimeout=function(){n("Time Out")},r.onabort=function(){n("Network Abort")},r.onerror=function(){n("Network Error")},r.open(e.method,e.url,!0),e.token&&r.setRequestHeader("Authorization","Bearer "+e.token);var s=null;if(e.body)if(r.setRequestHeader("Content-Type",e.contentType),"application/x-www-form-urlencoded"==e.contentType){var u=[];for(var i in e.body)u.push("".concat(i,"=",e.body[i]));s=u.join("&")}else s="application/json"==e.contentType?JSON.stringify(e.body):e.body;r.send(s)},e}());t._RF.pop()}}}));

System.register("bundle://KKCoTuongBundle/_virtual/kk.ts",["cc","./UIManager.ts","./LocalManager.ts","./SoundManager.ts","./EventManager.ts","./DebugManger.ts","./HttpManager.ts","./SocketManager.ts","./LocalizationManager.ts","./Config.ts","./SkinManager.ts"],(function(n){var e,t,a,o,u,g,i,c,f,r,d,s;return{setters:[function(n){e=n.cclegacy,t=n.find},function(n){a=n.default},function(n){o=n.default},function(n){u=n.default},function(n){g=n.default},function(n){i=n.default},function(n){c=n.default},function(n){f=n.default},function(n){r=n.LocalizationManager},function(n){d=n.Config},function(n){s=n.SkinGameManager}],execute:function(){e._RF.push({},"d1b197geZhNFbP/VTdLfvan","kk",void 0);var l=n("default",{uiMgr:new a,localMgr:new o,soundMgr:new u,eventMgr:new g,debugMgr:new i,httpMgr:new c,socketMgr:new f,godNode:null,lang:new r,config:new d,skinsMgr:new s,init:function(){l.godNode=t("Canvas")}});e._RF.pop()}}}));

System.register("bundle://KKCoTuongBundle/_virtual/KKAvatarWidget.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UIBase.ts","./KKCountDownCircleWidget.ts","./GameData.ts","./CocosHelper.ts"],(function(t){var e,i,n,r,a,o,u,s,l,p,c,h,f,g,b;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,n=t.initializerDefineProperty,r=t.assertThisInitialized},function(t){a=t.cclegacy,o=t._decorator,u=t.Enum,s=t.CCInteger,l=t.Sprite,p=t.SpriteFrame,c=t.CCBoolean},function(t){h=t.UIBase},function(t){f=t.KKCountDownCircleWidget},function(t){g=t.default},function(t){b=t.getRankByElo}],execute:function(){var d,m,K,y,v,w,H,S,C,z,D,B,E,F,A,I,M,N,T,W,q,G,P,_,j;a._RF.push({},"a179077Vn9FqJPXHTCq4MGN","KKAvatarWidget",void 0);var x=o.ccclass,L=o.property,O=(o.executeInEditMode,t("DANH_HIEU",function(t){return t[t["Nhập môn"]=0]="Nhập môn",t[t["Tập sự"]=1]="Tập sự",t[t["Phong trào"]=2]="Phong trào",t[t["Kỳ thủ"]=3]="Kỳ thủ",t[t["Kỳ sỹ"]=4]="Kỳ sỹ",t[t["Kỳ vương"]=5]="Kỳ vương",t}({})));u(O);t("KKAvatarWidget",(d=x("KKAvatarWidget"),m=L({type:O,displayName:"Danh Hiệu"}),K=L(s),y=L({type:[l]}),v=L({type:[p]}),w=L({type:[p]}),H=L(l),S=L(l),C=L(f),z=L(c),D=L(c),B=L(c),d((A=e((F=function(t){function e(){for(var e,i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a))||this,n(e,"danhHieu",A,r(e)),n(e,"star",I,r(e)),n(e,"spStar",M,r(e)),n(e,"spfStar",N,r(e)),n(e,"spfKhung",T,r(e)),n(e,"spAvatar",W,r(e)),n(e,"spKhung",q,r(e)),n(e,"countDown",G,r(e)),n(e,"isMe",P,r(e)),n(e,"isBanqi",_,r(e)),n(e,"isGetHigher",j,r(e)),e}i(e,t);var a=e.prototype;return a.onLoad=function(){this.spStar=this.getObj("star").getComponentsInChildren(l)},a.onEnable=function(){if(this.isMe)if(this.isGetHigher){var t=g.getElo(!0),e=g.getElo(),i=Math.max(e,t),n=b(i);this.star=n.star,this.danhHieu=O[n.name]}else{var r=g.getElo(this.isBanqi),a=b(r);this.star=a.star,this.danhHieu=O[a.name]}this.updateSprite()},a.init=function(t){var e=b(t);e&&(this.star=null==e?void 0:e.star,this.danhHieu=O[null==e?void 0:e.name],this.updateSprite())},a.startFill=function(t,e){void 0===e&&(e=!0),this.countDown.startFill(t,e)},a.updateSprite=function(){this.spKhung.spriteFrame=this.spfKhung[this.danhHieu],this.updateStar()},a.updateStar=function(){var t=this;this.danhHieu!=O["Nhập môn"]?(this.getObj("star").active=!0,this.spStar.forEach((function(e,i){i<t.star?e.spriteFrame=t.spfStar[0]:e.spriteFrame=t.spfStar[1]}))):this.getObj("star").active=!1},a.onBtnClick=function(t,e){},e}(h)).prototype,"danhHieu",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return O["Tập sự"]}}),I=e(F.prototype,"star",[K],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),M=e(F.prototype,"spStar",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),N=e(F.prototype,"spfStar",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),T=e(F.prototype,"spfKhung",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),W=e(F.prototype,"spAvatar",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),q=e(F.prototype,"spKhung",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),G=e(F.prototype,"countDown",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P=e(F.prototype,"isMe",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),_=e(F.prototype,"isBanqi",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),j=e(F.prototype,"isGetHigher",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),E=F))||E));a._RF.pop()}}}));

System.register("bundle://KKCoTuongBundle/_virtual/KKBanCoPanel.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UIBase.ts","./GameManager.ts"],(function(n){var e,t,a,o,i;return{setters:[function(n){e=n.inheritsLoose},function(n){t=n.cclegacy,a=n._decorator},function(n){o=n.UIBase},function(n){i=n.GameManager}],execute:function(){var r;t._RF.push({},"e5e62OVw9NKtZEJwIwAZj9H","KKBanCoPanel",void 0);var c=a.ccclass;a.property,n("KKBanCoPanel",c("KKBanCoPanel")(r=function(n){function t(){return n.apply(this,arguments)||this}e(t,n);var a=t.prototype;return a.onEnable=function(){var n;i.instance.initGame(null==(n=this.recvData)?void 0:n.isBanqi)},a.onBtnClick=function(n,e){},t}(o))||r);t._RF.pop()}}}));

System.register("bundle://KKCoTuongBundle/_virtual/KKCauHoaPopup.ts",["./rollupPluginModLoBabelHelpers.js","cc","./PopupBase.ts","./SocketEvent.ts","./SocketIO.ts","./GameManager.ts"],(function(o){var t,n,e,c,a,u,s,i,p;return{setters:[function(o){t=o.inheritsLoose},function(o){n=o.cclegacy,e=o._decorator},function(o){c=o.PopupBase},function(o){a=o.typeSocket,u=o.SocketEvent,s=o.actionID},function(o){i=o.default},function(o){p=o.GameManager}],execute:function(){var r;n._RF.push({},"d8931MLgOhOgJ07RHEmi8Vh","KKCauHoaPopup",void 0);var l=e.ccclass;e.property,o("KKCauHoaPopup",l("KKCauHoaPopup")(r=function(o){function n(){return o.apply(this,arguments)||this}return t(n,o),n.prototype.onBtnClick=function(o,t){var n=p.instance.isBanqi?a.coUp:a.coTuong;switch(t){case"ok":case"no":i.reqAsync(u.actions,{type:n,actionID:s.peaceAnswer,isOk:"ok"==t}),this.close()}},n}(c))||r);n._RF.pop()}}}));

System.register("bundle://KKCoTuongBundle/_virtual/KKCoTuongBundle",["./Banqi.ts","./CoUpLogic.ts","./GameManager.ts","./KKBanCoPanel.ts","./KKCauHoaPopup.ts","./KKCoTuongLayer.ts","./KKEndGamePopup.ts","./KKMenuPopup.ts","./KKPieceWidget.ts","./KKTileCoTuongWidget.ts","./Xiangqi.ts"],(function(){return{setters:[null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

System.register("bundle://KKCoTuongBundle/_virtual/KKCoTuongLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./LayerBase.ts","./kk.ts","./KKGameUIConf.ts","./SocketIO.ts","./SocketEvent.ts","./GameCoTuongData.ts","./GameData.ts","./SpriteNumber.ts","./CocosHelper.ts","./GameManager.ts","./KKEndGamePopup.ts","./KKUtils.ts","./KKAvatarWidget.ts","./AsyncHelper.ts","./LabelEllipsis.ts"],(function(e){var t,n,i,r,o,a,s,l,u,c,p,d,f,h,y,m,b,g,w,v,T,C,P,E,K,k,R,D,L,A,N,x,I;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,r=e.assertThisInitialized,o=e.asyncToGenerator,a=e.regeneratorRuntime},function(e){s=e.cclegacy,l=e._decorator,u=e.Node,c=e.Label},function(e){p=e.LayerBase},function(e){d=e.default},function(e){f=e.KKCoTuongPopupConf,h=e.KKLayerConf,y=e.KKCoTuongPanelConf,m=e.KKHomePopupConf},function(e){b=e.default},function(e){g=e.SocketEvent,w=e.typeSocket,v=e.actionID},function(e){T=e.default,C=e.Side,P=e.RoomStatus},function(e){E=e.default},function(e){K=e.SpriteNumber},function(e){k=e.secondsToMinute,R=e.coin},function(e){D=e.GameManager},function(e){L=e.EFFECT},function(e){A=e.default},function(e){N=e.KKAvatarWidget},function(e){x=e.default},function(e){I=e.EllipsisLabel}],execute:function(){var G,O,M,F,S,B,z,V,H,W,j,q,U,_,Y,Z,J,Q,X,$,ee,te,ne;s._RF.push({},"3c0e2tHY49ARKWZ03Oj047/","KKCoTuongLayer",void 0);var ie=l.ccclass,re=l.property;e("KKCoTuongLayer",(G=ie("KKCoTuongLayer"),O=re(u),M=re(I),F=re(I),S=re(u),B=re(u),z=re({type:[u],displayName:"Ảnh chữ sẵn sàng",tooltip:"[0] => Me; [1] => Other Player"}),V=re({type:[c],displayName:"Lable hiển thị thời gian",tooltip:"[0] => Me; [1] => Other Player"}),H=re({type:[c],displayName:"Lable hiển thị elo",tooltip:"[0] => Me; [1] => Other Player"}),W=re({type:[N],displayName:"Sprite hiển thị thời gian",tooltip:"[0] => Me; [1] => Other Player"}),j=re(K),G((_=t((U=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return t=e.call.apply(e,[this].concat(o))||this,i(t,"otherPlayer",_,r(t)),i(t,"otherName",Y,r(t)),i(t,"myName",Z,r(t)),i(t,"controller",J,r(t)),i(t,"waiting",Q,r(t)),i(t,"spReady",X,r(t)),i(t,"lbTimes",$,r(t)),i(t,"lbElo",ee,r(t)),i(t,"spCountdown",te,r(t)),i(t,"time",ne,r(t)),t.isShowEffect=!1,t}n(t,e);var s=t.prototype;return s.onLoad=function(){var e,t;this.time=this.getObj("controller.time",K),T.isLeaveRoom=!1,T.isViewer=null==(e=this.recvData)?void 0:e.isViewer,T.id=null==(t=this.recvData)?void 0:t.roomID},s.start=function(){var e=o(a().mark((function e(){var t,n,i,r=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return T.isViewer||(b.on(g.peace,(function(){d.uiMgr.showPopupAsync(f.CauHoa)})),b.on(g.messageCoTuong,(function(e){A.showToast(e)})),b.on(g.peaceAnswer,(function(){r.showEnd(L.hoa),r.spCountdown[0].startFill(0,!1),r.spCountdown[1].startFill(0,!1)}))),b.on(g.startGame,(function(){var e;null==D||null==(e=D.instance)||e.resetBoard()})),b.reqAsync(g.actions,{type:w.coTuong,actionID:v.joinRoom,roomID:null==(t=this.recvData)?void 0:t.roomID}),b.on(g.dataRoom,o(a().mark((function e(t){var n,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.id!=T.id&&null!=T&&T.id||T.isLeaveRoom)){e.next=2;break}return e.abrupt("return");case 2:if(e.prev=2,!t){e.next=23;break}if(r.waiting.active=t.status==P.WAITING&&!T.isViewer,t.fen&&(T.fen=t.fen),T.isViewer){e.next=21;break}if(null!=t&&null!=(n=t.players)&&n.some((function(e){return(null==e?void 0:e.id)==E.info.id}))?(T.setData(t),r.updateLayer()):(T.leaveRoom(),r.goBackHome()),null==t||!t.loser){e.next=19;break}if(i=t.loser.id==E.info.id,!d.uiMgr.getPopup(f.EndGame)&&!r.isShowEffect){e.next=13;break}return e.abrupt("return");case 13:return r.isShowEffect=!0,e.next=16,x.sleepAsync(.8);case 16:i?r.showEnd(L.thua):r.showEnd(L.thang),r.spCountdown[0].startFill(0,!1),r.spCountdown[1].startFill(0,!1);case 19:e.next=23;break;case 21:T.setData(t),r.updateInfoPlayerForViewer();case 23:e.next=29;break;case 25:e.prev=25,e.t0=e.catch(2),T.leaveRoom(),r.goBackHome();case 29:case"end":return e.stop()}}),e,null,[[2,25]])})))),b.on(g.countDown,o(a().mark((function e(t){var n,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.id==T.id||null==T||!T.id){e.next=2;break}return e.abrupt("return");case 2:i=null==t||null==(n=t.players)?void 0:n.find((function(e){return e.isReady&&e.id==E.info.id})),r.time&&(r.time.value=t.countdown),T.isViewer||(t.status!=P.COUNTDOWN?r.controller.active=!1:r.controller.active=!i),t.status==P.PLAYING?r.updatePlaying(t):t.status!=P.COUNTDOWN&&t.status!=P.WAITING||(r.waiting.active=t.status==P.WAITING);case 6:case"end":return e.stop()}}),e)})))),n=this.getObj("ban"),e.next=8,d.uiMgr.createPanelAsync(y.BanCo);case 8:i=e.sent,n.addChild(i),this.getObj("menu.btn-hoa").active=!T.isViewer,this.getObj("menu.btn-doi").active=T.isViewer;case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),s.onDestroy=function(){b.off(g.dataRoom),b.off(g.peace),b.off(g.peaceAnswer),b.off(g.countDown),b.off(g.messageCoTuong),b.off(g.startGame)},s.showEnd=function(e){var t,n,i,r;d.uiMgr.showPopupAsync(f.EndGame,{effect:e,name:null!=(t=null==(n=T.cloneOtherPlayer)?void 0:n.displayname)?t:null==(i=T.cloneOtherPlayer)?void 0:i.username,elo:null==(r=T.cloneOtherPlayer)?void 0:r.elo})},s.updatePlaying=function(e){if(T.isViewer){var t=null==e?void 0:e.playerTime[T.side],n=null==e?void 0:e.playerTime[T.side==C.RED?C.BLACK:C.RED];this.lbTimes[0].string=k(t||0),this.lbTimes[1].string=k(n||0),D.instance.startGame(T.side,!0),this.spCountdown[0].startFill(e.countdown,T.side==e.currentTurn),this.spCountdown[1].startFill(e.countdown,T.side!=e.currentTurn),this.isShowEffect=!1}else{var i=e.players.find((function(e){return e.id==E.info.id})),r=null==e?void 0:e.playerTime[i.side],o=null==e?void 0:e.playerTime[i.side==C.RED?C.BLACK:C.RED];this.lbTimes[0].string=k(r||0),this.lbTimes[1].string=k(o||0),T.side=i.side,D.instance.startGame(i.side,!0),this.spCountdown[0].startFill(e.countdown,i.side==e.currentTurn),this.spCountdown[1].startFill(e.countdown,i.side!=e.currentTurn),this.isShowEffect=!1}},s.updateInfoPlayerForViewer=function(){var e,t,n,i,r=T.players.find((function(e){return e.side==T.side})),o=T.players.find((function(e){return e.side!=T.side}));r&&(this.myName.setLabelText(null!=(e=r.displayname)?e:r.username),this.lbElo[0].string=R(r.elo),null==(t=this.spCountdown[0])||t.init(r.elo));o?(this.otherPlayer.active=!0,this.otherName.setLabelText(null!=(n=o.displayname)?n:o.username),this.lbElo[1].string=R(o.elo),null==(i=this.spCountdown[1])||i.init(o.elo)):this.otherPlayer.active=!1;this.spReady.forEach((function(e){e.active=!1}))},s.updateLayer=function(){var e,t,n,i,r,o;T.otherPlayer?(this.otherPlayer.active=!0,this.otherName.setLabelText(null!=(n=T.otherPlayer.displayname)?n:T.otherPlayer.username),this.lbElo[1].string=R(null==(i=T.otherPlayer)?void 0:i.elo),null==(r=this.spCountdown[1])||r.init(null==(o=T.otherPlayer)?void 0:o.elo)):this.otherPlayer.active=!1;this.myName.setLabelText(null!=(e=E.info.displayName)?e:E.info.username),this.lbElo[0].string=R(E.getElo()),null==(t=this.spCountdown[0])||t.init(E.getElo()),this.checkReady()},s.checkReady=function(){var e=this;T.players.forEach((function(t){t.id==E.info.id?e.spReady[0].active=t.isReady:e.spReady[1].active=t.isReady}))},s.onBtnClick=function(){var e=o(a().mark((function e(t,n){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=n,e.next="menu"===e.t0?3:"change"===e.t0?6:"cauhoa"===e.t0?11:"ready"===e.t0?13:"help"===e.t0?16:18;break;case 3:return e.next=5,d.uiMgr.showPopupAsync(f.Menu);case 5:return e.abrupt("break",18);case 6:return T.side=T.side==C.RED?C.BLACK:C.RED,D.instance.resetBoard(),D.instance.startGame(T.side),this.updateInfoPlayerForViewer(),e.abrupt("break",18);case 11:return b.reqAsync(g.actions,{type:w.coTuong,actionID:v.peace}),e.abrupt("break",18);case 13:return this.controller.active=!1,b.reqAsync(g.actions,{type:w.coTuong,actionID:v.readyRoom}),e.abrupt("break",18);case 16:return d.uiMgr.showPopupAsync(m.Help),e.abrupt("break",18);case 18:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),s.goBackHome=function(){b.reqAsync(g.actions,{type:w.coTuong,actionID:v.leaveRoom}),d.uiMgr.goLayerAsync(h.Home)},t}(p)).prototype,"otherPlayer",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Y=t(U.prototype,"otherName",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Z=t(U.prototype,"myName",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),J=t(U.prototype,"controller",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Q=t(U.prototype,"waiting",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),X=t(U.prototype,"spReady",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),$=t(U.prototype,"lbTimes",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),ee=t(U.prototype,"lbElo",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),te=t(U.prototype,"spCountdown",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),ne=t(U.prototype,"time",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),q=U))||q));s._RF.pop()}}}));

System.register("bundle://KKCoTuongBundle/_virtual/KKCountDownCircleWidget.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UIBase.ts"],(function(i){var n,t,e,r,c,o,s,l,u;return{setters:[function(i){n=i.applyDecoratedDescriptor,t=i.inheritsLoose,e=i.initializerDefineProperty,r=i.assertThisInitialized},function(i){c=i.cclegacy,o=i._decorator,s=i.Sprite,l=i.Color},function(i){u=i.UIBase}],execute:function(){var a,h,g,p,f;c._RF.push({},"69b9aRY93BNkZn38jZpHD6m","KKCountDownCircleWidget",void 0);var R=o.ccclass,d=o.property;i("KKCountDownCircleWidget",(a=R("KKCountDownCircleWidget"),h=d(s),a((f=n((p=function(i){function n(){for(var n,t=arguments.length,c=new Array(t),o=0;o<t;o++)c[o]=arguments[o];return n=i.call.apply(i,[this].concat(c))||this,e(n,"circle",f,r(n)),n.currTime=0,n.initTime=0,n.isRunning=!1,n}t(n,i);var c=n.prototype;return c.startFill=function(i,n){void 0===n&&(n=!0),this.node.active=n,n?this.isRunning||(this.currTime=i,this.initTime=i,this.circle.fillRange=1,this.isRunning=!0):this.isRunning=!1},c.update=function(i){this.isRunning&&this.currTime<=10?this.circle.color=l.RED:this.circle.color=l.GREEN,this.currTime>0&&this.isRunning?(this.currTime-=i,this.circle.fillRange=this.currTime/this.initTime):(this.isRunning=!1,this.circle.fillRange=0)},n}(u)).prototype,"circle",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),g=p))||g));c._RF.pop()}}}));

System.register("bundle://KKCoTuongBundle/_virtual/KKEndGamePopup.ts",["./rollupPluginModLoBabelHelpers.js","cc","./PopupBase.ts","./KKAvatarWidget.ts","./GameData.ts","./AudioPath.ts"],(function(e){var t,n,i,o,a,r,l,u,c,s,f,h,p,m;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){a=e.cclegacy,r=e._decorator,l=e.sp,u=e.Label,c=e.Color},function(e){s=e.PopupBase},function(e){f=e.KKAvatarWidget},function(e){h=e.default},function(e){p=e.randomSound,m=e.AudioPath}],execute:function(){var d,g,v,y,b,E,K,D,P,A,w,T,z;a._RF.push({},"31c1cUP4alArZNs2lRhilTf","KKEndGamePopup",void 0);var L=e("EFFECT",function(e){return e.hoa="hoa",e.thang="thang",e.thua="thua",e}({})),N=r.ccclass,B=r.property;e("KKEndGamePopup",(d=N("KKEndGamePopup"),g=B(l.Skeleton),v=B(f),y=B(u),b=B(u),E=B(u),d((P=t((D=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return t=e.call.apply(e,[this].concat(a))||this,i(t,"effect",P,o(t)),i(t,"otherAvatar",A,o(t)),i(t,"myName",w,o(t)),i(t,"otherName",T,o(t)),i(t,"elo",z,o(t)),t.timer=null,t}n(t,e);var a=t.prototype;return a.onLoad=function(){var e,t,n,i=this;void 0!==h.changedElo&&(this.recvData.effect==L.thang?p(m.effect,"win",!0,!1):this.recvData.effect==L.thua?p(m.effect,"lose",!0,!1):p(m.effect,"draw",!0,!1),this.effect.setAnimation(0,this.recvData.effect,!1),this.enableClickBlankToClose(),this.timer=setTimeout((function(){i.close()}),3700),this.myName.string=null!=(e=h.info.displayname)?e:h.info.username,this.otherName.string=null==(t=this.recvData)?void 0:t.name,this.otherAvatar.init(null==(n=this.recvData)?void 0:n.elo),this.elo.string="ELO: "+(h.changedElo>=0?"+"+h.changedElo:h.changedElo),this.elo.color=h.changedElo>0?c.YELLOW:c.WHITE)},a.onDestroy=function(){clearTimeout(this.timer),e.prototype.onDestroy.call(this)},t}(s)).prototype,"effect",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=t(D.prototype,"otherAvatar",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=t(D.prototype,"myName",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=t(D.prototype,"otherName",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=t(D.prototype,"elo",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=D))||K));a._RF.pop()}}}));

System.register("bundle://KKCoTuongBundle/_virtual/KKGameUIConf.ts",["cc","./UIConfig.ts"],(function(e){var o,n;return{setters:[function(e){o=e.cclegacy},function(e){n=e.UICacheMode}],execute:function(){o._RF.push({},"8b633e6LxtCgol19ZuJSjzq","KKGameUIConf",void 0);var a=e("KKBundleConf",{Load:"KKLoadBundle",Common:"KKCommonBundle",CoTuong:"KKCoTuongBundle",Home:"KKHomeBundle",Audios:"Audios",Auth:"KKAuthBundle",Banqi:"KKBanqiBundle",PracticeWithBot:"KKPracticeWithBotBundle",CoThe:"KKCoTheBundle"});e("KKLayerConf",{Load:{bundle:a.Load,name:"KKLoadLayer"},CoTuong:{bundle:a.CoTuong,name:"KKCoTuongLayer",cacheMode:n.Cache},Home:{bundle:a.Home,name:"KKHomeLayer",cacheMode:n.Stay},Auth:{bundle:a.Auth,name:"KKAuthLayer",cacheMode:n.Stay},Banqi:{bundle:a.Banqi,name:"KKBanqiLayer"},PracticeWithBot:{bundle:a.PracticeWithBot,name:"KKPracticeWithBotLayer"},CoThe:{bundle:a.CoThe,name:"KKCoTheLayer",cacheMode:n.Stay}}),e("KKCommonWidgetConf",{Toast:{bundle:a.Common,name:"KKToastWidget",cacheMode:n.Cache},Loading:{bundle:a.Common,name:"KKLoadingWidget",cacheMode:n.Cache},CountDownCircle:{bundle:a.Common,name:"KKCountDownCircleWidget"},StatusPlayer:{bundle:a.Common,name:"KKStatusPlayerWidget"},TagRank:{bundle:a.Common,name:"KKTagRankWidget",cacheMode:n.Cache}}),e("KKCoTuongPanelConf",{CoTuong:{bundle:a.CoTuong,name:"KKCoTuongPanel",cacheMode:n.Cache},BanCo:{bundle:a.CoTuong,name:"KKBanCoPanel",cacheMode:n.Cache}}),e("KKCoTuongPopupConf",{Menu:{bundle:a.CoTuong,name:"KKMenuPopup"},EndGame:{bundle:a.CoTuong,name:"KKEndGamePopup"},CauHoa:{bundle:a.CoTuong,name:"KKCauHoaPopup"}}),e("KKHomePopupConf",{OptionsMatch:{bundle:a.Home,name:"KKOptionsMatchPopup"},Help:{bundle:a.Home,name:"KKHelpPopup"},Profile:{bundle:a.Home,name:"KKProfilePopup"},FogotPass:{bundle:a.Home,name:"KKFogotPassPopup"},InfoAccount:{bundle:a.Home,name:"KKInfoAccountPopup"},SettingPractice:{bundle:a.Home,name:"KKSettingPracticePopup"},Email:{bundle:a.Home,name:"KKEmailPopup",cacheMode:n.Cache},Setting:{bundle:a.Home,name:"KKSettingPopup",cacheMode:n.Cache},TopClass:{bundle:a.Home,name:"KKTopClassPopup",cacheMode:n.Cache},Friends:{bundle:a.Home,name:"KKFriendsPopup",cacheMode:n.Cache},ListMatches:{bundle:a.Home,name:"KKListMatchesPopup",cacheMode:n.Cache},CreateDisplayName:{bundle:a.Home,name:"KKCreateDisplayNamePopup",cacheMode:n.Cache}}),e("KKCommonPopupConf",{LuckyWheel:{bundle:a.Common,name:"KKLuckyWheelPopup"},DialogPopup:{bundle:a.Common,name:"DialogPopup",cacheMode:n.Cache}});o._RF.pop()}}}));

System.register("bundle://KKCoTuongBundle/_virtual/KKMenuPopup.ts",["./rollupPluginModLoBabelHelpers.js","cc","./PopupBase.ts","./kk.ts","./KKGameUIConf.ts","./SocketEvent.ts","./SocketIO.ts","./GameCoTuongData.ts","./GameManager.ts"],(function(e){var t,n,o,a,c,s,i,u,r,p,l,f;return{setters:[function(e){t=e.inheritsLoose},function(e){n=e.cclegacy,o=e._decorator},function(e){a=e.PopupBase},function(e){c=e.default},function(e){s=e.KKLayerConf},function(e){i=e.typeSocket,u=e.SocketEvent,r=e.actionID},function(e){p=e.default},function(e){l=e.default},function(e){f=e.GameManager}],execute:function(){var h;n._RF.push({},"1eb514UINlNr7RQndgpfvOM","KKMenuPopup",void 0);var g=o.ccclass;o.property,e("KKMenuPopup",g("KKMenuPopup")(h=function(e){function n(){return e.apply(this,arguments)||this}t(n,e);var o=n.prototype;return o.onLoad=function(){this.enableClickBlankToClose()},o.start=function(){this.getObj("khung.menu.cau-hoa").active=!l.isViewer,this.getObj("khung.menu.xin-thua").active=!l.isViewer},o.onBtnClick=function(e,t){var n=f.instance.isBanqi?i.coUp:i.coTuong;switch(t){case"dong":this.close();break;case"thoat":p.reqAsync(u.actions,{type:n,actionID:r.leaveRoom}),l.leaveRoom(),c.uiMgr.goLayerAsync(s.Home);break;case"cauhoa":p.reqAsync(u.actions,{type:n,actionID:r.peace}),this.close();break;case"xinthua":p.reqAsync(u.actions,{type:n,actionID:r.surrender}),this.close();break;case"tatieng":case"tatnhac":this.close()}},n}(a))||h);n._RF.pop()}}}));

System.register("bundle://KKCoTuongBundle/_virtual/KKPieceWidget.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UIBase.ts","./AudioPath.ts","./SkinManager.ts","./kk.ts","./MessageEvent.ts"],(function(e){var t,n,i,r,o,s,a,u,c,l,p,d,f,h,g,y,b,v,m,T,O;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,r=e.assertThisInitialized,o=e.asyncToGenerator,s=e.regeneratorRuntime},function(e){a=e.cclegacy,u=e._decorator,c=e.Enum,l=e.Sprite,p=e.Label,d=e.Color,f=e.tween,h=e.Vec3,g=e.UITransform},function(e){y=e.UIBase},function(e){b=e.randomSound,v=e.AudioPath},function(e){m=e.GameType},function(e){T=e.default},function(e){O=e.MessageEventType}],execute:function(){var w,P,C,E,N,S,A,I,K,k,D,R,M;a._RF.push({},"16e85RIKa5Dd7QtgUCAiYFj","KKPieceWidget",void 0);var U=u.ccclass,W=u.property,z=e("PieceType",function(e){return e.TUONG="k",e.SI="a",e.TINH="b",e.XE="r",e.PHAO="c",e.MA="n",e.TOT="p",e.NONE="x",e}({})),B=e("Side",function(e){return e[e.RED=0]="RED",e[e.BLACK=1]="BLACK",e}({}));e("KKPieceWidget",(w=U("KKPieceWidget"),P=W({type:c(z)}),C=W({type:c(B)}),E=W(l),N=W(p),w((I=t((A=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return t=e.call.apply(e,[this].concat(o))||this,i(t,"type",I,r(t)),i(t,"side",K,r(t)),i(t,"sp",k,r(t)),i(t,"row",D,r(t)),i(t,"col",R,r(t)),i(t,"lbCount",M,r(t)),t}n(t,e);var a=t.prototype;return a.init=function(e,t,n,i){this.row=e,this.col=t,this.type=n,this.side=i,this.updateSprite()},a.updateSprite=function(){var e=this.side===B.RED?"red":"black",t=T.skinsMgr.getSkinManager(m.COTUONG);this.type===z.TUONG||this.type!=z.NONE?this.getComponentInChildren(l).spriteFrame=t.getAssetsBySkinId(e,this.type):this.sp.spriteFrame=t.getAssetsBySkinId(e,z.NONE)},a.onMovePiece=function(){var e=o(s().mark((function e(n){var i,r,o,a,u,c=this;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((i=n.node.getComponentInChildren(t))&&(i.node.removeFromParent(),T.eventMgr.emit(O.PUT_TO_POOL,i.node)),r=n.node.getWorldPosition(),o=this.node.parent,a=o.getComponent(g)){e.next=8;break}return console.error("Không tìm thấy UITransform trên parent"),e.abrupt("return");case 8:return u=a.convertToNodeSpaceAR(r),e.next=11,new Promise((function(e){f(c.node).to(.2,{position:u},{easing:"sineOut"}).call((function(){c.node.parent=n.node,c.node.setPosition(h.ZERO),b(v.effect,"piece",!0,!1),c.row=n.pos.row,c.col=n.pos.col,T.eventMgr.emit(O.SHOW_HISTORY),e()})).start()}));case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),a.show=function(e,t,n){void 0!==t&&(this.side=t),!isNaN(null==n?void 0:n.count)&&(null==n?void 0:n.count)>1?(this.lbCount.string=null==n?void 0:n.count.toString(),this.lbCount.node.parent.active=!0):this.lbCount.node.parent.active=!1,(null==n?void 0:n.type)==z.NONE&&null!=n&&n.realType?this.sp.color=new d("ADADAD"):this.sp.color=d.WHITE,this.type=e,this.updateSprite()},a.active=function(){this.sp.color=d.YELLOW},a.unActive=function(){this.sp.color=d.WHITE},t}(y)).prototype,"type",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return z.TUONG}}),K=t(A.prototype,"side",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return B.RED}}),k=t(A.prototype,"sp",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D=t(A.prototype,"row",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),R=t(A.prototype,"col",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),M=t(A.prototype,"lbCount",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=A))||S));a._RF.pop()}}}));

System.register("bundle://KKCoTuongBundle/_virtual/KKTileCoTuongWidget.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UIBase.ts","./KKPieceWidget.ts","./kk.ts","./MessageEvent.ts","./GameCoTuongData.ts"],(function(t){var e,i,n,o,r,a,c,u,l,s,f,p,g,h;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,n=t.initializerDefineProperty,o=t.assertThisInitialized,r=t.createClass},function(t){a=t.cclegacy,c=t._decorator,u=t.CCInteger,l=t.Node},function(t){s=t.UIBase},function(t){f=t.KKPieceWidget},function(t){p=t.default},function(t){g=t.MessageEventType},function(t){h=t.default}],execute:function(){var v,d,y,b,T,m,w,C,K,I,E,k,_,M,z;a._RF.push({},"2893eH5wkpIK4mi8YTsHRA2","KKTileCoTuongWidget",void 0);var H=c.ccclass,D=c.property;c.type,t("KKTileCoTuongWidget",(v=H("KKTileCoTuongWidget"),d=D(u),y=D(u),b=D({type:l}),T=D({type:l}),m=D({type:l}),w=D({type:l}),v((I=e((K=function(t){function e(){for(var e,i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,n(e,"row",I,o(e)),n(e,"col",E,o(e)),n(e,"position",k,o(e)),n(e,"attack",_,o(e)),n(e,"from",M,o(e)),n(e,"to",z,o(e)),e}i(e,t);var a=e.prototype;return a.onLoad=function(){p.eventMgr.on(g.HIDE_TILE,this.hide,this),p.eventMgr.on(g.HIDE_TILE_HISTORY,this.hideHistory,this)},a.onDestroy=function(){p.eventMgr.offTargetAll(this)},a.init=function(t,e){this.row=t,this.col=e},a.activeAttack=function(){this.attack.active=!0},a.active=function(){this.position.active=!0},a.showFrom=function(){this.from.active=!0},a.showTo=function(){this.to.active=!0},a.hide=function(){this.position.active=!1,this.attack.active=!1},a.hideHistory=function(){this.from.active=!1,this.to.active=!1},a.onBtnClick=function(t,e){if(!h.isViewer)switch(e){case"move":var i=this.node.getComponentInChildren(f);p.eventMgr.emit(g.ON_SELECT_TILE,i),p.eventMgr.emit(g.ON_MOVE_PIECE,this)}},r(e,[{key:"pos",get:function(){return{row:this.row,col:this.col}}},{key:"piece",get:function(){return this.node.getComponentInChildren(f)}}]),e}(s)).prototype,"row",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),E=e(K.prototype,"col",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),k=e(K.prototype,"position",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=e(K.prototype,"attack",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=e(K.prototype,"from",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=e(K.prototype,"to",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=K))||C));a._RF.pop()}}}));

System.register("bundle://KKCoTuongBundle/_virtual/KKUtils.ts",["cc","./KKGameUIConf.ts","./kk.ts"],(function(o){var n,t,e,i,u;return{setters:[function(o){n=o.cclegacy,t=o.v3},function(o){e=o.KKCommonPopupConf,i=o.KKCommonWidgetConf},function(o){u=o.default}],execute:function(){n._RF.push({},"5eecdz1G6BN8ryn48pHUkhk","KKUtils",void 0),o("default",function(){function o(){}return o.showCommonPopup=function(o){return u.uiMgr.showPopupAsync(e.DialogPopup,o)},o.showToast=function(o){u.uiMgr.createWidgetAsync(i.Toast,{msg:o}).then((function(o){u.godNode.children.forEach((function(o,n){o.name==i.Toast.name&&(o.position=t(o.position.x,o.position.y+110,o.position.z))})),o.parent=u.godNode}))},o.showLoading=function(o){var n=this;this._loadingCounter++;var t,e=this._loadingCounter;o?u.uiMgr.createWidgetAsync(i.Loading).then((function(o){n._loadingCounter===e?o.parent=u.godNode:o.destroy()})):null==(t=u.godNode.getChildByName(i.Loading.name))||t.destroy()},o}())._loadingCounter=0,n._RF.pop()}}}));

System.register("bundle://KKCoTuongBundle/_virtual/LabelEllipsis.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,i,l,a,n,r,s,o,c;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,l=e.initializerDefineProperty,a=e.assertThisInitialized},function(e){n=e.cclegacy,r=e._decorator,s=e.Label,o=e.UITransform,c=e.Component}],execute:function(){var u,p,b,h,f,g;n._RF.push({},"9fc93nMQPRG3LFdvyqQ2w2D","LabelEllipsis",void 0);var d=r.ccclass,L=r.property;e("EllipsisLabel",(u=d("EllipsisLabel"),p=L(s),u((f=t((h=function(e){function t(){for(var t,i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return t=e.call.apply(e,[this].concat(n))||this,l(t,"label",f,a(t)),l(t,"maxCharacters",g,a(t)),t}i(t,e);var n=t.prototype;return n.onLoad=function(){this.label||(this.label=this.getComponent(s)),this.label&&this.updateLabelWithEllipsis()},n.updateLabelWithEllipsis=function(){if(this.label){var e=this.label.string;this.label.node.getComponent(o).contentSize.width;e.length>this.maxCharacters?this.label.string=e.substring(0,this.maxCharacters-3)+"...":this.label.string=e}},n.setLabelText=function(e){this.label.string=e,this.updateLabelWithEllipsis()},t}(c)).prototype,"label",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),g=t(h.prototype,"maxCharacters",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 20}}),b=h))||b));n._RF.pop()}}}));

System.register("bundle://KKCoTuongBundle/_virtual/LayerBase.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UIBase.ts"],(function(e){var t,r,n,s;return{setters:[function(e){t=e.inheritsLoose},function(e){r=e.cclegacy,n=e._decorator},function(e){s=e.UIBase}],execute:function(){var o;r._RF.push({},"a7388/HzEVFtq5K31XcR06N","LayerBase",void 0);var a=n.ccclass;e("LayerBase",a("LayerBase")(o=function(e){function r(){return e.apply(this,arguments)||this}return t(r,e),r.prototype.refresh=function(){},r}(s))||o);r._RF.pop()}}}));

System.register("bundle://KKCoTuongBundle/_virtual/LocalizationManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./kk.ts"],(function(e){var t,n,a,r,i,o;return{setters:[function(e){t=e.asyncToGenerator,n=e.regeneratorRuntime},function(e){a=e.cclegacy,r=e.resources,i=e.JsonAsset},function(e){o=e.default}],execute:function(){a._RF.push({},"a907ctOFLBHW4DfGMwIbFWq","LocalizationManager",void 0);e("LocalizationManager",function(){function e(){this.currentLang="vi",this.langData={},this.labels=[]}var a=e.prototype;return a.loadLanguage=function(){var e=t(n().mark((function e(t){var a;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=t.toLowerCase(),o.localMgr.setItem("selectedLang",""+t),e.prev=2,e.next=5,new Promise((function(e,n){r.load("lang/"+t,i,(function(t,a){t?n(t):e(a)}))}));case 5:a=e.sent,this.currentLang=t,this.langData=a.json,this.updateAllLabels(),o.eventMgr.emit("language-changed"),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),console.error("Failed to load language file:",e.t0);case 15:case"end":return e.stop()}}),e,this,[[2,12]])})));return function(t){return e.apply(this,arguments)}}(),a.registerLabel=function(e){this.labels.push(e)},a.unregisterLabel=function(e){this.labels=this.labels.filter((function(t){return t!==e}))},a.updateAllLabels=function(){this.labels.forEach((function(e){return e.updateText()}))},a.getText=function(e,t){var n=this.langData[e]||e;return t&&t.forEach((function(e,t){n=n.replace("{"+t+"}",e.toString())})),n},a.detectLanguage=function(){var e=o.localMgr.getItemWithDefault("selectedLang","vi"),t=navigator.language.split("-")[0];return e||t||"vi"},e}());a._RF.pop()}}}));

System.register("bundle://KKCoTuongBundle/_virtual/LocalManager.ts",["cc","./Xor.ts"],(function(t){var e,r,n;return{setters:[function(t){e=t.cclegacy,r=t.sys},function(t){n=t.default}],execute:function(){e._RF.push({},"554fbebH89LW4XG8/1aIDS9","LocalManager",void 0);var a="any string";t("default",function(){function t(){}var e=t.prototype;return e.safeParse=function(t){try{return JSON.parse(t)}catch(t){return null}},e.getItem=function(t,e){void 0===e&&(e=!1);var o=r.localStorage.getItem(t);return null==o?null:(e&&(o=n.xor(o,a)),this.safeParse(o))},e.getItemWithDefault=function(t,e,o){void 0===o&&(o=!1);var u=r.localStorage.getItem(t);if(null==u)return this.setItem(t,e,o),e;o&&(u=n.xor(u,a));var l=this.safeParse(u);return null===l?(this.setItem(t,e,o),e):l},e.setItem=function(t,e,o){void 0===o&&(o=!1);var u=JSON.stringify(e);o&&(u=n.xor(u,a)),r.localStorage.setItem(t,u)},e.removeItem=function(t){r.localStorage.removeItem(t)},t}());e._RF.pop()}}}));

System.register("bundle://KKCoTuongBundle/_virtual/MathHelper.ts",["cc"],(function(n){var t,r,o;return{setters:[function(n){t=n.cclegacy,r=n.Vec2,o=n.v2}],execute:function(){t._RF.push({},"6c10eYQDrhM3LFSyZ0f5WEs","MathHelper",void 0);n("default",function(){function n(){}return n.randomInt0=function(n){return Math.floor(Math.random()*n)},n.randomInt1=function(n){return Math.ceil(Math.random()*n)},n.randomInt2=function(n,t){return n=Math.ceil(n),t=Math.floor(t),Math.floor(Math.random()*(t-n+1))+n},n.randomFloat=function(n){return Math.random()*n},n.randomFloat2=function(n,t){return Math.random()*(t-n)+n},n.randomArray=function(n){return n[Math.floor(Math.random()*n.length)]},n.randomV2=function(n,t,a){return void 0===a&&(a=r.ZERO),o(n*(Math.random()-.5),t*(Math.random()-.5)).add(a)},n.toFixed=function(n,t,r){if(void 0===t&&(t=2),void 0===r&&(r=!1),t<0)return n;if(r)return n.toFixed(t);for(var o=1,a=0;a<t;++a)o*=10;return(Math.floor(n*o)/o).toFixed(t)},n.limit=function(n,t,r){return Math.min(r,Math.max(t,n))},n}());t._RF.pop()}}}));

System.register("bundle://KKCoTuongBundle/_virtual/MessageEvent.ts",["cc"],(function(e){var E;return{setters:[function(e){E=e.cclegacy}],execute:function(){E._RF.push({},"31ffejupNdDAIwR1Tj5rG7C","MessageEvent",void 0);e("MessageEventType",function(e){return e.HIDE_TILE="HIDE_TILE",e.HIDE_TILE_HISTORY="HIDE_TILE_HISTORY",e.ON_SELECT_TILE="ON_SELECT_TILE",e.ON_MOVE_PIECE="ON_MOVE_PIECE",e.PUT_TO_POOL="PUT_TO_POOL",e.SHOW_HISTORY="SHOW_HISTORY",e}({}));E._RF.pop()}}}));

System.register("bundle://KKCoTuongBundle/_virtual/PopupBase.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UIBase.ts","./kk.ts"],(function(t){var n,e,o,i,s,a,c,r,l,u,p;return{setters:[function(t){n=t.inheritsLoose},function(t){e=t.cclegacy,o=t._decorator,i=t.Widget,s=t.tween,a=t.v3,c=t.UIOpacity,r=t.Node,l=t.UITransform},function(t){u=t.UIBase},function(t){p=t.default}],execute:function(){var h;e._RF.push({},"82c96ZMl6RGy6W5Cg3SRgHF","PopupBase",void 0);var d=o.ccclass;t("PopupBase",d("PopupBase")(h=function(t){function e(){for(var n,e=arguments.length,o=new Array(e),i=0;i<e;i++)o[i]=arguments[i];return(n=t.call.apply(t,[this].concat(o))||this).ret=void 0,n.onDestroyCall=function(){},n}n(e,t);var o=e.prototype;return o.onDestroy=function(){p.uiMgr._autoRemovePopup(this.node.parent),this.onDestroyCall(this.ret),t.prototype.onDestroy.call(this)},o.close=function(){this.closeAnim()},o.showAnim=function(){this.node.getComponent(i).updateAlignment(),this.node.setScale(0,0,1),s(this.node).to(.2,{scale:a(1,1,1)},{easing:"backOut"}).start()},o.closeAnim=function(){var t=this;s(this.node).to(.2,{scale:a(0,0,1)},{easing:"backIn"}).call((function(){t.node.destroy()})).start()},o.setDarkBgOpacity=function(t){this.node.parent.getChildByName("dark").getComponent(c).opacity=t},o.enableClickBlankToClose=function(t){var n=this;(!t||0==t.length)&&this.node.children.length>0&&(t=[this.node.children[0]]),this.node.on(r.EventType.TOUCH_END,(function(e){var o=e.getUIStartLocation(),i=e.getUILocation().subtract(o);if(Math.abs(i.x)<15&&Math.abs(i.y)<15){for(var s=!0,a=0;a<t.length;++a)if(t[a].getComponent(l).getBoundingBoxToWorld().contains(o)){s=!1;break}s&&n.close()}}),this)},e}(u))||h);e._RF.pop()}}}));

System.register("bundle://KKCoTuongBundle/_virtual/rollupPluginModLoBabelHelpers.js",[],(function(t){return{execute:function(){function e(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function r(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,c(n.key),n)}}function n(){return(n=t("extends",Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t})).apply(this,arguments)}function o(e,r){return(o=t("setPrototypeOf",Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t}))(e,r)}function i(t,e){if(t){if("string"==typeof t)return a(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(t,e):void 0}}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function u(t,e){if("object"!=typeof t||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function c(t){var e=u(t,"string");return"symbol"==typeof e?e:String(e)}t({applyDecoratedDescriptor:function(t,e,r,n,o){var i={};Object.keys(n).forEach((function(t){i[t]=n[t]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0);i=r.slice().reverse().reduce((function(r,n){return n(t,e,r)||r}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0);void 0===i.initializer&&(Object.defineProperty(t,e,i),i=null);return i},arrayLikeToArray:a,assertThisInitialized:function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t},asyncToGenerator:function(t){return function(){var r=this,n=arguments;return new Promise((function(o,i){var a=t.apply(r,n);function u(t){e(a,o,i,u,c,"next",t)}function c(t){e(a,o,i,u,c,"throw",t)}u(void 0)}))}},createClass:function(t,e,n){e&&r(t.prototype,e);n&&r(t,n);return Object.defineProperty(t,"prototype",{writable:!1}),t},createForOfIteratorHelperLoose:function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=i(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},extends:n,inheritsLoose:function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,o(t,e)},initializerDefineProperty:function(t,e,r,n){if(!r)return;Object.defineProperty(t,e,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(n):void 0})},regeneratorRuntime:function(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */
t("regeneratorRuntime",(function(){return r}));var e,r={},n=Object.prototype,o=n.hasOwnProperty,i=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},u=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(e){f=function(t,e,r){return t[e]=r}}function s(t,e,r,n){var o=e&&e.prototype instanceof g?e:g,a=Object.create(o.prototype),u=new k(n||[]);return i(a,"_invoke",{value:P(t,r,u)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}r.wrap=s;var p="suspendedStart",y="executing",v="completed",d={};function g(){}function b(){}function m(){}var w={};f(w,u,(function(){return this}));var O=Object.getPrototypeOf,L=O&&O(O(z([])));L&&L!==n&&o.call(L,u)&&(w=L);var j=m.prototype=g.prototype=Object.create(w);function x(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(n,i,a,u){var c=h(t[n],t,i);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==typeof f&&o.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(f).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var n;i(this,"_invoke",{value:function(t,o){function i(){return new e((function(e,n){r(t,o,e,n)}))}return n=n?n.then(i,i):i()}})}function P(t,r,n){var o=p;return function(i,a){if(o===y)throw new Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=_(u,n);if(c){if(c===d)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var l=h(t,r,n);if("normal"===l.type){if(o=n.done?v:"suspendedYield",l.arg===d)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(o=v,n.method="throw",n.arg=l.arg)}}}function _(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,_(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=h(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,d;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,d):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,d)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function k(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function z(t){if(t||""===t){var r=t[u];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function r(){for(;++n<t.length;)if(o.call(t,n))return r.value=t[n],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(typeof t+" is not iterable")}return b.prototype=m,i(j,"constructor",{value:m,configurable:!0}),i(m,"constructor",{value:b,configurable:!0}),b.displayName=f(m,l,"GeneratorFunction"),r.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,m):(t.__proto__=m,f(t,l,"GeneratorFunction")),t.prototype=Object.create(j),t},r.awrap=function(t){return{__await:t}},x(E.prototype),f(E.prototype,c,(function(){return this})),r.AsyncIterator=E,r.async=function(t,e,n,o,i){void 0===i&&(i=Promise);var a=new E(s(t,e,n,o),i);return r.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},x(j),f(j,l,"Generator"),f(j,u,(function(){return this})),f(j,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},r.values=z,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(T),!t)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(n,o){return u.type="throw",u.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var c=o.call(a,"catchLoc"),l=o.call(a,"finallyLoc");if(c&&l){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),T(r),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;T(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:z(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),d}},r},setPrototypeOf:o,toPrimitive:u,toPropertyKey:c,unsupportedIterableToArray:i})}}}));

System.register("bundle://KKCoTuongBundle/_virtual/SkinManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./KKGameUIConf.ts"],(function(n){var t,e,i,s,r,o,u,a;return{setters:[function(n){t=n.asyncToGenerator,e=n.regeneratorRuntime,i=n.createForOfIteratorHelperLoose},function(n){s=n.cclegacy,r=n.log,o=n.SpriteFrame,u=n.assetManager},function(n){a=n.KKBundleConf}],execute:function(){s._RF.push({},"49c1c4Pxb9HfYkiUN1W1zQ4","SkinManager",void 0);var c=n("GameType",function(n){return n[n.COTUONG=0]="COTUONG",n}({})),k=(n("SkinGameManager",function(){function n(){this.skins=new Map;var n=new k("1002",a.CoTuong,["1000","1001","1002"],c.COTUONG);this.skins.set(c.COTUONG,n)}var t=n.prototype;return t.getSkinManager=function(n){return this.skins.get(n)},t.setCurrentSkin=function(n,t,e){void 0===e&&(e=!1);var i=this.getSkinManager(n);i?e?i.resetToDefaultSkin():i.setCurrentSkin(t):console.warn("Không tìm thấy SkinManager cho gameType "+n)},n}()),function(){function n(n,t,e,i){this.currentSkin=void 0,this.defaultSkin=void 0,this.skinIds=void 0,this.bundle=void 0,this.skins=new Map,this.type=void 0,this.defaultSkin=n,this.bundle=t,this.skinIds=e,this.currentSkin=n,this.type=i}var s=n.prototype;return s.loadDirAssets=function(n,t,e){return new Promise((function(i,s){n.loadDir(t,e,(function(n,t,e){}),(function(n,t){n?s(n):i(t)}))}))},s.loadAllSkinAssets=function(){var n=t(e().mark((function n(){var t,s,a,k,h,l,f,d,g;return e().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t=u.getBundle(this.bundle)){n.next=4;break}return console.error("Không tìm thấy bundle '"+this.bundle+"'!"),n.abrupt("return");case 4:if(this.type!=c.COTUONG){n.next=29;break}s=i(this.skinIds);case 6:if((a=s()).done){n.next=29;break}return k=a.value,h="Textures/skins/"+k+"/red",l="Textures/skins/"+k+"/black",n.prev=10,n.next=13,this.loadDirAssets(t,h,o);case 13:return f=n.sent,n.next=16,this.loadDirAssets(t,l,o);case 16:if(d=n.sent,8===f.length&&8===d.length){n.next=19;break}throw new Error("Skin "+k+" không đủ 8 sprite cho mỗi màu");case 19:g={red:f,black:d,other:[]},this.skins.set(k,g),r("Đã load skin "+c[this.type]+" '"+k+"' thành công."),n.next=27;break;case 24:n.prev=24,n.t0=n.catch(10),console.error("Lỗi khi load skin assets cho skinId "+k+":",n.t0);case 27:n.next=6;break;case 29:case"end":return n.stop()}}),n,this,[[10,24]])})));return function(){return n.apply(this,arguments)}}(),s.getCurrentSkin=function(){return this.skins.get(this.currentSkin)},s.getAssetsBySkinId=function(n,t){return this.getCurrentSkin()[n].find((function(n){return n.name===t}))},s.setCurrentSkin=function(n){this.skins.has(n)?(this.currentSkin=n,r("Đã chuyển skin hiện tại sang: "+n)):console.warn("Skin '"+n+"' không tồn tại!")},s.resetToDefaultSkin=function(){this.currentSkin=this.defaultSkin,r("Reset skin về mặc định: "+this.defaultSkin)},s.getListSkin=function(){console.log(this.skins)},n}());s._RF.pop()}}}));

System.register("bundle://KKCoTuongBundle/_virtual/socket.io.js",["./cjs-loader.mjs"],(function(t,e){var n;return{setters:[function(t){n=t.default}],execute:function(){t("default",void 0);var r=t("__cjsMetaURL",e.meta.url);n.define(r,(function(e,n,r,i,o){
/*!
         * Socket.IO v4.8.1
         * (c) 2014-2024 Guillermo Rauch
         * Released under the MIT License.
         */
var s,a;s=this,a=function(){function t(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function e(t,e,n){if(c())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,e);var i=new(t.bind.apply(t,r));return n&&u(i,n.prototype),i}function n(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,f(r.key),r)}}function r(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function i(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=l(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){a=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function o(){return(o=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(null,arguments)}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function a(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,u(t,e)}function c(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(c=function(){return!!t})()}function u(t,e){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function h(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(e)||l(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}function p(t){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(e,n){if(e){if("string"==typeof e)return t(e,n);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(e,n):void 0}}function d(t){var n="function"==typeof Map?new Map:void 0;return(d=function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(e){return"function"==typeof t}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(t))return n.get(t);n.set(t,r)}function r(){return e(t,arguments,s(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),u(r,t)})(t)}var y=Object.create(null);y.open="0",y.close="1",y.ping="2",y.pong="3",y.message="4",y.upgrade="5",y.noop="6";var v=Object.create(null);Object.keys(y).forEach((function(t){v[y[t]]=t}));var g,m={type:"error",data:"parser error"},b="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),_="function"==typeof ArrayBuffer,w=function(t){return"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer instanceof ArrayBuffer},C=function(t,e,n){var r=t.type,i=t.data;return b&&i instanceof Blob?e?n(i):k(i,n):_&&(i instanceof ArrayBuffer||w(i))?e?n(i):k(new Blob([i]),n):n(y[r]+(i||""))},k=function(t,e){var n=new FileReader;return n.onload=function(){var t=n.result.split(",")[1];e("b"+(t||""))},n.readAsDataURL(t)};function A(t){return t instanceof Uint8Array?t:t instanceof ArrayBuffer?new Uint8Array(t):new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}for(var E="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",O="undefined"==typeof Uint8Array?[]:new Uint8Array(256),T=0;T<E.length;T++)O[E.charCodeAt(T)]=T;var R,S="function"==typeof ArrayBuffer,F=function(t,e){if("string"!=typeof t)return{type:"message",data:B(t,e)};var n=t.charAt(0);return"b"===n?{type:"message",data:x(t.substring(1),e)}:v[n]?t.length>1?{type:v[n],data:t.substring(1)}:{type:v[n]}:m},x=function(t,e){if(S){var n=function(t){var e,n,r,i,o,s=.75*t.length,a=t.length,c=0;"="===t[t.length-1]&&(s--,"="===t[t.length-2]&&s--);var u=new ArrayBuffer(s),h=new Uint8Array(u);for(e=0;e<a;e+=4)n=O[t.charCodeAt(e)],r=O[t.charCodeAt(e+1)],i=O[t.charCodeAt(e+2)],o=O[t.charCodeAt(e+3)],h[c++]=n<<2|r>>4,h[c++]=(15&r)<<4|i>>2,h[c++]=(3&i)<<6|63&o;return u}(t);return B(n,e)}return{base64:!0,data:t}},B=function(t,e){switch(e){case"blob":return t instanceof Blob?t:new Blob([t]);case"arraybuffer":default:return t instanceof ArrayBuffer?t:t.buffer}},N=String.fromCharCode(30);function L(){return new TransformStream({transform:function(t,e){!function(t,e){b&&t.data instanceof Blob?t.data.arrayBuffer().then(A).then(e):_&&(t.data instanceof ArrayBuffer||w(t.data))?e(A(t.data)):C(t,!1,(function(t){g||(g=new TextEncoder),e(g.encode(t))}))}(t,(function(n){var r,i=n.length;if(i<126)r=new Uint8Array(1),new DataView(r.buffer).setUint8(0,i);else if(i<65536){r=new Uint8Array(3);var o=new DataView(r.buffer);o.setUint8(0,126),o.setUint16(1,i)}else{r=new Uint8Array(9);var s=new DataView(r.buffer);s.setUint8(0,127),s.setBigUint64(1,BigInt(i))}t.data&&"string"!=typeof t.data&&(r[0]|=128),e.enqueue(r),e.enqueue(n)}))}})}function j(t){return t.reduce((function(t,e){return t+e.length}),0)}function P(t,e){if(t[0].length===e)return t.shift();for(var n=new Uint8Array(e),r=0,i=0;i<e;i++)n[i]=t[0][r++],r===t[0].length&&(t.shift(),r=0);return t.length&&r<t[0].length&&(t[0]=t[0].slice(r)),n}function q(t){if(t)return function(t){for(var e in q.prototype)t[e]=q.prototype[e];return t}(t)}q.prototype.on=q.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},q.prototype.once=function(t,e){function n(){this.off(t,n),e.apply(this,arguments)}return n.fn=e,this.on(t,n),this},q.prototype.off=q.prototype.removeListener=q.prototype.removeAllListeners=q.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+t];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var i=0;i<r.length;i++)if((n=r[i])===e||n.fn===e){r.splice(i,1);break}return 0===r.length&&delete this._callbacks["$"+t],this},q.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),n=this._callbacks["$"+t],r=1;r<arguments.length;r++)e[r-1]=arguments[r];if(n){r=0;for(var i=(n=n.slice(0)).length;r<i;++r)n[r].apply(this,e)}return this},q.prototype.emitReserved=q.prototype.emit,q.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},q.prototype.hasListeners=function(t){return!!this.listeners(t).length};var I="function"==typeof Promise&&"function"==typeof Promise.resolve?function(t){return Promise.resolve().then(t)}:function(t,e){return e(t,0)},U="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")();function D(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return n.reduce((function(e,n){return t.hasOwnProperty(n)&&(e[n]=t[n]),e}),{})}var M=U.setTimeout,V=U.clearTimeout;function H(t,e){e.useNativeTimers?(t.setTimeoutFn=M.bind(U),t.clearTimeoutFn=V.bind(U)):(t.setTimeoutFn=U.setTimeout.bind(U),t.clearTimeoutFn=U.clearTimeout.bind(U))}function K(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}var z=function(t){function e(e,n,r){var i;return(i=t.call(this,e)||this).description=n,i.context=r,i.type="TransportError",i}return a(e,t),e}(d(Error)),W=function(t){function e(e){var n;return(n=t.call(this)||this).writable=!1,H(n,e),n.opts=e,n.query=e.query,n.socket=e.socket,n.supportsBinary=!e.forceBase64,n}a(e,t);var n=e.prototype;return n.onError=function(e,n,r){return t.prototype.emitReserved.call(this,"error",new z(e,n,r)),this},n.open=function(){return this.readyState="opening",this.doOpen(),this},n.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},n.send=function(t){"open"===this.readyState&&this.write(t)},n.onOpen=function(){this.readyState="open",this.writable=!0,t.prototype.emitReserved.call(this,"open")},n.onData=function(t){var e=F(t,this.socket.binaryType);this.onPacket(e)},n.onPacket=function(e){t.prototype.emitReserved.call(this,"packet",e)},n.onClose=function(e){this.readyState="closed",t.prototype.emitReserved.call(this,"close",e)},n.pause=function(t){},n.createUri=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t+"://"+this._hostname()+this._port()+this.opts.path+this._query(e)},n._hostname=function(){var t=this.opts.hostname;return-1===t.indexOf(":")?t:"["+t+"]"},n._port=function(){return this.opts.port&&(this.opts.secure&&Number(443!==this.opts.port)||!this.opts.secure&&80!==Number(this.opts.port))?":"+this.opts.port:""},n._query=function(t){var e=function(t){var e="";for(var n in t)t.hasOwnProperty(n)&&(e.length&&(e+="&"),e+=encodeURIComponent(n)+"="+encodeURIComponent(t[n]));return e}(t);return e.length?"?"+e:""},e}(q),Y=function(t){function e(){var e;return(e=t.apply(this,arguments)||this)._polling=!1,e}a(e,t);var n=e.prototype;return n.doOpen=function(){this._poll()},n.pause=function(t){var e=this;this.readyState="pausing";var n=function(){e.readyState="paused",t()};if(this._polling||!this.writable){var r=0;this._polling&&(r++,this.once("pollComplete",(function(){--r||n()}))),this.writable||(r++,this.once("drain",(function(){--r||n()})))}else n()},n._poll=function(){this._polling=!0,this.doPoll(),this.emitReserved("poll")},n.onData=function(t){var e=this;(function(t,e){for(var n=t.split(N),r=[],i=0;i<n.length;i++){var o=F(n[i],e);if(r.push(o),"error"===o.type)break}return r})(t,this.socket.binaryType).forEach((function(t){if("opening"===e.readyState&&"open"===t.type&&e.onOpen(),"close"===t.type)return e.onClose({description:"transport closed by the server"}),!1;e.onPacket(t)})),"closed"!==this.readyState&&(this._polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState&&this._poll())},n.doClose=function(){var t=this,e=function(){t.write([{type:"close"}])};"open"===this.readyState?e():this.once("open",e)},n.write=function(t){var e=this;this.writable=!1,function(t,e){var n=t.length,r=new Array(n),i=0;t.forEach((function(t,o){C(t,!1,(function(t){r[o]=t,++i===n&&e(r.join(N))}))}))}(t,(function(t){e.doWrite(t,(function(){e.writable=!0,e.emitReserved("drain")}))}))},n.uri=function(){var t=this.opts.secure?"https":"http",e=this.query||{};return!1!==this.opts.timestampRequests&&(e[this.opts.timestampParam]=K()),this.supportsBinary||e.sid||(e.b64=1),this.createUri(t,e)},r(e,[{key:"name",get:function(){return"polling"}}])}(W),$=!1;try{$="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(t){}var J=$;function Q(){}var X=function(t){function e(e){var n;if(n=t.call(this,e)||this,"undefined"!=typeof location){var r="https:"===location.protocol,i=location.port;i||(i=r?"443":"80"),n.xd="undefined"!=typeof location&&e.hostname!==location.hostname||i!==e.port}return n}a(e,t);var n=e.prototype;return n.doWrite=function(t,e){var n=this,r=this.request({method:"POST",data:t});r.on("success",e),r.on("error",(function(t,e){n.onError("xhr post error",t,e)}))},n.doPoll=function(){var t=this,e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(function(e,n){t.onError("xhr poll error",e,n)})),this.pollXhr=e},e}(Y),G=function(t){function e(e,n,r){var i;return(i=t.call(this)||this).createRequest=e,H(i,r),i._opts=r,i._method=r.method||"GET",i._uri=n,i._data=void 0!==r.data?r.data:null,i._create(),i}a(e,t);var n=e.prototype;return n._create=function(){var t,n=this,r=D(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");r.xdomain=!!this._opts.xd;var i=this._xhr=this.createRequest(r);try{i.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders)for(var o in i.setDisableHeaderCheck&&i.setDisableHeaderCheck(!0),this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(o)&&i.setRequestHeader(o,this._opts.extraHeaders[o])}catch(t){}if("POST"===this._method)try{i.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(t){}try{i.setRequestHeader("Accept","*/*")}catch(t){}null===(t=this._opts.cookieJar)||void 0===t||t.addCookies(i),"withCredentials"in i&&(i.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(i.timeout=this._opts.requestTimeout),i.onreadystatechange=function(){var t;3===i.readyState&&(null===(t=n._opts.cookieJar)||void 0===t||t.parseCookies(i.getResponseHeader("set-cookie"))),4===i.readyState&&(200===i.status||1223===i.status?n._onLoad():n.setTimeoutFn((function(){n._onError("number"==typeof i.status?i.status:0)}),0))},i.send(this._data)}catch(t){return void this.setTimeoutFn((function(){n._onError(t)}),0)}"undefined"!=typeof document&&(this._index=e.requestsCount++,e.requests[this._index]=this)},n._onError=function(t){this.emitReserved("error",t,this._xhr),this._cleanup(!0)},n._cleanup=function(t){if(void 0!==this._xhr&&null!==this._xhr){if(this._xhr.onreadystatechange=Q,t)try{this._xhr.abort()}catch(t){}"undefined"!=typeof document&&delete e.requests[this._index],this._xhr=null}},n._onLoad=function(){var t=this._xhr.responseText;null!==t&&(this.emitReserved("data",t),this.emitReserved("success"),this._cleanup())},n.abort=function(){this._cleanup()},e}(q);function Z(){for(var t in G.requests)G.requests.hasOwnProperty(t)&&G.requests[t].abort()}G.requestsCount=0,G.requests={},"undefined"!=typeof document&&("function"==typeof attachEvent?attachEvent("onunload",Z):"function"==typeof addEventListener&&addEventListener("onpagehide"in U?"pagehide":"unload",Z,!1));var tt,et=(tt=rt({xdomain:!1}))&&null!==tt.responseType,nt=function(t){function e(e){var n;n=t.call(this,e)||this;var r=e&&e.forceBase64;return n.supportsBinary=et&&!r,n}return a(e,t),e.prototype.request=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o(t,{xd:this.xd},this.opts),new G(rt,this.uri(),t)},e}(X);function rt(t){var e=t.xdomain;try{if("undefined"!=typeof XMLHttpRequest&&(!e||J))return new XMLHttpRequest}catch(t){}if(!e)try{return new(U[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(t){}}var it="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),ot=function(t){function e(){return t.apply(this,arguments)||this}a(e,t);var n=e.prototype;return n.doOpen=function(){var t=this.uri(),e=this.opts.protocols,n=it?{}:D(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(t,e,n)}catch(t){return this.emitReserved("error",t)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()},n.addEventListeners=function(){var t=this;this.ws.onopen=function(){t.opts.autoUnref&&t.ws._socket.unref(),t.onOpen()},this.ws.onclose=function(e){return t.onClose({description:"websocket connection closed",context:e})},this.ws.onmessage=function(e){return t.onData(e.data)},this.ws.onerror=function(e){return t.onError("websocket error",e)}},n.write=function(t){var e=this;this.writable=!1;for(var n=function(){var n=t[r],i=r===t.length-1;C(n,e.supportsBinary,(function(t){try{e.doWrite(n,t)}catch(t){}i&&I((function(){e.writable=!0,e.emitReserved("drain")}),e.setTimeoutFn)}))},r=0;r<t.length;r++)n()},n.doClose=function(){void 0!==this.ws&&(this.ws.onerror=function(){},this.ws.close(),this.ws=null)},n.uri=function(){var t=this.opts.secure?"wss":"ws",e=this.query||{};return this.opts.timestampRequests&&(e[this.opts.timestampParam]=K()),this.supportsBinary||(e.b64=1),this.createUri(t,e)},r(e,[{key:"name",get:function(){return"websocket"}}])}(W),st=U.WebSocket||U.MozWebSocket,at={websocket:function(t){function e(){return t.apply(this,arguments)||this}a(e,t);var n=e.prototype;return n.createSocket=function(t,e,n){return it?new st(t,e,n):e?new st(t,e):new st(t)},n.doWrite=function(t,e){this.ws.send(e)},e}(ot),webtransport:function(t){function e(){return t.apply(this,arguments)||this}a(e,t);var n=e.prototype;return n.doOpen=function(){var t=this;try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(t){return this.emitReserved("error",t)}this._transport.closed.then((function(){t.onClose()})).catch((function(e){t.onError("webtransport error",e)})),this._transport.ready.then((function(){t._transport.createBidirectionalStream().then((function(e){var n=function(t,e){R||(R=new TextDecoder);var n=[],r=0,i=-1,o=!1;return new TransformStream({transform:function(s,a){for(n.push(s);;){if(0===r){if(j(n)<1)break;var c=P(n,1);o=128==(128&c[0]),i=127&c[0],r=i<126?3:126===i?1:2}else if(1===r){if(j(n)<2)break;var u=P(n,2);i=new DataView(u.buffer,u.byteOffset,u.length).getUint16(0),r=3}else if(2===r){if(j(n)<8)break;var h=P(n,8),f=new DataView(h.buffer,h.byteOffset,h.length),p=f.getUint32(0);if(p>Math.pow(2,21)-1){a.enqueue(m);break}i=p*Math.pow(2,32)+f.getUint32(4),r=3}else{if(j(n)<i)break;var l=P(n,i);a.enqueue(F(o?l:R.decode(l),e)),r=0}if(0===i||i>t){a.enqueue(m);break}}}})}(Number.MAX_SAFE_INTEGER,t.socket.binaryType),r=e.readable.pipeThrough(n).getReader(),i=L();i.readable.pipeTo(e.writable),t._writer=i.writable.getWriter(),function e(){r.read().then((function(n){var r=n.done,i=n.value;r||(t.onPacket(i),e())})).catch((function(t){}))}();var o={type:"open"};t.query.sid&&(o.data='{"sid":"'.concat(t.query.sid,'"}')),t._writer.write(o).then((function(){return t.onOpen()}))}))}))},n.write=function(t){var e=this;this.writable=!1;for(var n=function(){var n=t[r],i=r===t.length-1;e._writer.write(n).then((function(){i&&I((function(){e.writable=!0,e.emitReserved("drain")}),e.setTimeoutFn)}))},r=0;r<t.length;r++)n()},n.doClose=function(){var t;null===(t=this._transport)||void 0===t||t.close()},r(e,[{key:"name",get:function(){return"webtransport"}}])}(W),polling:nt},ct=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,ut=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function ht(t){if(t.length>8e3)throw"URI too long";var e,n,r,i=t,o=t.indexOf("["),s=t.indexOf("]");-1!=o&&-1!=s&&(t=t.substring(0,o)+t.substring(o,s).replace(/:/g,";")+t.substring(s,t.length));for(var a,c,u=ct.exec(t||""),h={},f=14;f--;)h[ut[f]]=u[f]||"";return-1!=o&&-1!=s&&(h.source=i,h.host=h.host.substring(1,h.host.length-1).replace(/;/g,":"),h.authority=h.authority.replace("[","").replace("]","").replace(/;/g,":"),h.ipv6uri=!0),h.pathNames=(e=h.path,n=/\/{2,9}/g,r=e.replace(n,"/").split("/"),"/"!=e.slice(0,1)&&0!==e.length||r.splice(0,1),"/"==e.slice(-1)&&r.splice(r.length-1,1),r),h.queryKey=(a=h.query,c={},a.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(t,e,n){e&&(c[e]=n)})),c),h}var ft="function"==typeof addEventListener&&"function"==typeof removeEventListener,pt=[];ft&&addEventListener("offline",(function(){pt.forEach((function(t){return t()}))}),!1);var lt=function(t){function e(e,n){var r;if((r=t.call(this)||this).binaryType="arraybuffer",r.writeBuffer=[],r._prevBufferLen=0,r._pingInterval=-1,r._pingTimeout=-1,r._maxPayload=-1,r._pingTimeoutTime=1/0,e&&"object"===p(e)&&(n=e,e=null),e){var i=ht(e);n.hostname=i.host,n.secure="https"===i.protocol||"wss"===i.protocol,n.port=i.port,i.query&&(n.query=i.query)}else n.host&&(n.hostname=ht(n.host).host);return H(r,n),r.secure=null!=n.secure?n.secure:"undefined"!=typeof location&&"https:"===location.protocol,n.hostname&&!n.port&&(n.port=r.secure?"443":"80"),r.hostname=n.hostname||("undefined"!=typeof location?location.hostname:"localhost"),r.port=n.port||("undefined"!=typeof location&&location.port?location.port:r.secure?"443":"80"),r.transports=[],r._transportsByName={},n.transports.forEach((function(t){var e=t.prototype.name;r.transports.push(e),r._transportsByName[e]=t})),r.opts=o({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},n),r.opts.path=r.opts.path.replace(/\/$/,"")+(r.opts.addTrailingSlash?"/":""),"string"==typeof r.opts.query&&(r.opts.query=function(t){for(var e={},n=t.split("&"),r=0,i=n.length;r<i;r++){var o=n[r].split("=");e[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return e}(r.opts.query)),ft&&(r.opts.closeOnBeforeunload&&(r._beforeunloadEventListener=function(){r.transport&&(r.transport.removeAllListeners(),r.transport.close())},addEventListener("beforeunload",r._beforeunloadEventListener,!1)),"localhost"!==r.hostname&&(r._offlineEventListener=function(){r._onClose("transport close",{description:"network connection lost"})},pt.push(r._offlineEventListener))),r.opts.withCredentials&&(r._cookieJar=void 0),r._open(),r}a(e,t);var n=e.prototype;return n.createTransport=function(t){var e=o({},this.opts.query);e.EIO=4,e.transport=t,this.id&&(e.sid=this.id);var n=o({},this.opts,{query:e,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[t]);return new this._transportsByName[t](n)},n._open=function(){var t=this;if(0!==this.transports.length){var n=this.opts.rememberUpgrade&&e.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket")?"websocket":this.transports[0];this.readyState="opening";var r=this.createTransport(n);r.open(),this.setTransport(r)}else this.setTimeoutFn((function(){t.emitReserved("error","No transports available")}),0)},n.setTransport=function(t){var e=this;this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",(function(t){return e._onClose("transport close",t)}))},n.onOpen=function(){this.readyState="open",e.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush()},n._onPacket=function(t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":var e=new Error("server error");e.code=t.data,this._onError(e);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data)}},n.onHandshake=function(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this._pingInterval=t.pingInterval,this._pingTimeout=t.pingTimeout,this._maxPayload=t.maxPayload,this.onOpen(),"closed"!==this.readyState&&this._resetPingTimeout()},n._resetPingTimeout=function(){var t=this;this.clearTimeoutFn(this._pingTimeoutTimer);var e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn((function(){t._onClose("ping timeout")}),e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()},n._onDrain=function(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()},n.flush=function(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){var t=this._getWritablePackets();this.transport.send(t),this._prevBufferLen=t.length,this.emitReserved("flush")}},n._getWritablePackets=function(){if(!(this._maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1))return this.writeBuffer;for(var t,e=1,n=0;n<this.writeBuffer.length;n++){var r=this.writeBuffer[n].data;if(r&&(e+="string"==typeof(t=r)?function(t){for(var e=0,n=0,r=0,i=t.length;r<i;r++)(e=t.charCodeAt(r))<128?n+=1:e<2048?n+=2:e<55296||e>=57344?n+=3:(r++,n+=4);return n}(t):Math.ceil(1.33*(t.byteLength||t.size))),n>0&&e>this._maxPayload)return this.writeBuffer.slice(0,n);e+=2}return this.writeBuffer},n._hasPingExpired=function(){var t=this;if(!this._pingTimeoutTime)return!0;var e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,I((function(){t._onClose("ping timeout")}),this.setTimeoutFn)),e},n.write=function(t,e,n){return this._sendPacket("message",t,e,n),this},n.send=function(t,e,n){return this._sendPacket("message",t,e,n),this},n._sendPacket=function(t,e,n,r){if("function"==typeof e&&(r=e,e=void 0),"function"==typeof n&&(r=n,n=null),"closing"!==this.readyState&&"closed"!==this.readyState){(n=n||{}).compress=!1!==n.compress;var i={type:t,data:e,options:n};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),r&&this.once("flush",r),this.flush()}},n.close=function(){var t=this,e=function(){t._onClose("forced close"),t.transport.close()},n=function n(){t.off("upgrade",n),t.off("upgradeError",n),e()},r=function(){t.once("upgrade",n),t.once("upgradeError",n)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",(function(){t.upgrading?r():e()})):this.upgrading?r():e()),this},n._onError=function(t){if(e.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&"opening"===this.readyState)return this.transports.shift(),this._open();this.emitReserved("error",t),this._onClose("transport error",t)},n._onClose=function(t,e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),ft&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){var n=pt.indexOf(this._offlineEventListener);-1!==n&&pt.splice(n,1)}this.readyState="closed",this.id=null,this.emitReserved("close",t,e),this.writeBuffer=[],this._prevBufferLen=0}},e}(q);lt.protocol=4;var dt=function(t){function e(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r="object"===p(e)?e:n;return(!r.transports||r.transports&&"string"==typeof r.transports[0])&&(r.transports=(r.transports||["polling","websocket","webtransport"]).map((function(t){return at[t]})).filter((function(t){return!!t}))),t.call(this,e,r)||this}return a(e,t),e}(function(t){function e(){var e;return(e=t.apply(this,arguments)||this)._upgrades=[],e}a(e,t);var n=e.prototype;return n.onOpen=function(){if(t.prototype.onOpen.call(this),"open"===this.readyState&&this.opts.upgrade)for(var e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])},n._probe=function(t){var e=this,n=this.createTransport(t),r=!1;lt.priorWebsocketSuccess=!1;var i=function(){r||(n.send([{type:"ping",data:"probe"}]),n.once("packet",(function(t){if(!r)if("pong"===t.type&&"probe"===t.data){if(e.upgrading=!0,e.emitReserved("upgrading",n),!n)return;lt.priorWebsocketSuccess="websocket"===n.name,e.transport.pause((function(){r||"closed"!==e.readyState&&(h(),e.setTransport(n),n.send([{type:"upgrade"}]),e.emitReserved("upgrade",n),n=null,e.upgrading=!1,e.flush())}))}else{var i=new Error("probe error");i.transport=n.name,e.emitReserved("upgradeError",i)}})))};function o(){r||(r=!0,h(),n.close(),n=null)}var s=function(t){var r=new Error("probe error: "+t);r.transport=n.name,o(),e.emitReserved("upgradeError",r)};function a(){s("transport closed")}function c(){s("socket closed")}function u(t){n&&t.name!==n.name&&o()}var h=function(){n.removeListener("open",i),n.removeListener("error",s),n.removeListener("close",a),e.off("close",c),e.off("upgrading",u)};n.once("open",i),n.once("error",s),n.once("close",a),this.once("close",c),this.once("upgrading",u),-1!==this._upgrades.indexOf("webtransport")&&"webtransport"!==t?this.setTimeoutFn((function(){r||n.open()}),200):n.open()},n.onHandshake=function(e){this._upgrades=this._filterUpgrades(e.upgrades),t.prototype.onHandshake.call(this,e)},n._filterUpgrades=function(t){for(var e=[],n=0;n<t.length;n++)~this.transports.indexOf(t[n])&&e.push(t[n]);return e},e}(lt));function yt(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var vt,gt,mt={exports:{}};function bt(){if(gt)return vt;gt=1;var t=1e3,e=60*t,n=60*e,r=24*n,i=7*r,o=365.25*r;function s(t,e,n,r){var i=e>=1.5*n;return Math.round(t/n)+" "+r+(i?"s":"")}return vt=function(a,c){c=c||{};var u=p(a);if("string"===u&&a.length>0)return function(s){if(!((s=String(s)).length>100)){var a=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(s);if(a){var c=parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return c*o;case"weeks":case"week":case"w":return c*i;case"days":case"day":case"d":return c*r;case"hours":case"hour":case"hrs":case"hr":case"h":return c*n;case"minutes":case"minute":case"mins":case"min":case"m":return c*e;case"seconds":case"second":case"secs":case"sec":case"s":return c*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:return}}}}(a);if("number"===u&&isFinite(a))return c.long?function(i){var o=Math.abs(i);return o>=r?s(i,o,r,"day"):o>=n?s(i,o,n,"hour"):o>=e?s(i,o,e,"minute"):o>=t?s(i,o,t,"second"):i+" ms"}(a):function(i){var o=Math.abs(i);return o>=r?Math.round(i/r)+"d":o>=n?Math.round(i/n)+"h":o>=e?Math.round(i/e)+"m":o>=t?Math.round(i/t)+"s":i+"ms"}(a);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(a))}}var _t=function(t){function e(t){var r,i,o,s=null;function a(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];if(a.enabled){var o=a,s=Number(new Date),c=s-(r||s);o.diff=c,o.prev=r,o.curr=s,r=s,n[0]=e.coerce(n[0]),"string"!=typeof n[0]&&n.unshift("%O");var u=0;n[0]=n[0].replace(/%([a-zA-Z%])/g,(function(t,r){if("%%"===t)return"%";u++;var i=e.formatters[r];if("function"==typeof i){var s=n[u];t=i.call(o,s),n.splice(u,1),u--}return t})),e.formatArgs.call(o,n);var h=o.log||e.log;h.apply(o,n)}}return a.namespace=t,a.useColors=e.useColors(),a.color=e.selectColor(t),a.extend=n,a.destroy=e.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:function(){return null!==s?s:(i!==e.namespaces&&(i=e.namespaces,o=e.enabled(t)),o)},set:function(t){s=t}}),"function"==typeof e.init&&e.init(a),a}function n(t,n){var r=e(this.namespace+(void 0===n?":":n)+t);return r.log=this.log,r}function r(t){return t.toString().substring(2,t.toString().length-2).replace(/\.\*\?$/,"*")}return e.debug=e,e.default=e,e.coerce=function(t){return t instanceof Error?t.stack||t.message:t},e.disable=function(){var t=[].concat(h(e.names.map(r)),h(e.skips.map(r).map((function(t){return"-"+t})))).join(",");return e.enable(""),t},e.enable=function(t){var n;e.save(t),e.namespaces=t,e.names=[],e.skips=[];var r=("string"==typeof t?t:"").split(/[\s,]+/),i=r.length;for(n=0;n<i;n++)r[n]&&("-"===(t=r[n].replace(/\*/g,".*?"))[0]?e.skips.push(new RegExp("^"+t.slice(1)+"$")):e.names.push(new RegExp("^"+t+"$")))},e.enabled=function(t){if("*"===t[t.length-1])return!0;var n,r;for(n=0,r=e.skips.length;n<r;n++)if(e.skips[n].test(t))return!1;for(n=0,r=e.names.length;n<r;n++)if(e.names[n].test(t))return!0;return!1},e.humanize=bt(),e.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(t).forEach((function(n){e[n]=t[n]})),e.names=[],e.skips=[],e.formatters={},e.selectColor=function(t){for(var n=0,r=0;r<t.length;r++)n=(n<<5)-n+t.charCodeAt(r),n|=0;return e.colors[Math.abs(n)%e.colors.length]},e.enable(e.load()),e};!function(t,e){var n;e.formatArgs=function(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),this.useColors){var n="color: "+this.color;e.splice(1,0,n,"color: inherit");var r=0,i=0;e[0].replace(/%[a-zA-Z%]/g,(function(t){"%%"!==t&&(r++,"%c"===t&&(i=r))})),e.splice(i,0,n)}},e.save=function(t){try{t?e.storage.setItem("debug",t):e.storage.removeItem("debug")}catch(t){}},e.load=function(){var t;try{t=e.storage.getItem("debug")}catch(t){}return!t&&"undefined"!=typeof process&&"env"in process&&(t=process.env.DEBUG),t},e.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},e.storage=function(){try{return localStorage}catch(t){}}(),e.destroy=(n=!1,function(){n||(n=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.log=console.debug||console.log||function(){},t.exports=_t(e),t.exports.formatters.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}}(mt,mt.exports);var wt=yt(mt.exports),Ct=wt("socket.io-client:url"),kt="function"==typeof ArrayBuffer,At=Object.prototype.toString,Et="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===At.call(Blob),Ot="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===At.call(File);function Tt(t){return kt&&(t instanceof ArrayBuffer||function(t){return"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer}(t))||Et&&t instanceof Blob||Ot&&t instanceof File}function Rt(t,e){if(!t||"object"!==p(t))return!1;if(Array.isArray(t)){for(var n=0,r=t.length;n<r;n++)if(Rt(t[n]))return!0;return!1}if(Tt(t))return!0;if(t.toJSON&&"function"==typeof t.toJSON&&1===arguments.length)return Rt(t.toJSON(),!0);for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)&&Rt(t[i]))return!0;return!1}function St(t){var e=[],n=t.data,r=t;return r.data=Ft(n,e),r.attachments=e.length,{packet:r,buffers:e}}function Ft(t,e){if(!t)return t;if(Tt(t)){var n={_placeholder:!0,num:e.length};return e.push(t),n}if(Array.isArray(t)){for(var r=new Array(t.length),i=0;i<t.length;i++)r[i]=Ft(t[i],e);return r}if("object"===p(t)&&!(t instanceof Date)){var o={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(o[s]=Ft(t[s],e));return o}return t}function xt(t,e){return t.data=Bt(t.data,e),delete t.attachments,t}function Bt(t,e){if(!t)return t;if(t&&!0===t._placeholder){if("number"==typeof t.num&&t.num>=0&&t.num<e.length)return e[t.num];throw new Error("illegal attachments")}if(Array.isArray(t))for(var n=0;n<t.length;n++)t[n]=Bt(t[n],e);else if("object"===p(t))for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(t[r]=Bt(t[r],e));return t}var Nt,Lt=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"];!function(t){t[t.CONNECT=0]="CONNECT",t[t.DISCONNECT=1]="DISCONNECT",t[t.EVENT=2]="EVENT",t[t.ACK=3]="ACK",t[t.CONNECT_ERROR=4]="CONNECT_ERROR",t[t.BINARY_EVENT=5]="BINARY_EVENT",t[t.BINARY_ACK=6]="BINARY_ACK"}(Nt||(Nt={}));var jt=function(){function t(t){this.replacer=t}var e=t.prototype;return e.encode=function(t){return t.type!==Nt.EVENT&&t.type!==Nt.ACK||!Rt(t)?[this.encodeAsString(t)]:this.encodeAsBinary({type:t.type===Nt.EVENT?Nt.BINARY_EVENT:Nt.BINARY_ACK,nsp:t.nsp,data:t.data,id:t.id})},e.encodeAsString=function(t){var e=""+t.type;return t.type!==Nt.BINARY_EVENT&&t.type!==Nt.BINARY_ACK||(e+=t.attachments+"-"),t.nsp&&"/"!==t.nsp&&(e+=t.nsp+","),null!=t.id&&(e+=t.id),null!=t.data&&(e+=JSON.stringify(t.data,this.replacer)),e},e.encodeAsBinary=function(t){var e=St(t),n=this.encodeAsString(e.packet),r=e.buffers;return r.unshift(n),r},t}(),Pt=function(t){function e(e){var n;return(n=t.call(this)||this).reviver=e,n}a(e,t);var n=e.prototype;return n.add=function(e){var n;if("string"==typeof e){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");var r=(n=this.decodeString(e)).type===Nt.BINARY_EVENT;r||n.type===Nt.BINARY_ACK?(n.type=r?Nt.EVENT:Nt.ACK,this.reconstructor=new qt(n),0===n.attachments&&t.prototype.emitReserved.call(this,"decoded",n)):t.prototype.emitReserved.call(this,"decoded",n)}else{if(!Tt(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(n=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,t.prototype.emitReserved.call(this,"decoded",n))}},n.decodeString=function(t){var n=0,r={type:Number(t.charAt(0))};if(void 0===Nt[r.type])throw new Error("unknown packet type "+r.type);if(r.type===Nt.BINARY_EVENT||r.type===Nt.BINARY_ACK){for(var i=n+1;"-"!==t.charAt(++n)&&n!=t.length;);var o=t.substring(i,n);if(o!=Number(o)||"-"!==t.charAt(n))throw new Error("Illegal attachments");r.attachments=Number(o)}if("/"===t.charAt(n+1)){for(var s=n+1;++n&&","!==t.charAt(n)&&n!==t.length;);r.nsp=t.substring(s,n)}else r.nsp="/";var a=t.charAt(n+1);if(""!==a&&Number(a)==a){for(var c=n+1;++n;){var u=t.charAt(n);if(null==u||Number(u)!=u){--n;break}if(n===t.length)break}r.id=Number(t.substring(c,n+1))}if(t.charAt(++n)){var h=this.tryParse(t.substr(n));if(!e.isPayloadValid(r.type,h))throw new Error("invalid payload");r.data=h}return r},n.tryParse=function(t){try{return JSON.parse(t,this.reviver)}catch(t){return!1}},e.isPayloadValid=function(t,e){switch(t){case Nt.CONNECT:return Ut(e);case Nt.DISCONNECT:return void 0===e;case Nt.CONNECT_ERROR:return"string"==typeof e||Ut(e);case Nt.EVENT:case Nt.BINARY_EVENT:return Array.isArray(e)&&("number"==typeof e[0]||"string"==typeof e[0]&&-1===Lt.indexOf(e[0]));case Nt.ACK:case Nt.BINARY_ACK:return Array.isArray(e)}},n.destroy=function(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)},e}(q),qt=function(){function t(t){this.packet=t,this.buffers=[],this.reconPack=t}var e=t.prototype;return e.takeBinaryData=function(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){var e=xt(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null},e.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]},t}(),It=Number.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t};function Ut(t){return"[object Object]"===Object.prototype.toString.call(t)}var Dt=Object.freeze({__proto__:null,protocol:5,get PacketType(){return Nt},Encoder:jt,Decoder:Pt,isPacketValid:function(t){return"string"==typeof t.nsp&&(void 0===(e=t.id)||It(e))&&function(t,e){switch(t){case Nt.CONNECT:return void 0===e||Ut(e);case Nt.DISCONNECT:return void 0===e;case Nt.EVENT:return Array.isArray(e)&&("number"==typeof e[0]||"string"==typeof e[0]&&-1===Lt.indexOf(e[0]));case Nt.ACK:return Array.isArray(e);case Nt.CONNECT_ERROR:return"string"==typeof e||Ut(e);default:return!1}}(t.type,t.data);var e}});function Mt(t,e,n){return t.on(e,n),function(){t.off(e,n)}}var Vt=wt("socket.io-client:socket"),Ht=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1}),Kt=function(t){function e(e,n,r){var i;return(i=t.call(this)||this).connected=!1,i.recovered=!1,i.receiveBuffer=[],i.sendBuffer=[],i._queue=[],i._queueSeq=0,i.ids=0,i.acks={},i.flags={},i.io=e,i.nsp=n,r&&r.auth&&(i.auth=r.auth),i._opts=o({},r),i.io._autoConnect&&i.open(),i}a(e,t);var n=e.prototype;return n.subEvents=function(){if(!this.subs){var t=this.io;this.subs=[Mt(t,"open",this.onopen.bind(this)),Mt(t,"packet",this.onpacket.bind(this)),Mt(t,"error",this.onerror.bind(this)),Mt(t,"close",this.onclose.bind(this))]}},n.connect=function(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this},n.open=function(){return this.connect()},n.send=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.unshift("message"),this.emit.apply(this,e),this},n.emit=function(t){var e,n,r;if(Ht.hasOwnProperty(t))throw new Error('"'+t.toString()+'" is a reserved event name');for(var i=arguments.length,o=new Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];if(o.unshift(t),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(o),this;var a={type:Nt.EVENT,data:o,options:{}};if(a.options.compress=!1!==this.flags.compress,"function"==typeof o[o.length-1]){var c=this.ids++;Vt("emitting packet with ack id %d",c);var u=o.pop();this._registerAckCallback(c,u),a.id=c}var h=null===(n=null===(e=this.io.engine)||void 0===e?void 0:e.transport)||void 0===n?void 0:n.writable,f=this.connected&&!(null===(r=this.io.engine)||void 0===r?void 0:r._hasPingExpired()),p=this.flags.volatile&&!h;return p?Vt("discard packet as the transport is not currently writable"):f?(this.notifyOutgoingListeners(a),this.packet(a)):this.sendBuffer.push(a),this.flags={},this},n._registerAckCallback=function(t,e){var n,r=this,i=null!==(n=this.flags.timeout)&&void 0!==n?n:this._opts.ackTimeout;if(void 0!==i){var o=this.io.setTimeoutFn((function(){delete r.acks[t];for(var n=0;n<r.sendBuffer.length;n++)r.sendBuffer[n].id===t&&(Vt("removing packet with ack id %d from the buffer",t),r.sendBuffer.splice(n,1));Vt("event with ack id %d has timed out after %d ms",t,i),e.call(r,new Error("operation has timed out"))}),i),s=function(){r.io.clearTimeoutFn(o);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];e.apply(r,n)};s.withError=!0,this.acks[t]=s}else this.acks[t]=e},n.emitWithAck=function(t){for(var e=this,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return new Promise((function(n,i){var o=function(t,e){return t?i(t):n(e)};o.withError=!0,r.push(o),e.emit.apply(e,[t].concat(r))}))},n._addToQueue=function(t){var e,n=this;"function"==typeof t[t.length-1]&&(e=t.pop());var r={id:this._queueSeq++,tryCount:0,pending:!1,args:t,flags:o({fromQueue:!0},this.flags)};t.push((function(t){if(r===n._queue[0]){var i=null!==t;if(i)r.tryCount>n._opts.retries&&(Vt("packet [%d] is discarded after %d tries",r.id,r.tryCount),n._queue.shift(),e&&e(t));else if(Vt("packet [%d] was successfully sent",r.id),n._queue.shift(),e){for(var o=arguments.length,s=new Array(o>1?o-1:0),a=1;a<o;a++)s[a-1]=arguments[a];e.apply(void 0,[null].concat(s))}return r.pending=!1,n._drainQueue()}})),this._queue.push(r),this._drainQueue()},n._drainQueue=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(Vt("draining queue"),this.connected&&0!==this._queue.length){var e=this._queue[0];!e.pending||t?(e.pending=!0,e.tryCount++,Vt("sending packet [%d] (try n°%d)",e.id,e.tryCount),this.flags=e.flags,this.emit.apply(this,e.args)):Vt("packet [%d] has already been sent and is waiting for an ack",e.id)}},n.packet=function(t){t.nsp=this.nsp,this.io._packet(t)},n.onopen=function(){var t=this;Vt("transport is open - connecting"),"function"==typeof this.auth?this.auth((function(e){t._sendConnectPacket(e)})):this._sendConnectPacket(this.auth)},n._sendConnectPacket=function(t){this.packet({type:Nt.CONNECT,data:this._pid?o({pid:this._pid,offset:this._lastOffset},t):t})},n.onerror=function(t){this.connected||this.emitReserved("connect_error",t)},n.onclose=function(t,e){Vt("close (%s)",t),this.connected=!1,delete this.id,this.emitReserved("disconnect",t,e),this._clearAcks()},n._clearAcks=function(){var t=this;Object.keys(this.acks).forEach((function(e){if(!t.sendBuffer.some((function(t){return String(t.id)===e}))){var n=t.acks[e];delete t.acks[e],n.withError&&n.call(t,new Error("socket has been disconnected"))}}))},n.onpacket=function(t){if(t.nsp===this.nsp)switch(t.type){case Nt.CONNECT:t.data&&t.data.sid?this.onconnect(t.data.sid,t.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case Nt.EVENT:case Nt.BINARY_EVENT:this.onevent(t);break;case Nt.ACK:case Nt.BINARY_ACK:this.onack(t);break;case Nt.DISCONNECT:this.ondisconnect();break;case Nt.CONNECT_ERROR:this.destroy();var e=new Error(t.data.message);e.data=t.data.data,this.emitReserved("connect_error",e)}},n.onevent=function(t){var e=t.data||[];Vt("emitting event %j",e),null!=t.id&&(Vt("attaching ack callback to event"),e.push(this.ack(t.id))),this.connected?this.emitEvent(e):this.receiveBuffer.push(Object.freeze(e))},n.emitEvent=function(e){if(this._anyListeners&&this._anyListeners.length){var n,r=i(this._anyListeners.slice());try{for(r.s();!(n=r.n()).done;)n.value.apply(this,e)}catch(t){r.e(t)}finally{r.f()}}t.prototype.emit.apply(this,e),this._pid&&e.length&&"string"==typeof e[e.length-1]&&(this._lastOffset=e[e.length-1])},n.ack=function(t){var e=this,n=!1;return function(){if(!n){n=!0;for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];Vt("sending ack %j",i),e.packet({type:Nt.ACK,id:t,data:i})}}},n.onack=function(t){var e=this.acks[t.id];"function"==typeof e?(delete this.acks[t.id],Vt("calling ack %s with %j",t.id,t.data),e.withError&&t.data.unshift(null),e.apply(this,t.data)):Vt("bad ack %s",t.id)},n.onconnect=function(t,e){Vt("socket connected with id %s",t),this.id=t,this.recovered=e&&this._pid===e,this._pid=e,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)},n.emitBuffered=function(){var t=this;this.receiveBuffer.forEach((function(e){return t.emitEvent(e)})),this.receiveBuffer=[],this.sendBuffer.forEach((function(e){t.notifyOutgoingListeners(e),t.packet(e)})),this.sendBuffer=[]},n.ondisconnect=function(){Vt("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},n.destroy=function(){this.subs&&(this.subs.forEach((function(t){return t()})),this.subs=void 0),this.io._destroy(this)},n.disconnect=function(){return this.connected&&(Vt("performing disconnect (%s)",this.nsp),this.packet({type:Nt.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},n.close=function(){return this.disconnect()},n.compress=function(t){return this.flags.compress=t,this},n.timeout=function(t){return this.flags.timeout=t,this},n.onAny=function(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this},n.prependAny=function(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this},n.offAny=function(t){if(!this._anyListeners)return this;if(t){for(var e=this._anyListeners,n=0;n<e.length;n++)if(t===e[n])return e.splice(n,1),this}else this._anyListeners=[];return this},n.listenersAny=function(){return this._anyListeners||[]},n.onAnyOutgoing=function(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this},n.prependAnyOutgoing=function(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this},n.offAnyOutgoing=function(t){if(!this._anyOutgoingListeners)return this;if(t){for(var e=this._anyOutgoingListeners,n=0;n<e.length;n++)if(t===e[n])return e.splice(n,1),this}else this._anyOutgoingListeners=[];return this},n.listenersAnyOutgoing=function(){return this._anyOutgoingListeners||[]},n.notifyOutgoingListeners=function(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){var e,n=i(this._anyOutgoingListeners.slice());try{for(n.s();!(e=n.n()).done;)e.value.apply(this,t.data)}catch(t){n.e(t)}finally{n.f()}}},r(e,[{key:"disconnected",get:function(){return!this.connected}},{key:"active",get:function(){return!!this.subs}},{key:"volatile",get:function(){return this.flags.volatile=!0,this}}])}(q);function zt(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}zt.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),n=Math.floor(e*this.jitter*t);t=0==(1&Math.floor(10*e))?t-n:t+n}return 0|Math.min(t,this.max)},zt.prototype.reset=function(){this.attempts=0},zt.prototype.setMin=function(t){this.ms=t},zt.prototype.setMax=function(t){this.max=t},zt.prototype.setJitter=function(t){this.jitter=t};var Wt=wt("socket.io-client:manager"),Yt=function(t){function e(e,n){var r,i;(r=t.call(this)||this).nsps={},r.subs=[],e&&"object"===p(e)&&(n=e,e=void 0),(n=n||{}).path=n.path||"/socket.io",r.opts=n,H(r,n),r.reconnection(!1!==n.reconnection),r.reconnectionAttempts(n.reconnectionAttempts||1/0),r.reconnectionDelay(n.reconnectionDelay||1e3),r.reconnectionDelayMax(n.reconnectionDelayMax||5e3),r.randomizationFactor(null!==(i=n.randomizationFactor)&&void 0!==i?i:.5),r.backoff=new zt({min:r.reconnectionDelay(),max:r.reconnectionDelayMax(),jitter:r.randomizationFactor()}),r.timeout(null==n.timeout?2e4:n.timeout),r._readyState="closed",r.uri=e;var o=n.parser||Dt;return r.encoder=new o.Encoder,r.decoder=new o.Decoder,r._autoConnect=!1!==n.autoConnect,r._autoConnect&&r.open(),r}a(e,t);var n=e.prototype;return n.reconnection=function(t){return arguments.length?(this._reconnection=!!t,t||(this.skipReconnect=!0),this):this._reconnection},n.reconnectionAttempts=function(t){return void 0===t?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)},n.reconnectionDelay=function(t){var e;return void 0===t?this._reconnectionDelay:(this._reconnectionDelay=t,null===(e=this.backoff)||void 0===e||e.setMin(t),this)},n.randomizationFactor=function(t){var e;return void 0===t?this._randomizationFactor:(this._randomizationFactor=t,null===(e=this.backoff)||void 0===e||e.setJitter(t),this)},n.reconnectionDelayMax=function(t){var e;return void 0===t?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,null===(e=this.backoff)||void 0===e||e.setMax(t),this)},n.timeout=function(t){return arguments.length?(this._timeout=t,this):this._timeout},n.maybeReconnectOnOpen=function(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},n.open=function(t){var e=this;if(Wt("readyState %s",this._readyState),~this._readyState.indexOf("open"))return this;Wt("opening %s",this.uri),this.engine=new dt(this.uri,this.opts);var n=this.engine,r=this;this._readyState="opening",this.skipReconnect=!1;var i=Mt(n,"open",(function(){r.onopen(),t&&t()})),o=function(n){Wt("error"),e.cleanup(),e._readyState="closed",e.emitReserved("error",n),t?t(n):e.maybeReconnectOnOpen()},s=Mt(n,"error",o);if(!1!==this._timeout){var a=this._timeout;Wt("connect attempt will timeout after %d",a);var c=this.setTimeoutFn((function(){Wt("connect attempt timed out after %d",a),i(),o(new Error("timeout")),n.close()}),a);this.opts.autoUnref&&c.unref(),this.subs.push((function(){e.clearTimeoutFn(c)}))}return this.subs.push(i),this.subs.push(s),this},n.connect=function(t){return this.open(t)},n.onopen=function(){Wt("open"),this.cleanup(),this._readyState="open",this.emitReserved("open");var t=this.engine;this.subs.push(Mt(t,"ping",this.onping.bind(this)),Mt(t,"data",this.ondata.bind(this)),Mt(t,"error",this.onerror.bind(this)),Mt(t,"close",this.onclose.bind(this)),Mt(this.decoder,"decoded",this.ondecoded.bind(this)))},n.onping=function(){this.emitReserved("ping")},n.ondata=function(t){try{this.decoder.add(t)}catch(t){this.onclose("parse error",t)}},n.ondecoded=function(t){var e=this;I((function(){e.emitReserved("packet",t)}),this.setTimeoutFn)},n.onerror=function(t){Wt("error",t),this.emitReserved("error",t)},n.socket=function(t,e){var n=this.nsps[t];return n?this._autoConnect&&!n.active&&n.connect():(n=new Kt(this,t,e),this.nsps[t]=n),n},n._destroy=function(t){for(var e=0,n=Object.keys(this.nsps);e<n.length;e++){var r=n[e];if(this.nsps[r].active)return void Wt("socket %s is still active, skipping close",r)}this._close()},n._packet=function(t){Wt("writing packet %j",t);for(var e=this.encoder.encode(t),n=0;n<e.length;n++)this.engine.write(e[n],t.options)},n.cleanup=function(){Wt("cleanup"),this.subs.forEach((function(t){return t()})),this.subs.length=0,this.decoder.destroy()},n._close=function(){Wt("disconnect"),this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")},n.disconnect=function(){return this._close()},n.onclose=function(t,e){var n;Wt("closed due to %s",t),this.cleanup(),null===(n=this.engine)||void 0===n||n.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,e),this._reconnection&&!this.skipReconnect&&this.reconnect()},n.reconnect=function(){var t=this;if(this._reconnecting||this.skipReconnect)return this;var e=this;if(this.backoff.attempts>=this._reconnectionAttempts)Wt("reconnect failed"),this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{var n=this.backoff.duration();Wt("will wait %dms before reconnect attempt",n),this._reconnecting=!0;var r=this.setTimeoutFn((function(){e.skipReconnect||(Wt("attempting reconnect"),t.emitReserved("reconnect_attempt",e.backoff.attempts),e.skipReconnect||e.open((function(n){n?(Wt("reconnect attempt error"),e._reconnecting=!1,e.reconnect(),t.emitReserved("reconnect_error",n)):(Wt("reconnect success"),e.onreconnect())})))}),n);this.opts.autoUnref&&r.unref(),this.subs.push((function(){t.clearTimeoutFn(r)}))}},n.onreconnect=function(){var t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)},e}(q),$t=wt("socket.io-client"),Jt={};function Qt(t,e){"object"===p(t)&&(e=t,t=void 0);var n,r=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,r=t;n=n||"undefined"!=typeof location&&location,null==t&&(t=n.protocol+"//"+n.host),"string"==typeof t&&("/"===t.charAt(0)&&(t="/"===t.charAt(1)?n.protocol+t:n.host+t),/^(https?|wss?):\/\//.test(t)||(Ct("protocol-less url %s",t),t=void 0!==n?n.protocol+"//"+t:"https://"+t),Ct("parse %s",t),r=ht(t)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";var i=-1!==r.host.indexOf(":")?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+i+":"+r.port+e,r.href=r.protocol+"://"+i+(n&&n.port===r.port?"":":"+r.port),r}(t,(e=e||{}).path||"/socket.io"),i=r.source,o=r.id,s=r.path,a=Jt[o]&&s in Jt[o].nsps;return e.forceNew||e["force new connection"]||!1===e.multiplex||a?($t("ignoring socket cache for %s",i),n=new Yt(i,e)):(Jt[o]||($t("new io instance for %s",i),Jt[o]=new Yt(i,e)),n=Jt[o]),r.query&&!e.query&&(e.query=r.queryKey),n.socket(r.path,e)}return o(Qt,{Manager:Yt,Socket:Kt,io:Qt,connect:Qt}),Qt},"object"==typeof e&&void 0!==r?r.exports=a():"function"==typeof define&&define.amd?define(a):(s="undefined"!=typeof globalThis?globalThis:s||self).io=a(),t("default",r.exports),r.exports.formatArgs,r.exports.save,r.exports.load,r.exports.useColors,r.exports.storage,r.exports.destroy,r.exports.colors,r.exports.log}),{})}}}));

System.register("bundle://KKCoTuongBundle/_virtual/socket.io.mjs_cjs=&original=.js",["./socket.io.js","./cjs-loader.mjs"],(function(e,t){var s,r;return{setters:[function(t){s=t.__cjsMetaURL;var r={};r.__cjsMetaURL=t.__cjsMetaURL,r.default=t.default,e(r)},function(e){r=e.default}],execute:function(){s||r.throwInvalidWrapper("./socket.io.js",t.meta.url),r.require(s)}}}));

System.register("bundle://KKCoTuongBundle/_virtual/SocketEvent.ts",["cc"],(function(e){var o;return{setters:[function(e){o=e.cclegacy}],execute:function(){o._RF.push({},"d3f499F76NAQZgGENjbe80g","SocketEvent",void 0);e("SocketEvent",{startGame:"startGame",actions:"actions",join:"join",leave:"leave",dataRoom:"dataRoom",banqiData:"banqiData",countDown:"countDown",makeMove:"makeMove",peace:"peace",peaceAnswer:"peaceAnswer",messageCoTuong:"messageCoTuong"}),e("actionID",{joinRoom:"joinRoom",leaveRoom:"leaveRoom",readyRoom:"readyRoom",makeMove:"makeMove",surrender:"surrender",peace:"peace",peaceAnswer:"peaceAnswer"}),e("typeSocket",{coTuong:"co-tuong",coUp:"co-up"});o._RF.pop()}}}));

System.register("bundle://KKCoTuongBundle/_virtual/SocketIO.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameData.ts","./socket.io.mjs_cjs=&original=.js","./kk.ts","./socket.io.js"],(function(t){var o,n,e,c,s,i;return{setters:[function(t){o=t.createClass},function(t){n=t.cclegacy,e=t._decorator},function(t){c=t.default},null,function(t){s=t.default},function(t){i=t.default}],execute:function(){n._RF.push({},"95d83Oc4r1AG7KqOHoHxPtU","SocketIO",void 0);e.ccclass,e.property,t("default",new(function(){function t(){this._socket=null}var n=t.prototype;return n.connect=function(t){var o=this;return new Promise((function(n,e){var r,u=null!=t?t:null==(r=s.config)||null==(r=r.service)?void 0:r.socketURL;if(o.disconnect(),o._socket=i(u,{transports:["websocket"],auth:null!=c&&c.info.token?{token:null==c?void 0:c.info.token}:void 0,reconnection:!0}),!o._socket)return e(new Error("Không khởi tạo được socket."));o._socket.on("connect",(function(){var t;console.log("Socket connected với id:",null==(t=o._socket)?void 0:t.id),n()})),o._socket.on("connect_error",(function(t){console.error("Lỗi kết nối socket:",t),e(t)})),o._socket.on("disconnect",(function(t){console.warn("Socket đã disconnect:",t)}))}))},n.disconnect=function(){this._socket&&this._socket.connected&&this._socket.disconnect(),this._socket=null},n.reqAsync=function(t,o){var n=this;return new Promise((function(e,c){if(!n._socket||!n._socket.connected)return c(new Error("Socket chưa kết nối."));n._socket.emit(t,o,(function(t){e(t)}))}))},n.on=function(t,o){this._socket&&this._socket.on(t,o)},n.off=function(t,o){this._socket&&(o?this._socket.off(t,o):this._socket.off(t))},o(t,[{key:"socket",get:function(){return this._socket}}]),t}()));n._RF.pop()}}}));

System.register("bundle://KKCoTuongBundle/_virtual/SocketManager.ts",["cc","./BaseSocket.ts"],(function(t){var e,o,s,c;return{setters:[function(t){e=t.cclegacy,o=t.warn},function(t){s=t.BaseSocket,c=t.SocketErrCode}],execute:function(){e._RF.push({},"489c5+jG5ZFhLK9D9DA7tR7","SocketManager",void 0);t("default",function(){function t(){this._sockets={}}var e=t.prototype;return e.connectAsync=function(t,e,o){var c=this;return void 0===o&&(o=0),new Promise((function(n,i){c._sockets[o]||(c._sockets[o]=new s),c._sockets[o].connectAsync(t,e).then(n).catch(i)}))},e.close=function(t,e){void 0===t&&(t=!1),void 0===e&&(e=0),this._sockets[e]&&(this._sockets[e].close(t),t&&delete this._sockets[e])},e.reqAsync=function(t,e,s,n){var i=this;return void 0===s&&(s=!1),void 0===n&&(n=0),new Promise((function(r,u){i._sockets[n]?i._sockets[n].reqAsync(t,e,s).then(r).catch(u):(o("This ws does not exist!"),u(c.NoThisSocket))}))},e.on=function(t,e,o,s){void 0===s&&(s=0),this._sockets[s]&&this._sockets[s].on(t,e,o)},e.off=function(t,e,o,s){void 0===s&&(s=0),this._sockets[s]&&this._sockets[s].off(t,e,o)},t}());e._RF.pop()}}}));

System.register("bundle://KKCoTuongBundle/_virtual/SoundManager.ts",["cc"],(function(t){var i,u,e,s,o;return{setters:[function(t){i=t.cclegacy,u=t.assetManager,e=t.warn,s=t.Node,o=t.AudioSource}],execute:function(){i._RF.push({},"cdc1829IlZKh6mOJsAkLqB5","SoundManager",void 0);t("default",function(){function t(){this._bundle="",this._path="",this._musicVolume=1,this._effectVolume=1,this._isMusicMute=!1,this._isEffectMute=!1,this._musicAudio=null,this._effectsMap=new Map,this._audioID=0}var i=t.prototype;return i.init=function(t,i){this._bundle=t,this._path=i},i.playMusicAsync=function(t,i,c){var n=this;return void 0===c&&(c=!0),new Promise((function(f,a){var d=u.getBundle(i||n._bundle);if(!d)return e("Bundle not found!"),void a();d.load(n._path+t,(function(t,i){if(t)return e(t),void a();n.stopMusic();var u=new s;n._musicAudio=u.addComponent(o),n._musicAudio.clip=i,n._musicAudio.volume=n._musicVolume*(n._isMusicMute?0:1),n._musicAudio.loop=c,n._musicAudio.play(),c?f():u.on(o.EventType.ENDED,f)}))}))},i.stopMusic=function(){this._musicAudio&&(this._clearAudio(this._musicAudio),this._musicAudio=null)},i.pauseMusic=function(){if(this._musicAudio){if(this._musicAudio.state==o.AudioState.PAUSED)return;this._musicAudio.pause()}},i.resumeMusic=function(){if(this._musicAudio){if(this._musicAudio.state!=o.AudioState.PAUSED)return;this._musicAudio.play()}},i.isMusicPlaying=function(){return!!this._musicAudio&&this._musicAudio.playing},i.playEffectAsync=function(t,i,c){var n=this;return void 0===c&&(c=!1),new Promise((function(f,a){var d=u.getBundle(i||n._bundle);if(!d)return e("Bundle not found!"),void a();d.load(n._path+t,(function(t,i){if(t)return e(t),void a();var u=new s,d=u.addComponent(o);d.clip=i,d.volume=n._effectVolume*(n._isEffectMute?0:1),d.loop=c,d.play(),n._audioID+=1;var _=n._audioID;n._effectsMap.set(_,d),c||u.on(o.EventType.ENDED,(function(){n.stopEffect(_)})),f(_)}))}))},i.stopEffect=function(t){var i=this._effectsMap.get(t);i&&(this._clearAudio(i),this._effectsMap.delete(t))},i.stopAllEffects=function(){var t=this;this._effectsMap.forEach((function(i,u){t._clearAudio(i)})),this._effectsMap.clear()},i.stopAll=function(){this.stopMusic(),this.stopAllEffects()},i.pauseEffect=function(t){var i=this._effectsMap.get(t);if(i){if(i.state==o.AudioState.PAUSED)return;i.pause()}},i.resumeEffect=function(t){var i=this._effectsMap.get(t);if(i){if(i.state!=o.AudioState.PAUSED)return;i.play()}},i.setMusicVolume=function(t){this._musicVolume=t,this._musicAudio&&(this._musicAudio.volume=t*(this._isMusicMute?0:1))},i.setEffectsVolume=function(t){var i=this;this._effectVolume=t,this._effectsMap.forEach((function(u,e){u.volume=t*(i._isEffectMute?0:1)}))},i.setMute=function(t){this.setMusicMute(t),this.setEffectMute(t)},i.setMusicMute=function(t){t!=this._isMusicMute&&(this._isMusicMute=t,this.setMusicVolume(this._musicVolume))},i.setEffectMute=function(t){t!=this._isEffectMute&&(this._isEffectMute=t,this.setEffectsVolume(this._effectVolume))},i._clearAudio=function(t){t.node.off(o.EventType.ENDED),t.stop(),t.clip=null,t.node.destroy()},t}());i._RF.pop()}}}));

System.register("bundle://KKCoTuongBundle/_virtual/SpriteNumber.ts",["./rollupPluginModLoBabelHelpers.js","cc","./CocosHelper.ts"],(function(e){var t,n,r,o,i,u,a,l,s,p,c,d,f,m,v,y;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,r=e.initializerDefineProperty,o=e.assertThisInitialized,i=e.createClass},function(e){u=e.cclegacy,a=e._decorator,l=e.CCInteger,s=e.SpriteFrame,p=e.NodePool,c=e.Node,d=e.Sprite,f=e.Layout,m=e.tween,v=e.Component},function(e){y=e.default}],execute:function(){var h,g,b,F,P,O,S,w,C;u._RF.push({},"d616f4/WRpCBb0yvPBiWy0r","SpriteNumber",void 0);var N=a.ccclass,_=a.property;e("SpriteNumber",(h=N("SpriteNumber"),g=_({type:l,tooltip:"数字图片间隔距离"}),b=_({type:l,tooltip:"小数点或逗号垂直方向偏移"}),F=_({type:[s],tooltip:"0123456789.,+-"}),h((S=t((O=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),u=0;u<n;u++)i[u]=arguments[u];return t=e.call.apply(e,[this].concat(i))||this,r(t,"divX",S,o(t)),r(t,"dotOffsetY",w,o(t)),r(t,"numFrms",C,o(t)),t._v="",t.ndPool=new p,t}n(t,e);var u=t.prototype;return u.getOne=function(){return 0==this.ndPool.size()?y.addSprite(new c,{spriteFrame:null}):this.ndPool.get().getComponent(d)},u.removeOne=function(e){this.ndPool.put(e)},u.start=function(){y.addLayout(this.node,{type:f.Type.HORIZONTAL,spacingX:this.divX})},u.onDestroy=function(){this.ndPool.clear(),this.ndPool=null},u.numVarTween=function(e,t,n,r){var o=this;void 0===r&&(r=1);var i=Math.round(20*r),u=(t-e)/i;m(this.node).delay(.05).call((function(){e+=u,o.value=n(e)})).union().repeat(i).call((function(){o.value=n(t)})).start()},i(t,[{key:"value",get:function(){return this._v},set:function(e){var t=this,n=String(e);t._v=n;for(var r=t.node.children.length-1;r>=0;--r)t.removeOne(t.node.children[r]);for(var o=0,i=0;i<n.length;++i){var u=t.getOne();if(o=0,"+"==n[i])u.spriteFrame=t.numFrms[12];else if("-"==n[i])u.spriteFrame=t.numFrms[13];else{var a="."==n[i],l=","==n[i];u.spriteFrame=a?t.numFrms[10]:l?t.numFrms[11]:t.numFrms[Number(n[i])],(a||l)&&(o=t.dotOffsetY)}u.node.setPosition(0,o),u.node.parent=t.node}}}]),t}(v)).prototype,"divX",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),w=t(O.prototype,"dotOffsetY",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),C=t(O.prototype,"numFrms",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),P=O))||P));u._RF.pop()}}}));

System.register("bundle://KKCoTuongBundle/_virtual/TimeHelper.ts",["cc"],(function(e){var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"d405cKVB+VLyJ44LBTBHwRg","TimeHelper",void 0);e("default",function(){function e(){}return e.getCurFullDate=function(e,t){void 0===t&&(t="/");var n="",r=e?new Date(e):new Date;n+=r.getFullYear()+t;var u=r.getMonth()+1;n+=u<10?"0"+u:u,n+=t;var a=r.getDate();return n+=a<10?"0"+a:a},e.getCurDate=function(e,t){void 0===t&&(t="/");var n="",r=e?new Date(e):new Date,u=r.getMonth()+1;n+=u<10?"0"+u:u,n+=t;var a=r.getDate();return n+=a<10?"0"+a:a},e.getDayOfMonth=function(e){return(e?new Date(e):new Date).getDate()},e.getCurDetailTime=function(e,t){void 0===t&&(t=":");var n=e?new Date(e):new Date;return n.getHours()+t+n.getMinutes()+t+n.getSeconds()+t+n.getMilliseconds()},e.getCurNormalTime=function(e,t){void 0===t&&(t=":");var n=e?new Date(e):new Date;return n.getHours()+t+n.getMinutes()+t+n.getSeconds()},e.getCurShortTime=function(e,t){void 0===t&&(t=":");var n=e?new Date(e):new Date;return n.getHours()+t+n.getMinutes()},e.getTimeStamp=function(){return Date.now()},e}());t._RF.pop()}}}));

System.register("bundle://KKCoTuongBundle/_virtual/UIBase.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,n,r,o,s;return{setters:[function(e){t=e.inheritsLoose},function(e){n=e.cclegacy,r=e._decorator,o=e.warn,s=e.Component}],execute:function(){var i;n._RF.push({},"20f52nE8qZBebODYeB7lFTm","UIBase",void 0);var c=r.ccclass;r.property,e("UIBase",c("UIBase")(i=function(e){function n(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this).refAssets=[],t.recvData=void 0,t}t(n,e);var r=n.prototype;return r.onBtnClick=function(e,t){},r.onDestroy=function(){this.refAssets.forEach((function(e,t){e.decRef()})),this.refAssets=null},r.getObj=function(e,t,n){var r,s,i;"string"==typeof e?(r=this.node,s=e,i=t):(r=e,s=t,i=n);for(var c=s.split("."),a=0;a<c.length;++a)if(!(r=r.getChildByName(c[a])))return c.length>1&&o("Child is NULL!",c[a]),null;return i?r.getComponent(i):r},n}(s))||i);n._RF.pop()}}}));

System.register("bundle://KKCoTuongBundle/_virtual/UIConfig.ts",["cc"],(function(e){var P;return{setters:[function(e){P=e.cclegacy}],execute:function(){P._RF.push({},"234edNDZPJMfqZX3vbxtXKO","UIConfig",void 0);e("UICacheMode",{NoCache:0,Cache:1,Stay:2}),e("LAYER_PATH","Prefabs/Layer/"),e("POPUP_PATH","Prefabs/Popup/"),e("PANEL_PATH","Prefabs/Panel/"),e("WIDGET_PATH","Prefabs/Widget/");P._RF.pop()}}}));

System.register("bundle://KKCoTuongBundle/_virtual/UIManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./kk.ts","./UIConfig.ts","./UIBase.ts","./AsyncHelper.ts","./CocosHelper.ts"],(function(e){var n,r,t,a,o,u,c,s,i,d,p,f,g,l,y,m,h,C,v,b;return{setters:[function(e){n=e.asyncToGenerator,r=e.regeneratorRuntime},function(e){t=e.cclegacy,a=e.Node,o=e.UITransform,u=e.BlockInputEvents,c=e.Prefab,s=e.assetManager,i=e.Sprite,d=e.UIOpacity,p=e.instantiate},function(e){f=e.default},function(e){g=e.UICacheMode,l=e.LAYER_PATH,y=e.POPUP_PATH,m=e.PANEL_PATH,h=e.WIDGET_PATH},function(e){C=e.UIBase},function(e){v=e.default},function(e){b=e.default}],execute:function(){t._RF.push({},"c8d38n/KhpOWo+93AqiABif","UIManager",void 0);e("default",function(){function e(){this._curLayerConf=void 0,this.pureBanFrm=null}var t=e.prototype;return t.getCurLayerConf=function(){return this._curLayerConf},t.getCurLayer=function(){return f.godNode.getChildByName(this._curLayerConf.name)},t.goLayerAsync=function(){var e=n(r().mark((function e(n,t){var a,o,u,c,s;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(o=(a=this)._curLayerConf)||o.name!==n.name){e.next=5;break}return a.resetCurLayerAsync(t),e.abrupt("return");case 5:if(a._curLayerConf=n,n.cacheMode!=g.Stay){e.next=17;break}if(!(u=f.godNode.getChildByName(n.name))){e.next=17;break}return u.active=!0,c=n.script?n.script:n.name,(s=u.getComponent(c)).recvData=t,s.refresh(),f.debugMgr.log("show Layer",n.name),a._clearLayer(o),e.abrupt("return");case 17:return e.next=19,a._genUIBaseAsync(n,l,t);case 19:e.sent.parent=f.godNode,f.debugMgr.log("create Layer",n.name),a._clearLayer(o);case 23:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}(),t.resetCurLayerAsync=function(){var e=n(r().mark((function e(n){var t,a,o,u,c,s;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a=(t=this)._curLayerConf)){e.next=20;break}if(a.cacheMode!=g.Stay){e.next=12;break}o=f.godNode.getChildByName(a.name),u=a.script?a.script:a.name,(c=o.getComponent(u)).recvData=n,c.refresh(),f.debugMgr.log("refresh Layer",a.name),e.next=20;break;case 12:return(s=f.godNode.getChildByName(a.name)).name="removed",e.next=16,t._genUIBaseAsync(a,l,n);case 16:e.sent.parent=f.godNode,s.destroy(),f.debugMgr.log("reset Layer",a.name);case 20:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}(),t.preLoadLayerAsync=function(){var e=n(r().mark((function e(n,t){var a;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=s.getBundle(n.bundle)){e.next=5;break}return e.next=4,v.loadBundleAsync(n.bundle);case 4:a=e.sent;case 5:return e.next=7,v.preloadAsync(a,l+n.name,c,t);case 7:case"end":return e.stop()}}),e)})));return function(n,r){return e.apply(this,arguments)}}(),t._clearLayer=function(e){if(e){var n=f.godNode.getChildByName(e.name);e.cacheMode==g.Stay?(n.active=!1,f.debugMgr.log("hide Layer",e.name)):(n.destroy(),f.debugMgr.log("destroy Layer",e.name))}},t.showPopupAsync=function(){var e=n(r().mark((function e(n,t){var o,c,s,p,g,l;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=this,c=new a(n.name),o.getCurLayer().addChild(c),c.addComponent(u),b.addWidget(c,{left:0,right:0,top:0,bottom:0}),s=new a("dark"),o.pureBanFrm||(o.pureBanFrm=b.genPureColorSpriteFrame(),o.pureBanFrm.addRef()),s.addComponent(i).spriteFrame=o.pureBanFrm,s.addComponent(d).opacity=180,s.parent=c,b.addWidget(s,{left:0,right:0,top:0,bottom:0}),e.next=13,o._genUIBaseAsync(n,y,t);case 13:return p=e.sent,g=n.script?n.script:n.name,l=p.getComponent(g),p.parent=c,null==l||l.showAnim(),f.debugMgr.log("show Popup",n.name),e.abrupt("return",new Promise((function(e,n){l.onDestroyCall=e})));case 20:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}(),t.getPopup=function(e,n){void 0===n&&(n=null),n||(n=this._curLayerConf);var r=f.godNode.getChildByName(n.name);return r?r.getChildByName(e.name):null},t.closeAllPopup=function(){var e=f.godNode.getChildByName(this._curLayerConf.name);e&&e.children.forEach((function(e,n){e.name.endsWith("Popup")&&e.destroy()}))},t._autoRemovePopup=function(e){null==e||e.destroy(),f.debugMgr.log("close Popup",e.name)},t.createPanelAsync=function(){var e=n(r().mark((function e(n,t){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._genUIBaseAsync(n,m,t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}(),t.createWidgetAsync=function(){var e=n(r().mark((function e(n,t){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("createWidgetAsync",n,t),e.next=3,this._genUIBaseAsync(n,h,t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}(),t._genUIBaseAsync=function(){var e=n(r().mark((function e(n,t,a){var o,u,i,d,f;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=s.getBundle(n.bundle)){e.next=5;break}return e.next=4,v.loadBundleAsync(n.bundle);case 4:o=e.sent;case 5:return e.next=7,v.loadAsync(o,t+n.name,c);case 7:return u=e.sent,i=p(u),d=n.script?n.script:n.name,(f=i.getComponent(d))||(f=i.addComponent(C)),f.recvData=a,n.cacheMode==g.Cache?0==u.refCount&&u.addRef():(u.addRef(),f.refAssets.push(u)),e.abrupt("return",i);case 15:case"end":return e.stop()}}),e)})));return function(n,r,t){return e.apply(this,arguments)}}(),t.banTouch=function(){if(!f.godNode.getChildByName("_ban")){var e=new a("_ban");e.addComponent(o).setContentSize(f.godNode.getComponent(o).contentSize),f.godNode.addChild(e),e.addComponent(u)}},t.unbanTouch=function(){var e=f.godNode.getChildByName("_ban");e&&e.destroy()},e}());t._RF.pop()}}}));

System.register("bundle://KKCoTuongBundle/_virtual/Xiangqi.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var r,n;return{setters:[function(e){r=e.extends},function(e){n=e.cclegacy}],execute:function(){n._RF.push({},"114657O5BRIh61V3YJDFVX+","Xiangqi",void 0);e("default",(function(e){console.log("Xiangqi init");var n="b",t="r",i=-1,o="p",u="c",s="r",a="n",f="b",l="a",p="k",c="rnbakabnr/9/1c5c1/p1p1p1p1p/9/9/P1P1P1P1P/1C5C1/9/RNBAKABNR r - - 0 1",h=Object.freeze(["1-0","0-1","1/2-1/2","*"]),d=Object.freeze({b:[16,-1,1],r:[-16,-1,1]}),v=Object.freeze({c:[-16,16,-1,1],r:[-16,16,-1,1],n:[-33,-31,31,33,-18,14,-14,18],b:[-34,34,30,-30],a:[-17,17,15,-15],k:[-16,16,-1,1]}),g=Object.freeze({NORMAL:"n",CAPTURE:"c"}),b=Object.freeze({NORMAL:1,CAPTURE:2}),m=Object.freeze({a9:0,b9:1,c9:2,d9:3,e9:4,f9:5,g9:6,h9:7,i9:8,a8:16,b8:17,c8:18,d8:19,e8:20,f8:21,g8:22,h8:23,i8:24,a7:32,b7:33,c7:34,d7:35,e7:36,f7:37,g7:38,h7:39,i7:40,a6:48,b6:49,c6:50,d6:51,e6:52,f6:53,g6:54,h6:55,i6:56,a5:64,b5:65,c5:66,d5:67,e5:68,f5:69,g5:70,h5:71,i5:72,a4:80,b4:81,c4:82,d4:83,e4:84,f4:85,g4:86,h4:87,i4:88,a3:96,b3:97,c3:98,d3:99,e3:100,f3:101,g3:102,h3:103,i3:104,a2:112,b2:113,c2:114,d2:115,e2:116,f2:117,g2:118,h2:119,i2:120,a1:128,b1:129,c1:130,d1:131,e1:132,f1:133,g1:134,h1:135,i1:136,a0:144,b0:145,c0:146,d0:147,e0:148,f0:149,g0:150,h0:151,i0:152}),y=new Array(256),q={r:i,b:i},w=t,A=0,R=1,N=[],k=[],_={};function C(e){void 0===e&&(e=!1),y=new Array(256),q={r:i,b:i},w=t,A=0,R=1,N=[],k=[],e||(_={}),I(E())}function O(){P(c)}function P(e,r){if(void 0===r&&(r=!1),!j(e).valid)return!1;var i,o,u=e.split(/\s+/),s=u[0],a=0;C(r);for(var f=0;f<s.length;++f)"/"===(i=s.charAt(f))?a+=7:-1!=="0123456789".indexOf(i)?a+=parseInt(i,10):(o=i<"a"?t:n,K({type:i.toLowerCase(),color:o},Y(a)),a++);return w=u[1]===n?n:t,A=parseInt(u[4],10),R=parseInt(u[5],10),I(E()),!0}function j(e){var r={0:"No errors.",1:"FEN string must contain six space-delimited fields.",2:"6th field (move number) must be a positive integer.",3:"5th field (half move counter) must be a non-negative integer.",4:"4th field (en-passant square) should be '-'.",5:"3rd field (castling availability) should be '-'.",6:"2nd field (side to move) is invalid.",7:"1st field (piece positions) does not contain 10 '/'-delimited rows.",8:"1st field (piece positions) is invalid [consecutive numbers].",9:"1st field (piece positions) is invalid [invalid piece].",10:"1st field (piece positions) is invalid [row too large].",11:"1st field (piece positions) is invalid [each side has one king].",12:"1st field (piece positions) is invalid [each side has no more than 2 advisers].",13:"1st field (piece positions) is invalid [each side has no more than 2 bishops].",14:"1st field (piece positions) is invalid [each side has no more than 2 knights].",15:"1st field (piece positions) is invalid [each side has no more than 2 rooks].",16:"1st field (piece positions) is invalid [each side has no more than 2 cannons].",17:"1st field (piece positions) is invalid [each side has no more than 5 pawns].",18:"1st field (piece positions) is invalid [black king should at right position].",19:"1st field (piece positions) is invalid [red king should at right position].",20:"1st field (piece positions) is invalid [black adviser should at right position].",21:"1st field (piece positions) is invalid [red adviser should at right position].",22:"1st field (piece positions) is invalid [black bishop should at right position].",23:"1st field (piece positions) is invalid [red bishop should at right position].",24:"1st field (piece positions) is invalid [black pawn should at right position].",25:"1st field (piece positions) is invalid [red pawn should at right position]."};function i(e){return{valid:0===e,error_number:e,error:r[e]}}var u=e.split(/\s+/);if(6!==u.length)return i(1);if(isNaN(u[5])||parseInt(u[5],10)<=0)return i(2);if(isNaN(u[4])||parseInt(u[4],10)<0)return i(3);if(!/^-$/.test(u[3]))return i(4);if(!/^-$/.test(u[2]))return i(5);if(!/^([rwb])$/.test(u[1]))return i(6);var s=u[0].split("/");if(10!==s.length)return i(7);var a,c,h,d,v={p:{number:0,squares:[]},P:{number:0,squares:[]},c:{number:0,squares:[]},C:{number:0,squares:[]},r:{number:0,squares:[]},R:{number:0,squares:[]},n:{number:0,squares:[]},N:{number:0,squares:[]},b:{number:0,squares:[]},B:{number:0,squares:[]},a:{number:0,squares:[]},A:{number:0,squares:[]},k:{number:0,squares:[]},K:{number:0,squares:[]}};for(a=0;a<s.length;a++){for(h=0,d=!1,c=0;c<s[a].length;c++)if(isNaN(s[a][c])){try{++v[s[a][c]].number}catch(e){return i(9)}v[s[a][c]].squares.push(a<<4|h),h+=1,d=!1}else{if(d)return i(8);h+=parseInt(s[a][c],10),d=!0}if(9!==h)return i(10)}if(1!==v.k.number||1!==v.K.number)return i(11);if(v.a.number>2||v.A.number>2)return i(12);if(v.b.number>2||v.B.number>2)return i(13);if(v.n.number>2||v.N.number>2)return i(14);if(v.r.number>2||v.R.number>2)return i(15);if(v.c.number>2||v.C.number>2)return i(16);if(v.p.number>5||v.P.number>5)return i(17);if(te(p,v.k.squares[0],n))return i(18);if(te(p,v.K.squares[0],t))return i(19);for(a=0;a<v.a.squares.length;++a)if(te(l,v.a.squares[a],n))return i(20);for(a=0;a<v.A.squares.length;++a)if(te(l,v.A.squares[a],t))return i(21);for(a=0;a<v.b.squares.length;++a)if(te(f,v.b.squares[a],n))return i(22);for(a=0;a<v.B.squares.length;++a)if(te(f,v.B.squares[a],t))return i(23);for(a=0;a<v.p.squares.length;++a)if(te(o,v.p.squares[a],n))return i(24);for(a=0;a<v.P.squares.length;++a)if(te(o,v.P.squares[a],t))return i(25);return i(0)}function E(){for(var e,r,n=0,i="",o=m.a9;o<=m.i0;++o)null==y[o]?n++:(n>0&&(i+=n,n=0),e=y[o].color,r=y[o].type,i+=e===t?r.toUpperCase():r.toLowerCase()),W(o)>=8&&(n>0&&(i+=n),o!==m.i0&&(i+="/"),n=0,o+=7);return[i,w,"-","-",A,R].join(" ")}function x(e){for(var r=0;r<e.length;r+=2)"string"==typeof e[r]&&"string"==typeof e[r+1]&&(_[e[r]]=e[r+1]);return _}function I(e){N.length>0||(e!==c?_.FEN=e:delete _.FEN)}function B(e){var r=y[m[e]];return r?{type:r.type,color:r.color}:null}function K(e,r){if(!("type"in e)||!("color"in e))return!1;if(-1==="pcrnbakPCRNBAK".indexOf(e.type.toLowerCase()))return!1;if(!(r in m))return!1;var n=m[r];return(e.type!==p||q[e.color]===i||q[e.color]===n)&&(!te(e.type,n,e.color)&&(y[n]={type:e.type,color:e.color},e.type===p&&(q[e.color]=n),I(E()),!0))}function L(e){function r(e,r,n,t,i){r.push(function(e,r,n,t){var i={color:w,from:r,to:n,flags:t,piece:e[r].type};return e[n]&&(i.captured=e[n].type),i}(e,n,t,i))}var n,t,i,c,h,g,q,A,R=[],N=w,k=ee(N),_=m.a9,C=m.i0,O=void 0===e||!("legal"in e)||e.legal,P=void 0!==e&&"opponent"in e&&e.opponent;if(void 0!==e&&"square"in e){if(!(e.square in m))return[];_=C=m[e.square]}for(P&&(w=ee(w),k=ee(N=w)),n=_;n<=C;++n)if(null!=(c=y[n])&&c.color===N){for(t=0,i=(h=c.type===o?d[N]:v[c.type]).length;t<i&&(!(c.type===o&&t>0)||re(n,N));++t)for(g=h[t],q=n,A=!1;!(ne(q+=g)||c.type===a&&ie(n,t)||c.type===f&&(oe(n,t)||re(q,N))||(c.type===l||c.type===p)&&te(c.type,q,N));){if(null==y[q]){if(c.type===u&&A)continue;r(y,R,n,q,b.NORMAL)}else{if(c.type!==u){y[q].color===k&&r(y,R,n,q,b.CAPTURE);break}if(A){y[q].color===k&&r(y,R,n,q,b.CAPTURE);break}A=!0}if(c.type!==u&&c.type!==s)break}W(n)>=8&&(n+=7)}if(!O)return R;var j=[];for(n=0,i=R.length;n<i;n++)D(R[n]),$(N)||j.push(R[n]),V();return P&&(w=ee(w)),j}function U(e,r){return Y(e.from)+Y(e.to)}function F(e){return e.replace(/=/,"").replace(/[+#]?[?!]*$/,"")}function $(e){var r,n,t,i=q[e],f=ee(e);for(r=0,n=v.n.length;r<n;++r)if(t=i+v.n[r],null!=y[t]&&!ne(t)&&y[t].color===f&&y[t].type===a&&!ie(t,r<4?3-r:11-r))return!0;for(r=0,n=v.r.length;r<n;++r){var l=v.r[r],c=!1;for(t=i+l;!ne(t);t+=l){var h=y[t];if(null!=h){if(h.color===f)if(c){if(h.type===u)return!0}else if(h.type===s||h.type===p)return!0;if(c)break;c=!0}}}for(r=0,n=d[f].length;r<n;++r)if(t=i-d[f][r],null!=y[t]&&!ne(t)&&y[t].color===f&&y[t].type===o)return!0;return!1}function z(){return $(w)}function T(){return z()&&0===L().length}function S(){return!z()&&0===L().length}function M(){var e,r={},n=0;for(var t in m)m.hasOwnProperty(t)&&(e=y[m[t]])&&(r[e.type]=e.type in r?r[e.type]+1:1,n++);return 2===n||void 0===r.n&&void 0===r.r&&void 0===r.c&&void 0===r.p}function H(){for(var e,r=[],n={},t=!1;e=V();)r.push(e);for(;;){var i=E().split(" ").slice(0,2).join(" ");if(n[i]=i in n?n[i]+1:1,n[i]>=8&&(t=!0),!r.length)break;D(r.pop())}return t}function X(e,r){e.push({move:r,kings:{b:q.b,r:q.r},turn:w,half_moves:A,move_number:R})}function D(e){X(N,e),null!=y[e.to]&&y[e.to].type===p&&(q[y[e.to].color]=i),y[e.to]=y[e.from],y[e.from]=null,y[e.to].type===p&&(q[y[e.to].color]=e.to),e.flags&b.CAPTURE?A=0:A++,w===n&&R++,w=ee(w)}function G(e,r){if(void 0===r&&(r=!0),null==e)return null;var n=e.move;return q=e.kings,w=e.turn,A=e.half_moves,R=e.move_number,y[n.from]=y[n.to],y[n.from].type=n.piece,y[n.to]=null,(n.flags&b.CAPTURE)>0&&r&&(y[n.to]={type:n.captured,color:ee(w)}),n}function V(){return G(N.pop())}function Z(){for(var e="   +---------------------------+\n",r=m.a9;r<=m.i0;r++){if(0===W(r)&&(e+=" "+"9876543210"[Q(r)]+" |"),null==y[r])e+=" . ";else{var n=y[r].type;e+=" "+(y[r].color===t?n.toUpperCase():n.toLowerCase())+" "}8&r&&(e+="|\n",r+=7)}return e+="   +---------------------------+\n",e+="     a  b  c  d  e  f  g  h  i\n"}function J(e,r){var n,t,i,o=F(e),u=o.match(/([a-iA-I][0-9])-?([a-iA-I][0-9])/);r&&u&&(n=u[1],t=u[2],i=u[3]);for(var s=L(),a=0,f=s.length;a<f;a++){if(o===F(U(s[a]))||r&&o===F(U(s[a])))return s[a];if(u&&(!n||n.toLowerCase()===s[a].piece)&&m[t]===s[a].from&&m[i]===s[a].to)return s[a]}return null}function Q(e){return e>>4}function W(e){return 15&e}function Y(e){var r=W(e),n=Q(e);return"abcdefghi".substring(r,r+1)+"9876543210".substring(n,n+1)}function ee(e){return e===t?n:t}function re(e,r){return r===t?Q(e)<5:Q(e)>4}function ne(e){return e<0||Q(e)>9||W(e)>8}function te(e,r,n){var i={};if(e===o)return i=[0,2,4,6,8],n===t?Q(r)>6||Q(r)>4&&-1===i.indexOf(W(r)):Q(r)<3||Q(r)<5&&-1===i.indexOf(W(r));if(e===f)i.r=[146,150,112,116,120,82,86],i.b=[2,6,32,36,40,66,70];else if(e===l)i.r=[147,149,132,115,117],i.b=[3,5,20,35,37];else{if(e!==p)return ne(r);i.r=[147,148,149,131,132,133,115,116,117],i.b=[3,4,5,19,20,21,35,36,37]}return-1===i[n].indexOf(r)}function ie(e,r){return null!=y[e+[-16,16,-1,1][Math.floor(r/2)]]}function oe(e,r){return null!=y[e+[-17,17,15,-15][r]]}function ue(e){var r=se(e);r.iccs=U(r),r.to=Y(r.to),r.from=Y(r.from),r.piece=w===t?r.piece.toUpperCase():r.piece;var n="";for(var i in b)(b[i]&r.flags)>0&&(n+=g[i]);return r.flags=n,r}function se(e){var r=e instanceof Array?[]:{};for(var n in e)r[n]="object"==typeof n?se(e[n]):e[n];return r}function ae(e){return e.replace(/^\s+|\s+$/g,"")}function fe(e){for(var r=L({legal:!1}),n=0,t=0,i=r.length;t<i;t++){if(D(r[t]),!$(w))if(e-1>0)n+=fe(e-1);else n++;V()}return n}return P(void 0===e?c:e),{RED:t,BLACK:n,PAWN:o,CANNON:u,ROOK:s,KNIGHT:a,BISHOP:f,ADVISER:l,KING:p,SQUARES:function(){for(var e=[],r=m.a9;r<=m.i0;r++)9!==W(r)?e.push(Y(r)):r+=6;return e}(),FLAGS:g,load:function(e){return P(e)},reset:function(){return O()},moves:function(e){for(var r=L(e),n=[],t=0,i=r.length;t<i;t++)void 0!==e&&"verbose"in e&&e.verbose?n.push(ue(r[t])):n.push(U(r[t]));return n},in_check:function(){return z()},in_checkmate:function(){return T()},in_stalemate:function(){return S()},in_draw:function(){return A>=120||H()||M()},insufficient_material:function(){return M()},in_threefold_repetition:function(){return H()},game_over:function(){return A>=120||T()||S()||M()||H()||q[ee(w)]===i},validate_fen:function(e){return j(e)},fen:function(){return E()},board:function(){for(var e=[],r=[],n=m.a9;n<=m.i0;n++)null==y[n]?r.push(null):r.push({type:y[n].type,color:y[n].color}),8&n&&(e.push(r),r=[],n+=7);return e},pgn:function(e){var r,n="object"==typeof e&&"string"==typeof e.newline_char?e.newline_char:"\n",t="object"==typeof e&&"number"==typeof e.max_width?e.max_width:0,i=[],o=!1;for(r in _)i.push("["+r+' "'+_[r]+'"]'+n),o=!0;o&&N.length&&i.push(n);for(var u=[];N.length>0;)u.push(V());for(var s=[],a="";u.length>0;){var f=u.pop();N.length||"b"!==f.color?"b"!==f.color&&(a.length&&s.push(a),a=R+"."):a=R+". ...",a=a+" "+U(f),D(f)}if(a.length&&s.push(a),void 0!==_.Result&&s.push(_.Result),0===t)return i.join("")+s.join(" ");var l=0;for(r=0;r<s.length;r++)l+s[r].length>t&&0!==r?(" "===i[i.length-1]&&i.pop(),i.push(n),l=0):0!==r&&(i.push(" "),l++),i.push(s[r]),l+=s[r].length;return i.join("")},load_pgn:function(e,r){var n=void 0!==r&&"sloppy"in r&&r.sloppy;function t(e){return e.replace(/\\/g,"\\")}var i="object"==typeof r&&"string"==typeof r.newline_char?r.newline_char:"\r?\n",o=new RegExp("^(?:\\s)*(((?:"+t(i)+")*\\[[^\\]]+\\])+)"),u=o.test(e)?o.exec(e)[1]:"";O();var s=function(e,r){for(var n="object"==typeof r&&"string"==typeof r.newline_char?r.newline_char:"\r?\n",i={},o=e.split(new RegExp(t(n))),u="",s="",a=0;a<o.length;a++)u=o[a].replace(/^\[([A-Z][A-Za-z]*)\s.*]$/,"$1"),s=o[a].replace(/^\[[A-Za-z]+\s"(.*)"]$/,"$1"),ae(u).length>0&&(i[u]=s);return i}(u,r);for(var a in s)s.hasOwnProperty(a)&&x([a,s[a]]);if("FEN"in s&&!P(s.FEN,!0))return console.warn("load header FEN failed!"),!1;var f=e.replace(u,"").replace(new RegExp(t(i),"g")," ");f=f.replace(/({[^}]+})+?/g,"");for(var l=/(\([^()]+\))+?/g;l.test(f);)f=f.replace(l,"");var p=ae(f=(f=(f=f.replace(/\d+\.(\.\.)?/g,"")).replace(/\.\.\./g,"")).replace(/\$\d+/g,"")).split(new RegExp(/\s+/));p=p.join(",").replace(/,,+/g,",").split(",");for(var c="",d=0;d<p.length-1;d++){if(null==(c=J(p[d],n)))return console.warn("impossible move: "+p[d]+"!\n"+Z()),!1;D(c)}if(c=p[p.length-1],h.indexOf(c)>-1)(function(e){for(var r in e)if(e.hasOwnProperty(r))return!0;return!1})(_)&&void 0===_.Result&&x(["Result",c]);else{if(null==(c=J(c,n)))return console.warn("impossible last move: "+p[p.length-1]+"!\n"+Z()),!1;D(c)}return!0},header:function(){return x(arguments)},ascii:function(){return Z()},turn:function(){return w},move:function(e,r){var n=void 0!==r&&"sloppy"in r&&r.sloppy,t=null;if("string"==typeof e)t=J(e,n);else if("object"==typeof e)for(var i=L(),o=0,u=i.length;o<u;o++)if(e.from===Y(i[o].from)&&e.to===Y(i[o].to)&&!(""in i[o])){t=i[o];break}if(!t)return null;var s=ue(t);return D(t),k=[],s},undo:function(){X(k,null);var e=V();if(e){var r=ue(e),n=[e.to,e.from];return e.from=n[0],e.to=n[1],k[k.length-1].move=e,r}return k.pop(),null},redo:function(){X(N,null);var e=G(k.pop(),!1);if(e){var r=[e.to,e.from];return e.from=r[0],e.to=r[1],N[N.length-1].move=e,ue(e)}return N.pop(),null},clear:function(){return C()},put:function(e,r){return K(e,r)},get:function(e){return B(e)},remove:function(e){return function(e){var r=B(e);return y[m[e]]=null,r&&r.type===p&&(q[r.color]=i),I(E()),r}(e)},perft:function(e){return fe(e)},getHistory:function(){return N.map((function(e){var n=e.move;return r({},n,{from:Y(n.from),to:Y(n.to),piece:w===t?n.piece.toUpperCase():n.piece})}))},history:function(e){for(var r=[],n=[],t=(void 0!==e&&"verbose"in e&&e.verbose);N.length>0;)r.push(V());for(;r.length>0;){var i=r.pop();t?n.push(ue(i)):n.push(U(i)),D(i)}return n}}}));n._RF.pop()}}}));

System.register("bundle://KKCoTuongBundle/_virtual/Xor.ts",["cc"],(function(r){var t;return{setters:[function(r){t=r.cclegacy}],execute:function(){t._RF.push({},"11948OXRWxFSb/uOlkSXeMT","Xor",void 0);r("default",function(){function r(){}return r.xor=function(r,t){try{if(!r||!t)return"";for(var e=0,n=t.length-1;n>=0;--n)e+=t.charCodeAt(n);for(var o="",u=r.length-1;u>=0;--u){var c=r.charCodeAt(u)^e;o+=String.fromCharCode(c)}return o}catch(r){return""}},r}());t._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/KKCoTuongBundle', 'bundle://KKCoTuongBundle/_virtual/KKCoTuongBundle'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});